\doxysection{gmock-\/spec-\/builders.h}
\hypertarget{gmock-spec-builders_8h_source}{}\label{gmock-spec-builders_8h_source}\index{/home/who/standard-\/extended-\/cpp-\/lib/dependencies/googletest-\/1.14.0/googlemock/include/gmock/gmock-\/spec-\/builders.h@{/home/who/standard-\/extended-\/cpp-\/lib/dependencies/googletest-\/1.14.0/googlemock/include/gmock/gmock-\/spec-\/builders.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ Copyright\ 2007,\ Google\ Inc.}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ All\ rights\ reserved.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Redistribution\ and\ use\ in\ source\ and\ binary\ forms,\ with\ or\ without}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ modification,\ are\ permitted\ provided\ that\ the\ following\ conditions\ are}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ met:}}
\DoxyCodeLine{00007\ \textcolor{comment}{//}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ \ \ \ \ *\ Redistributions\ of\ source\ code\ must\ retain\ the\ above\ copyright}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ notice,\ this\ list\ of\ conditions\ and\ the\ following\ disclaimer.}}
\DoxyCodeLine{00010\ \textcolor{comment}{//\ \ \ \ \ *\ Redistributions\ in\ binary\ form\ must\ reproduce\ the\ above}}
\DoxyCodeLine{00011\ \textcolor{comment}{//\ copyright\ notice,\ this\ list\ of\ conditions\ and\ the\ following\ disclaimer}}
\DoxyCodeLine{00012\ \textcolor{comment}{//\ in\ the\ documentation\ and/or\ other\ materials\ provided\ with\ the}}
\DoxyCodeLine{00013\ \textcolor{comment}{//\ distribution.}}
\DoxyCodeLine{00014\ \textcolor{comment}{//\ \ \ \ \ *\ Neither\ the\ name\ of\ Google\ Inc.\ nor\ the\ names\ of\ its}}
\DoxyCodeLine{00015\ \textcolor{comment}{//\ contributors\ may\ be\ used\ to\ endorse\ or\ promote\ products\ derived\ from}}
\DoxyCodeLine{00016\ \textcolor{comment}{//\ this\ software\ without\ specific\ prior\ written\ permission.}}
\DoxyCodeLine{00017\ \textcolor{comment}{//}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ THIS\ SOFTWARE\ IS\ PROVIDED\ BY\ THE\ COPYRIGHT\ HOLDERS\ AND\ CONTRIBUTORS}}
\DoxyCodeLine{00019\ \textcolor{comment}{//\ "{}AS\ IS"{}\ AND\ ANY\ EXPRESS\ OR\ IMPLIED\ WARRANTIES,\ INCLUDING,\ BUT\ NOT}}
\DoxyCodeLine{00020\ \textcolor{comment}{//\ LIMITED\ TO,\ THE\ IMPLIED\ WARRANTIES\ OF\ MERCHANTABILITY\ AND\ FITNESS\ FOR}}
\DoxyCodeLine{00021\ \textcolor{comment}{//\ A\ PARTICULAR\ PURPOSE\ ARE\ DISCLAIMED.\ IN\ NO\ EVENT\ SHALL\ THE\ COPYRIGHT}}
\DoxyCodeLine{00022\ \textcolor{comment}{//\ OWNER\ OR\ CONTRIBUTORS\ BE\ LIABLE\ FOR\ ANY\ DIRECT,\ INDIRECT,\ INCIDENTAL,}}
\DoxyCodeLine{00023\ \textcolor{comment}{//\ SPECIAL,\ EXEMPLARY,\ OR\ CONSEQUENTIAL\ DAMAGES\ (INCLUDING,\ BUT\ NOT}}
\DoxyCodeLine{00024\ \textcolor{comment}{//\ LIMITED\ TO,\ PROCUREMENT\ OF\ SUBSTITUTE\ GOODS\ OR\ SERVICES;\ LOSS\ OF\ USE,}}
\DoxyCodeLine{00025\ \textcolor{comment}{//\ DATA,\ OR\ PROFITS;\ OR\ BUSINESS\ INTERRUPTION)\ HOWEVER\ CAUSED\ AND\ ON\ ANY}}
\DoxyCodeLine{00026\ \textcolor{comment}{//\ THEORY\ OF\ LIABILITY,\ WHETHER\ IN\ CONTRACT,\ STRICT\ LIABILITY,\ OR\ TORT}}
\DoxyCodeLine{00027\ \textcolor{comment}{//\ (INCLUDING\ NEGLIGENCE\ OR\ OTHERWISE)\ ARISING\ IN\ ANY\ WAY\ OUT\ OF\ THE\ USE}}
\DoxyCodeLine{00028\ \textcolor{comment}{//\ OF\ THIS\ SOFTWARE,\ EVEN\ IF\ ADVISED\ OF\ THE\ POSSIBILITY\ OF\ SUCH\ DAMAGE.}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{comment}{//\ Google\ Mock\ -\/\ a\ framework\ for\ writing\ C++\ mock\ classes.}}
\DoxyCodeLine{00031\ \textcolor{comment}{//}}
\DoxyCodeLine{00032\ \textcolor{comment}{//\ This\ file\ implements\ the\ ON\_CALL()\ and\ EXPECT\_CALL()\ macros.}}
\DoxyCodeLine{00033\ \textcolor{comment}{//}}
\DoxyCodeLine{00034\ \textcolor{comment}{//\ A\ user\ can\ use\ the\ ON\_CALL()\ macro\ to\ specify\ the\ default\ action\ of}}
\DoxyCodeLine{00035\ \textcolor{comment}{//\ a\ mock\ method.\ \ The\ syntax\ is:}}
\DoxyCodeLine{00036\ \textcolor{comment}{//}}
\DoxyCodeLine{00037\ \textcolor{comment}{//\ \ \ ON\_CALL(mock\_object,\ Method(argument-\/matchers))}}
\DoxyCodeLine{00038\ \textcolor{comment}{//\ \ \ \ \ \ \ .With(multi-\/argument-\/matcher)}}
\DoxyCodeLine{00039\ \textcolor{comment}{//\ \ \ \ \ \ \ .WillByDefault(action);}}
\DoxyCodeLine{00040\ \textcolor{comment}{//}}
\DoxyCodeLine{00041\ \textcolor{comment}{//\ \ where\ the\ .With()\ clause\ is\ optional.}}
\DoxyCodeLine{00042\ \textcolor{comment}{//}}
\DoxyCodeLine{00043\ \textcolor{comment}{//\ A\ user\ can\ use\ the\ EXPECT\_CALL()\ macro\ to\ specify\ an\ expectation\ on}}
\DoxyCodeLine{00044\ \textcolor{comment}{//\ a\ mock\ method.\ \ The\ syntax\ is:}}
\DoxyCodeLine{00045\ \textcolor{comment}{//}}
\DoxyCodeLine{00046\ \textcolor{comment}{//\ \ \ EXPECT\_CALL(mock\_object,\ Method(argument-\/matchers))}}
\DoxyCodeLine{00047\ \textcolor{comment}{//\ \ \ \ \ \ \ .With(multi-\/argument-\/matchers)}}
\DoxyCodeLine{00048\ \textcolor{comment}{//\ \ \ \ \ \ \ .Times(cardinality)}}
\DoxyCodeLine{00049\ \textcolor{comment}{//\ \ \ \ \ \ \ .InSequence(sequences)}}
\DoxyCodeLine{00050\ \textcolor{comment}{//\ \ \ \ \ \ \ .After(expectations)}}
\DoxyCodeLine{00051\ \textcolor{comment}{//\ \ \ \ \ \ \ .WillOnce(action)}}
\DoxyCodeLine{00052\ \textcolor{comment}{//\ \ \ \ \ \ \ .WillRepeatedly(action)}}
\DoxyCodeLine{00053\ \textcolor{comment}{//\ \ \ \ \ \ \ .RetiresOnSaturation();}}
\DoxyCodeLine{00054\ \textcolor{comment}{//}}
\DoxyCodeLine{00055\ \textcolor{comment}{//\ where\ all\ clauses\ are\ optional,\ and\ .InSequence()/.After()/}}
\DoxyCodeLine{00056\ \textcolor{comment}{//\ .WillOnce()\ can\ appear\ any\ number\ of\ times.}}
\DoxyCodeLine{00057\ }
\DoxyCodeLine{00058\ \textcolor{comment}{//\ IWYU\ pragma:\ private,\ include\ "{}gmock/gmock.h"{}}}
\DoxyCodeLine{00059\ \textcolor{comment}{//\ IWYU\ pragma:\ friend\ gmock/.*}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \textcolor{preprocessor}{\#ifndef\ GOOGLEMOCK\_INCLUDE\_GMOCK\_GMOCK\_SPEC\_BUILDERS\_H\_}}
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#define\ GOOGLEMOCK\_INCLUDE\_GMOCK\_GMOCK\_SPEC\_BUILDERS\_H\_}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#include\ <cstdint>}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#include\ <functional>}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#include\ <map>}}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00068\ \textcolor{preprocessor}{\#include\ <ostream>}}
\DoxyCodeLine{00069\ \textcolor{preprocessor}{\#include\ <set>}}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#include\ <type\_traits>}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#include\ <utility>}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \textcolor{preprocessor}{\#include\ "{}gmock/gmock-\/actions.h"{}}}
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#include\ "{}gmock/gmock-\/cardinalities.h"{}}}
\DoxyCodeLine{00078\ \textcolor{preprocessor}{\#include\ "{}gmock/gmock-\/matchers.h"{}}}
\DoxyCodeLine{00079\ \textcolor{preprocessor}{\#include\ "{}gmock/internal/gmock-\/internal-\/utils.h"{}}}
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#include\ "{}gmock/internal/gmock-\/port.h"{}}}
\DoxyCodeLine{00081\ \textcolor{preprocessor}{\#include\ "{}gtest/gtest.h"{}}}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\#include\ <stdexcept>}\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ GTEST\_DISABLE\_MSC\_WARNINGS\_PUSH\_(4251\ \(\backslash\)}
\DoxyCodeLine{00088\ \textcolor{comment}{/*\ class\ A\ needs\ to\ have\ dll-\/interface\ to\ be\ used\ by\ clients\ of\ class\ B\ */})}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ namespace\ testing\ \{}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{comment}{//\ An\ abstract\ handle\ of\ an\ expectation.}}
\DoxyCodeLine{00093\ \textcolor{keyword}{class\ }Expectation;}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \textcolor{comment}{//\ A\ set\ of\ expectation\ handles.}}
\DoxyCodeLine{00096\ \textcolor{keyword}{class\ }ExpectationSet;}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \textcolor{comment}{//\ Anything\ inside\ the\ 'internal'\ namespace\ IS\ INTERNAL\ IMPLEMENTATION}}
\DoxyCodeLine{00099\ \textcolor{comment}{//\ and\ MUST\ NOT\ BE\ USED\ IN\ USER\ CODE!!!}}
\DoxyCodeLine{00100\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ \textcolor{comment}{//\ Implements\ a\ mock\ function.}}
\DoxyCodeLine{00103\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00104\ \textcolor{keyword}{class\ }FunctionMocker;}
\DoxyCodeLine{00105\ }
\DoxyCodeLine{00106\ \textcolor{comment}{//\ Base\ class\ for\ expectations.}}
\DoxyCodeLine{00107\ \textcolor{keyword}{class\ }ExpectationBase;}
\DoxyCodeLine{00108\ }
\DoxyCodeLine{00109\ \textcolor{comment}{//\ Implements\ an\ expectation.}}
\DoxyCodeLine{00110\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00111\ \textcolor{keyword}{class\ }TypedExpectation;}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00113\ \textcolor{comment}{//\ Helper\ class\ for\ testing\ the\ Expectation\ class\ template.}}
\DoxyCodeLine{00114\ \textcolor{keyword}{class\ }ExpectationTester;}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \textcolor{comment}{//\ Helper\ classes\ for\ implementing\ NiceMock,\ StrictMock,\ and\ NaggyMock.}}
\DoxyCodeLine{00117\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MockClass>}
\DoxyCodeLine{00118\ \textcolor{keyword}{class\ }NiceMockImpl;}
\DoxyCodeLine{00119\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MockClass>}
\DoxyCodeLine{00120\ \textcolor{keyword}{class\ }StrictMockImpl;}
\DoxyCodeLine{00121\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MockClass>}
\DoxyCodeLine{00122\ \textcolor{keyword}{class\ }NaggyMockImpl;}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \textcolor{comment}{//\ Protects\ the\ mock\ object\ registry\ (in\ class\ Mock),\ all\ function}}
\DoxyCodeLine{00125\ \textcolor{comment}{//\ mockers,\ and\ all\ expectations.}}
\DoxyCodeLine{00126\ \textcolor{comment}{//}}
\DoxyCodeLine{00127\ \textcolor{comment}{//\ The\ reason\ we\ don't\ use\ more\ fine-\/grained\ protection\ is:\ when\ a}}
\DoxyCodeLine{00128\ \textcolor{comment}{//\ mock\ function\ Foo()\ is\ called,\ it\ needs\ to\ consult\ its\ expectations}}
\DoxyCodeLine{00129\ \textcolor{comment}{//\ to\ see\ which\ one\ should\ be\ picked.\ \ If\ another\ thread\ is\ allowed\ to}}
\DoxyCodeLine{00130\ \textcolor{comment}{//\ call\ a\ mock\ function\ (either\ Foo()\ or\ a\ different\ one)\ at\ the\ same}}
\DoxyCodeLine{00131\ \textcolor{comment}{//\ time,\ it\ could\ affect\ the\ "{}retired"{}\ attributes\ of\ Foo()'s}}
\DoxyCodeLine{00132\ \textcolor{comment}{//\ expectations\ when\ InSequence()\ is\ used,\ and\ thus\ affect\ which}}
\DoxyCodeLine{00133\ \textcolor{comment}{//\ expectation\ gets\ picked.\ \ Therefore,\ we\ sequence\ all\ mock\ function}}
\DoxyCodeLine{00134\ \textcolor{comment}{//\ calls\ to\ ensure\ the\ integrity\ of\ the\ mock\ objects'\ states.}}
\DoxyCodeLine{00135\ GTEST\_API\_\ GTEST\_DECLARE\_STATIC\_MUTEX\_(g\_gmock\_mutex);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00137\ \textcolor{comment}{//\ Abstract\ base\ class\ of\ FunctionMocker.\ \ This\ is\ the}}
\DoxyCodeLine{00138\ \textcolor{comment}{//\ type-\/agnostic\ part\ of\ the\ function\ mocker\ interface.\ \ Its\ pure}}
\DoxyCodeLine{00139\ \textcolor{comment}{//\ virtual\ methods\ are\ implemented\ by\ FunctionMocker.}}
\DoxyCodeLine{00140\ \textcolor{keyword}{class\ }GTEST\_API\_\ UntypedFunctionMockerBase\ \{}
\DoxyCodeLine{00141\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00142\ \ \ UntypedFunctionMockerBase();}
\DoxyCodeLine{00143\ \ \ \textcolor{keyword}{virtual}\ \string~UntypedFunctionMockerBase();}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \textcolor{comment}{//\ Verifies\ that\ all\ expectations\ on\ this\ mock\ function\ have\ been}}
\DoxyCodeLine{00146\ \ \ \textcolor{comment}{//\ satisfied.\ \ Reports\ one\ or\ more\ Google\ Test\ non-\/fatal\ failures}}
\DoxyCodeLine{00147\ \ \ \textcolor{comment}{//\ and\ returns\ false\ if\ not.}}
\DoxyCodeLine{00148\ \ \ \textcolor{keywordtype}{bool}\ VerifyAndClearExpectationsLocked()}
\DoxyCodeLine{00149\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \textcolor{comment}{//\ Clears\ the\ ON\_CALL()s\ set\ on\ this\ mock\ function.}}
\DoxyCodeLine{00152\ \ \ virtual\ \textcolor{keywordtype}{void}\ ClearDefaultActionsLocked()}
\DoxyCodeLine{00153\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ =\ 0;}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \ \ \textcolor{comment}{//\ In\ all\ of\ the\ following\ Untyped*\ functions,\ it's\ the\ caller's}}
\DoxyCodeLine{00156\ \ \ \textcolor{comment}{//\ responsibility\ to\ guarantee\ the\ correctness\ of\ the\ arguments'}}
\DoxyCodeLine{00157\ \ \ \textcolor{comment}{//\ types.}}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \textcolor{comment}{//\ Writes\ a\ message\ that\ the\ call\ is\ uninteresting\ (i.e.\ neither}}
\DoxyCodeLine{00160\ \ \ \textcolor{comment}{//\ explicitly\ expected\ nor\ explicitly\ unexpected)\ to\ the\ given}}
\DoxyCodeLine{00161\ \ \ \textcolor{comment}{//\ ostream.}}
\DoxyCodeLine{00162\ \ \ virtual\ \textcolor{keywordtype}{void}\ UntypedDescribeUninterestingCall(const\ \textcolor{keywordtype}{void}*\ untyped\_args,}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ os)\ const}
\DoxyCodeLine{00164\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ =\ 0;}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \textcolor{comment}{//\ Returns\ the\ expectation\ that\ matches\ the\ given\ function\ arguments}}
\DoxyCodeLine{00167\ \ \ \textcolor{comment}{//\ (or\ NULL\ is\ there's\ no\ match);\ when\ a\ match\ is\ found,}}
\DoxyCodeLine{00168\ \ \ \textcolor{comment}{//\ untyped\_action\ is\ set\ to\ point\ to\ the\ action\ that\ should\ be}}
\DoxyCodeLine{00169\ \ \ \textcolor{comment}{//\ performed\ (or\ NULL\ if\ the\ action\ is\ "{}do\ default"{}),\ and}}
\DoxyCodeLine{00170\ \ \ \textcolor{comment}{//\ is\_excessive\ is\ modified\ to\ indicate\ whether\ the\ call\ exceeds\ the}}
\DoxyCodeLine{00171\ \ \ \textcolor{comment}{//\ expected\ number.}}
\DoxyCodeLine{00172\ \ \ virtual\ const\ ExpectationBase*\ UntypedFindMatchingExpectation(}
\DoxyCodeLine{00173\ \ \ \ \ \ \ const\ \textcolor{keywordtype}{void}*\ untyped\_args,\ const\ \textcolor{keywordtype}{void}**\ untyped\_action,\ \textcolor{keywordtype}{bool}*\ is\_excessive,}
\DoxyCodeLine{00174\ \ \ \ \ \ \ ::std::ostream*\ what,\ ::std::ostream*\ why)}
\DoxyCodeLine{00175\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ =\ 0;}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \textcolor{comment}{//\ Prints\ the\ given\ function\ arguments\ to\ the\ ostream.}}
\DoxyCodeLine{00178\ \ \ virtual\ \textcolor{keywordtype}{void}\ UntypedPrintArgs(const\ \textcolor{keywordtype}{void}*\ untyped\_args,}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ os)\ const\ =\ 0;}
\DoxyCodeLine{00180\ }
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{//\ Sets\ the\ mock\ object\ this\ mock\ method\ belongs\ to,\ and\ registers}}
\DoxyCodeLine{00182\ \ \ \textcolor{comment}{//\ this\ information\ in\ the\ global\ mock\ registry.\ \ Will\ be\ called}}
\DoxyCodeLine{00183\ \ \ \textcolor{comment}{//\ whenever\ an\ EXPECT\_CALL()\ or\ ON\_CALL()\ is\ executed\ on\ this\ mock}}
\DoxyCodeLine{00184\ \ \ \textcolor{comment}{//\ method.}}
\DoxyCodeLine{00185\ \ \ \textcolor{keywordtype}{void}\ RegisterOwner(const\ \textcolor{keywordtype}{void}*\ mock\_obj)\ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \textcolor{comment}{//\ Sets\ the\ mock\ object\ this\ mock\ method\ belongs\ to,\ and\ sets\ the}}
\DoxyCodeLine{00188\ \ \ \textcolor{comment}{//\ name\ of\ the\ mock\ function.\ \ Will\ be\ called\ upon\ each\ invocation}}
\DoxyCodeLine{00189\ \ \ \textcolor{comment}{//\ of\ this\ mock\ function.}}
\DoxyCodeLine{00190\ \ \ \textcolor{keywordtype}{void}\ SetOwnerAndName(const\ \textcolor{keywordtype}{void}*\ mock\_obj,\ const\ \textcolor{keywordtype}{char}*\ name)}
\DoxyCodeLine{00191\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{comment}{//\ Returns\ the\ mock\ object\ this\ mock\ method\ belongs\ to.\ \ Must\ be}}
\DoxyCodeLine{00194\ \ \ \textcolor{comment}{//\ called\ after\ RegisterOwner()\ or\ SetOwnerAndName()\ has\ been}}
\DoxyCodeLine{00195\ \ \ \textcolor{comment}{//\ called.}}
\DoxyCodeLine{00196\ \ \ const\ \textcolor{keywordtype}{void}*\ MockObject()\ const\ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \ \ \textcolor{comment}{//\ Returns\ the\ name\ of\ this\ mock\ method.\ \ Must\ be\ called\ after}}
\DoxyCodeLine{00199\ \ \ \textcolor{comment}{//\ SetOwnerAndName()\ has\ been\ called.}}
\DoxyCodeLine{00200\ \ \ const\ \textcolor{keywordtype}{char}*\ Name()\ const\ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00201\ }
\DoxyCodeLine{00202\ \ protected:}
\DoxyCodeLine{00203\ \ \ typedef\ std::vector<const\ \textcolor{keywordtype}{void}*>\ UntypedOnCallSpecs;}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ using\ UntypedExpectations\ =\ std::vector<std::shared\_ptr<ExpectationBase>>;}
\DoxyCodeLine{00206\ }
\DoxyCodeLine{00207\ \ \ struct\ UninterestingCallCleanupHandler;}
\DoxyCodeLine{00208\ \ \ struct\ FailureCleanupHandler;}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{comment}{//\ Returns\ an\ Expectation\ object\ that\ references\ and\ co-\/owns\ exp,}}
\DoxyCodeLine{00211\ \ \ \textcolor{comment}{//\ which\ must\ be\ an\ expectation\ on\ this\ mock\ function.}}
\DoxyCodeLine{00212\ \ \ Expectation\ GetHandleOf(ExpectationBase*\ exp);}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \textcolor{comment}{//\ Address\ of\ the\ mock\ object\ this\ mock\ method\ belongs\ to.\ \ Only}}
\DoxyCodeLine{00215\ \ \ \textcolor{comment}{//\ valid\ after\ this\ mock\ method\ has\ been\ called\ or}}
\DoxyCodeLine{00216\ \ \ \textcolor{comment}{//\ ON\_CALL/EXPECT\_CALL\ has\ been\ invoked\ on\ it.}}
\DoxyCodeLine{00217\ \ \ const\ \textcolor{keywordtype}{void}*\ mock\_obj\_;\ \ \textcolor{comment}{//\ Protected\ by\ g\_gmock\_mutex.}}
\DoxyCodeLine{00218\ }
\DoxyCodeLine{00219\ \ \ \textcolor{comment}{//\ Name\ of\ the\ function\ being\ mocked.\ \ Only\ valid\ after\ this\ mock}}
\DoxyCodeLine{00220\ \ \ \textcolor{comment}{//\ method\ has\ been\ called.}}
\DoxyCodeLine{00221\ \ \ const\ \textcolor{keywordtype}{char}*\ name\_;\ \ \textcolor{comment}{//\ Protected\ by\ g\_gmock\_mutex.}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \textcolor{comment}{//\ All\ default\ action\ specs\ for\ this\ function\ mocker.}}
\DoxyCodeLine{00224\ \ \ UntypedOnCallSpecs\ untyped\_on\_call\_specs\_;}
\DoxyCodeLine{00225\ }
\DoxyCodeLine{00226\ \ \ \textcolor{comment}{//\ All\ expectations\ for\ this\ function\ mocker.}}
\DoxyCodeLine{00227\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00228\ \ \ \textcolor{comment}{//\ It's\ undefined\ behavior\ to\ interleave\ expectations\ (EXPECT\_CALLs}}
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//\ or\ ON\_CALLs)\ and\ mock\ function\ calls.\ \ Also,\ the\ order\ of}}
\DoxyCodeLine{00230\ \ \ \textcolor{comment}{//\ expectations\ is\ important.\ \ Therefore\ it's\ a\ logic\ race\ condition}}
\DoxyCodeLine{00231\ \ \ \textcolor{comment}{//\ to\ read/write\ untyped\_expectations\_\ concurrently.\ \ In\ order\ for}}
\DoxyCodeLine{00232\ \ \ \textcolor{comment}{//\ tools\ like\ tsan\ to\ catch\ concurrent\ read/write\ accesses\ to}}
\DoxyCodeLine{00233\ \ \ \textcolor{comment}{//\ untyped\_expectations,\ we\ deliberately\ leave\ accesses\ to\ it}}
\DoxyCodeLine{00234\ \ \ \textcolor{comment}{//\ unprotected.}}
\DoxyCodeLine{00235\ \ \ UntypedExpectations\ untyped\_expectations\_;}
\DoxyCodeLine{00236\ \};\ \ \textcolor{comment}{//\ class\ UntypedFunctionMockerBase}}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \textcolor{comment}{//\ Untyped\ base\ class\ for\ OnCallSpec<F>.}}
\DoxyCodeLine{00239\ class\ UntypedOnCallSpecBase\ \{}
\DoxyCodeLine{00240\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00241\ \ \ \textcolor{comment}{//\ The\ arguments\ are\ the\ location\ of\ the\ ON\_CALL()\ statement.}}
\DoxyCodeLine{00242\ \ \ UntypedOnCallSpecBase(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ a\_file,\ \textcolor{keywordtype}{int}\ a\_line)}
\DoxyCodeLine{00243\ \ \ \ \ \ \ :\ file\_(a\_file),\ line\_(a\_line),\ last\_clause\_(kNone)\ \{\}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \textcolor{comment}{//\ Where\ in\ the\ source\ file\ was\ the\ default\ action\ spec\ defined?}}
\DoxyCodeLine{00246\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ file\_;\ \}}
\DoxyCodeLine{00247\ \ \ \textcolor{keywordtype}{int}\ line()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ line\_;\ \}}
\DoxyCodeLine{00248\ }
\DoxyCodeLine{00249\ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00250\ \ \ \textcolor{comment}{//\ Gives\ each\ clause\ in\ the\ ON\_CALL()\ statement\ a\ name.}}
\DoxyCodeLine{00251\ \ \ \textcolor{keyword}{enum}\ Clause\ \{}
\DoxyCodeLine{00252\ \ \ \ \ \textcolor{comment}{//\ Do\ not\ change\ the\ order\ of\ the\ enum\ members!\ \ The\ run-\/time}}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{comment}{//\ syntax\ checking\ relies\ on\ it.}}
\DoxyCodeLine{00254\ \ \ \ \ kNone,}
\DoxyCodeLine{00255\ \ \ \ \ kWith,}
\DoxyCodeLine{00256\ \ \ \ \ kWillByDefault}
\DoxyCodeLine{00257\ \ \ \};}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00259\ \ \ \textcolor{comment}{//\ Asserts\ that\ the\ ON\_CALL()\ statement\ has\ a\ certain\ property.}}
\DoxyCodeLine{00260\ \ \ \textcolor{keywordtype}{void}\ AssertSpecProperty(\textcolor{keywordtype}{bool}\ property,}
\DoxyCodeLine{00261\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ failure\_message)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00262\ \ \ \ \ Assert(property,\ file\_,\ line\_,\ failure\_message);}
\DoxyCodeLine{00263\ \ \ \}}
\DoxyCodeLine{00264\ }
\DoxyCodeLine{00265\ \ \ \textcolor{comment}{//\ Expects\ that\ the\ ON\_CALL()\ statement\ has\ a\ certain\ property.}}
\DoxyCodeLine{00266\ \ \ \textcolor{keywordtype}{void}\ ExpectSpecProperty(\textcolor{keywordtype}{bool}\ property,}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ failure\_message)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00268\ \ \ \ \ Expect(property,\ file\_,\ line\_,\ failure\_message);}
\DoxyCodeLine{00269\ \ \ \}}
\DoxyCodeLine{00270\ }
\DoxyCodeLine{00271\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file\_;}
\DoxyCodeLine{00272\ \ \ \textcolor{keywordtype}{int}\ line\_;}
\DoxyCodeLine{00273\ }
\DoxyCodeLine{00274\ \ \ \textcolor{comment}{//\ The\ last\ clause\ in\ the\ ON\_CALL()\ statement\ as\ seen\ so\ far.}}
\DoxyCodeLine{00275\ \ \ \textcolor{comment}{//\ Initially\ kNone\ and\ changes\ as\ the\ statement\ is\ parsed.}}
\DoxyCodeLine{00276\ \ \ Clause\ last\_clause\_;}
\DoxyCodeLine{00277\ \};\ \ \textcolor{comment}{//\ class\ UntypedOnCallSpecBase}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \textcolor{comment}{//\ This\ template\ class\ implements\ an\ ON\_CALL\ spec.}}
\DoxyCodeLine{00280\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00281\ \textcolor{keyword}{class\ }OnCallSpec\ :\ \textcolor{keyword}{public}\ UntypedOnCallSpecBase\ \{}
\DoxyCodeLine{00282\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00283\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Function<F>::ArgumentTuple\ ArgumentTuple;}
\DoxyCodeLine{00284\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Function<F>::ArgumentMatcherTuple\ ArgumentMatcherTuple;}
\DoxyCodeLine{00285\ }
\DoxyCodeLine{00286\ \ \ \textcolor{comment}{//\ Constructs\ an\ OnCallSpec\ object\ from\ the\ information\ inside}}
\DoxyCodeLine{00287\ \ \ \textcolor{comment}{//\ the\ parenthesis\ of\ an\ ON\_CALL()\ statement.}}
\DoxyCodeLine{00288\ \ \ OnCallSpec(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ a\_file,\ \textcolor{keywordtype}{int}\ a\_line,}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ArgumentMatcherTuple\&\ matchers)}
\DoxyCodeLine{00290\ \ \ \ \ \ \ :\ UntypedOnCallSpecBase(a\_file,\ a\_line),}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ matchers\_(matchers),}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ By\ default,\ extra\_matcher\_\ should\ match\ anything.\ \ However,}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ cannot\ initialize\ it\ with\ \_\ as\ that\ causes\ ambiguity\ between}}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Matcher's\ copy\ and\ move\ constructor\ for\ some\ argument\ types.}}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ extra\_matcher\_(A<const\ ArgumentTuple\&>())\ \{\}}
\DoxyCodeLine{00296\ }
\DoxyCodeLine{00297\ \ \ \textcolor{comment}{//\ Implements\ the\ .With()\ clause.}}
\DoxyCodeLine{00298\ \ \ OnCallSpec\&\ With(\textcolor{keyword}{const}\ Matcher<const\ ArgumentTuple\&>\&\ m)\ \{}
\DoxyCodeLine{00299\ \ \ \ \ \textcolor{comment}{//\ Makes\ sure\ this\ is\ called\ at\ most\ once.}}
\DoxyCodeLine{00300\ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <\ kWith,}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.With()\ cannot\ appear\ "{}}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}more\ than\ once\ in\ an\ ON\_CALL()."{}});}
\DoxyCodeLine{00303\ \ \ \ \ last\_clause\_\ =\ kWith;}
\DoxyCodeLine{00304\ }
\DoxyCodeLine{00305\ \ \ \ \ extra\_matcher\_\ =\ m;}
\DoxyCodeLine{00306\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00307\ \ \ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \textcolor{comment}{//\ Implements\ the\ .WillByDefault()\ clause.}}
\DoxyCodeLine{00310\ \ \ OnCallSpec\&\ WillByDefault(\textcolor{keyword}{const}\ Action<F>\&\ action)\ \{}
\DoxyCodeLine{00311\ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <\ kWillByDefault,}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.WillByDefault()\ must\ appear\ "{}}}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}exactly\ once\ in\ an\ ON\_CALL()."{}});}
\DoxyCodeLine{00314\ \ \ \ \ last\_clause\_\ =\ kWillByDefault;}
\DoxyCodeLine{00315\ }
\DoxyCodeLine{00316\ \ \ \ \ ExpectSpecProperty(!action.IsDoDefault(),}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}DoDefault()\ cannot\ be\ used\ in\ ON\_CALL()."{}});}
\DoxyCodeLine{00318\ \ \ \ \ action\_\ =\ action;}
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00320\ \ \ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ given\ arguments\ match\ the\ matchers.}}
\DoxyCodeLine{00323\ \ \ \textcolor{keywordtype}{bool}\ Matches(\textcolor{keyword}{const}\ ArgumentTuple\&\ args)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00324\ \ \ \ \ \textcolor{keywordflow}{return}\ TupleMatches(matchers\_,\ args)\ \&\&\ extra\_matcher\_.Matches(args);}
\DoxyCodeLine{00325\ \ \ \}}
\DoxyCodeLine{00326\ }
\DoxyCodeLine{00327\ \ \ \textcolor{comment}{//\ Returns\ the\ action\ specified\ by\ the\ user.}}
\DoxyCodeLine{00328\ \ \ \textcolor{keyword}{const}\ Action<F>\&\ GetAction()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00329\ \ \ \ \ AssertSpecProperty(last\_clause\_\ ==\ kWillByDefault,}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.WillByDefault()\ must\ appear\ exactly\ "{}}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}once\ in\ an\ ON\_CALL()."{}});}
\DoxyCodeLine{00332\ \ \ \ \ \textcolor{keywordflow}{return}\ action\_;}
\DoxyCodeLine{00333\ \ \ \}}
\DoxyCodeLine{00334\ }
\DoxyCodeLine{00335\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00336\ \ \ \textcolor{comment}{//\ The\ information\ in\ statement}}
\DoxyCodeLine{00337\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00338\ \ \ \textcolor{comment}{//\ \ \ ON\_CALL(mock\_object,\ Method(matchers))}}
\DoxyCodeLine{00339\ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ .With(multi-\/argument-\/matcher)}}
\DoxyCodeLine{00340\ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ .WillByDefault(action);}}
\DoxyCodeLine{00341\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00342\ \ \ \textcolor{comment}{//\ is\ recorded\ in\ the\ data\ members\ like\ this:}}
\DoxyCodeLine{00343\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00344\ \ \ \textcolor{comment}{//\ \ \ source\ file\ that\ contains\ the\ statement\ =>\ file\_}}
\DoxyCodeLine{00345\ \ \ \textcolor{comment}{//\ \ \ line\ number\ of\ the\ statement\ \ \ \ \ \ \ \ \ \ \ \ =>\ line\_}}
\DoxyCodeLine{00346\ \ \ \textcolor{comment}{//\ \ \ matchers\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =>\ matchers\_}}
\DoxyCodeLine{00347\ \ \ \textcolor{comment}{//\ \ \ multi-\/argument-\/matcher\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =>\ extra\_matcher\_}}
\DoxyCodeLine{00348\ \ \ \textcolor{comment}{//\ \ \ action\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =>\ action\_}}
\DoxyCodeLine{00349\ \ \ ArgumentMatcherTuple\ matchers\_;}
\DoxyCodeLine{00350\ \ \ Matcher<const\ ArgumentTuple\&>\ extra\_matcher\_;}
\DoxyCodeLine{00351\ \ \ Action<F>\ action\_;}
\DoxyCodeLine{00352\ \};\ \ \textcolor{comment}{//\ class\ OnCallSpec}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \textcolor{comment}{//\ Possible\ reactions\ on\ uninteresting\ calls.}}
\DoxyCodeLine{00355\ \textcolor{keyword}{enum}\ CallReaction\ \{}
\DoxyCodeLine{00356\ \ \ kAllow,}
\DoxyCodeLine{00357\ \ \ kWarn,}
\DoxyCodeLine{00358\ \ \ kFail,}
\DoxyCodeLine{00359\ \};}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{00362\ }
\DoxyCodeLine{00363\ \textcolor{comment}{//\ Utilities\ for\ manipulating\ mock\ objects.}}
\DoxyCodeLine{00364\ \textcolor{keyword}{class\ }GTEST\_API\_\ \mbox{\hyperlink{classMock}{Mock}}\ \{}
\DoxyCodeLine{00365\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00366\ \ \ \textcolor{comment}{//\ The\ following\ public\ methods\ can\ be\ called\ concurrently.}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \ \ \textcolor{comment}{//\ Tells\ Google\ Mock\ to\ ignore\ mock\_obj\ when\ checking\ for\ leaked}}
\DoxyCodeLine{00369\ \ \ \textcolor{comment}{//\ mock\ objects.}}
\DoxyCodeLine{00370\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ AllowLeak(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00371\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00372\ }
\DoxyCodeLine{00373\ \ \ \textcolor{comment}{//\ Verifies\ and\ clears\ all\ expectations\ on\ the\ given\ mock\ object.}}
\DoxyCodeLine{00374\ \ \ \textcolor{comment}{//\ If\ the\ expectations\ aren't\ satisfied,\ generates\ one\ or\ more}}
\DoxyCodeLine{00375\ \ \ \textcolor{comment}{//\ Google\ Test\ non-\/fatal\ failures\ and\ returns\ false.}}
\DoxyCodeLine{00376\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ VerifyAndClearExpectations(\textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00377\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00378\ }
\DoxyCodeLine{00379\ \ \ \textcolor{comment}{//\ Verifies\ all\ expectations\ on\ the\ given\ mock\ object\ and\ clears\ its}}
\DoxyCodeLine{00380\ \ \ \textcolor{comment}{//\ default\ actions\ and\ expectations.\ \ Returns\ true\ if\ and\ only\ if\ the}}
\DoxyCodeLine{00381\ \ \ \textcolor{comment}{//\ verification\ was\ successful.}}
\DoxyCodeLine{00382\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ VerifyAndClear(\textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00383\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \textcolor{comment}{//\ Returns\ whether\ the\ mock\ was\ created\ as\ a\ naggy\ mock\ (default)}}
\DoxyCodeLine{00386\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ IsNaggy(\textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00387\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00388\ \ \ \textcolor{comment}{//\ Returns\ whether\ the\ mock\ was\ created\ as\ a\ nice\ mock}}
\DoxyCodeLine{00389\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ IsNice(\textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00390\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00391\ \ \ \textcolor{comment}{//\ Returns\ whether\ the\ mock\ was\ created\ as\ a\ strict\ mock}}
\DoxyCodeLine{00392\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ IsStrict(\textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00393\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00394\ }
\DoxyCodeLine{00395\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00396\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }internal::UntypedFunctionMockerBase;}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00398\ \ \ \textcolor{comment}{//\ Needed\ for\ a\ function\ mocker\ to\ register\ itself\ (so\ that\ we\ know}}
\DoxyCodeLine{00399\ \ \ \textcolor{comment}{//\ how\ to\ clear\ a\ mock\ object).}}
\DoxyCodeLine{00400\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00401\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }internal::FunctionMocker;}
\DoxyCodeLine{00402\ }
\DoxyCodeLine{00403\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MockClass>}
\DoxyCodeLine{00404\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }internal::NiceMockImpl;}
\DoxyCodeLine{00405\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MockClass>}
\DoxyCodeLine{00406\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }internal::NaggyMockImpl;}
\DoxyCodeLine{00407\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ MockClass>}
\DoxyCodeLine{00408\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }internal::StrictMockImpl;}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \textcolor{comment}{//\ Tells\ Google\ Mock\ to\ allow\ uninteresting\ calls\ on\ the\ given\ mock}}
\DoxyCodeLine{00411\ \ \ \textcolor{comment}{//\ object.}}
\DoxyCodeLine{00412\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ AllowUninterestingCalls(uintptr\_t\ mock\_obj)}
\DoxyCodeLine{00413\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00414\ }
\DoxyCodeLine{00415\ \ \ \textcolor{comment}{//\ Tells\ Google\ Mock\ to\ warn\ the\ user\ about\ uninteresting\ calls\ on}}
\DoxyCodeLine{00416\ \ \ \textcolor{comment}{//\ the\ given\ mock\ object.}}
\DoxyCodeLine{00417\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ WarnUninterestingCalls(uintptr\_t\ mock\_obj)}
\DoxyCodeLine{00418\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00419\ }
\DoxyCodeLine{00420\ \ \ \textcolor{comment}{//\ Tells\ Google\ Mock\ to\ fail\ uninteresting\ calls\ on\ the\ given\ mock}}
\DoxyCodeLine{00421\ \ \ \textcolor{comment}{//\ object.}}
\DoxyCodeLine{00422\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ FailUninterestingCalls(uintptr\_t\ mock\_obj)}
\DoxyCodeLine{00423\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \textcolor{comment}{//\ Tells\ Google\ Mock\ the\ given\ mock\ object\ is\ being\ destroyed\ and}}
\DoxyCodeLine{00426\ \ \ \textcolor{comment}{//\ its\ entry\ in\ the\ call-\/reaction\ table\ should\ be\ removed.}}
\DoxyCodeLine{00427\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ UnregisterCallReaction(uintptr\_t\ mock\_obj)}
\DoxyCodeLine{00428\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00429\ }
\DoxyCodeLine{00430\ \ \ \textcolor{comment}{//\ Returns\ the\ reaction\ Google\ Mock\ will\ have\ on\ uninteresting\ calls}}
\DoxyCodeLine{00431\ \ \ \textcolor{comment}{//\ made\ on\ the\ given\ mock\ object.}}
\DoxyCodeLine{00432\ \ \ \textcolor{keyword}{static}\ internal::CallReaction\ GetReactionOnUninterestingCalls(}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ mock\_obj)\ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00434\ }
\DoxyCodeLine{00435\ \ \ \textcolor{comment}{//\ Verifies\ that\ all\ expectations\ on\ the\ given\ mock\ object\ have\ been}}
\DoxyCodeLine{00436\ \ \ \textcolor{comment}{//\ satisfied.\ \ Reports\ one\ or\ more\ Google\ Test\ non-\/fatal\ failures}}
\DoxyCodeLine{00437\ \ \ \textcolor{comment}{//\ and\ returns\ false\ if\ not.}}
\DoxyCodeLine{00438\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ VerifyAndClearExpectationsLocked(\textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00439\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00440\ }
\DoxyCodeLine{00441\ \ \ \textcolor{comment}{//\ Clears\ all\ ON\_CALL()s\ set\ on\ the\ given\ mock\ object.}}
\DoxyCodeLine{00442\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ ClearDefaultActionsLocked(\textcolor{keywordtype}{void}*\ mock\_obj)}
\DoxyCodeLine{00443\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00444\ }
\DoxyCodeLine{00445\ \ \ \textcolor{comment}{//\ Registers\ a\ mock\ object\ and\ a\ mock\ method\ it\ owns.}}
\DoxyCodeLine{00446\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ Register(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ mock\_obj,}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::UntypedFunctionMockerBase*\ mocker)}
\DoxyCodeLine{00448\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00449\ }
\DoxyCodeLine{00450\ \ \ \textcolor{comment}{//\ Tells\ Google\ Mock\ where\ in\ the\ source\ code\ mock\_obj\ is\ used\ in\ an}}
\DoxyCodeLine{00451\ \ \ \textcolor{comment}{//\ ON\_CALL\ or\ EXPECT\_CALL.\ \ In\ case\ mock\_obj\ is\ leaked,\ this}}
\DoxyCodeLine{00452\ \ \ \textcolor{comment}{//\ information\ helps\ the\ user\ identify\ which\ object\ it\ is.}}
\DoxyCodeLine{00453\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ RegisterUseByOnCallOrExpectCall(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ mock\_obj,}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \textcolor{keywordtype}{int}\ line)}
\DoxyCodeLine{00455\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \textcolor{comment}{//\ Unregisters\ a\ mock\ method;\ removes\ the\ owning\ mock\ object\ from}}
\DoxyCodeLine{00458\ \ \ \textcolor{comment}{//\ the\ registry\ when\ the\ last\ mock\ method\ associated\ with\ it\ has}}
\DoxyCodeLine{00459\ \ \ \textcolor{comment}{//\ been\ unregistered.\ \ This\ is\ called\ only\ in\ the\ destructor\ of}}
\DoxyCodeLine{00460\ \ \ \textcolor{comment}{//\ FunctionMocker.}}
\DoxyCodeLine{00461\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{void}\ UnregisterLocked(internal::UntypedFunctionMockerBase*\ mocker)}
\DoxyCodeLine{00462\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(internal::g\_gmock\_mutex);}
\DoxyCodeLine{00463\ \};\ \ \textcolor{comment}{//\ class\ Mock}}
\DoxyCodeLine{00464\ }
\DoxyCodeLine{00465\ \textcolor{comment}{//\ An\ abstract\ handle\ of\ an\ expectation.\ \ Useful\ in\ the\ .After()}}
\DoxyCodeLine{00466\ \textcolor{comment}{//\ clause\ of\ EXPECT\_CALL()\ for\ setting\ the\ (partial)\ order\ of}}
\DoxyCodeLine{00467\ \textcolor{comment}{//\ expectations.\ \ The\ syntax:}}
\DoxyCodeLine{00468\ \textcolor{comment}{//}}
\DoxyCodeLine{00469\ \textcolor{comment}{//\ \ \ Expectation\ e1\ =\ EXPECT\_CALL(...)...;}}
\DoxyCodeLine{00470\ \textcolor{comment}{//\ \ \ EXPECT\_CALL(...).After(e1)...;}}
\DoxyCodeLine{00471\ \textcolor{comment}{//}}
\DoxyCodeLine{00472\ \textcolor{comment}{//\ sets\ two\ expectations\ where\ the\ latter\ can\ only\ be\ matched\ after}}
\DoxyCodeLine{00473\ \textcolor{comment}{//\ the\ former\ has\ been\ satisfied.}}
\DoxyCodeLine{00474\ \textcolor{comment}{//}}
\DoxyCodeLine{00475\ \textcolor{comment}{//\ Notes:}}
\DoxyCodeLine{00476\ \textcolor{comment}{//\ \ \ -\/\ This\ class\ is\ copyable\ and\ has\ value\ semantics.}}
\DoxyCodeLine{00477\ \textcolor{comment}{//\ \ \ -\/\ Constness\ is\ shallow:\ a\ const\ Expectation\ object\ itself\ cannot}}
\DoxyCodeLine{00478\ \textcolor{comment}{//\ \ \ \ \ be\ modified,\ but\ the\ mutable\ methods\ of\ the\ ExpectationBase}}
\DoxyCodeLine{00479\ \textcolor{comment}{//\ \ \ \ \ object\ it\ references\ can\ be\ called\ via\ expectation\_base().}}
\DoxyCodeLine{00480\ }
\DoxyCodeLine{00481\ \textcolor{keyword}{class\ }GTEST\_API\_\ Expectation\ \{}
\DoxyCodeLine{00482\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00483\ \ \ \textcolor{comment}{//\ Constructs\ a\ null\ object\ that\ doesn't\ reference\ any\ expectation.}}
\DoxyCodeLine{00484\ \ \ Expectation();}
\DoxyCodeLine{00485\ \ \ Expectation(Expectation\&\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00486\ \ \ Expectation(\textcolor{keyword}{const}\ Expectation\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00487\ \ \ Expectation\&\ operator=(Expectation\&\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00488\ \ \ Expectation\&\ operator=(\textcolor{keyword}{const}\ Expectation\&)\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00489\ \ \ \string~Expectation();}
\DoxyCodeLine{00490\ }
\DoxyCodeLine{00491\ \ \ \textcolor{comment}{//\ This\ single-\/argument\ ctor\ must\ not\ be\ explicit,\ in\ order\ to\ support\ the}}
\DoxyCodeLine{00492\ \ \ \textcolor{comment}{//\ \ \ Expectation\ e\ =\ EXPECT\_CALL(...);}}
\DoxyCodeLine{00493\ \ \ \textcolor{comment}{//\ syntax.}}
\DoxyCodeLine{00494\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{00495\ \ \ \textcolor{comment}{//\ A\ TypedExpectation\ object\ stores\ its\ pre-\/requisites\ as}}
\DoxyCodeLine{00496\ \ \ \textcolor{comment}{//\ Expectation\ objects,\ and\ needs\ to\ call\ the\ non-\/const\ Retire()}}
\DoxyCodeLine{00497\ \ \ \textcolor{comment}{//\ method\ on\ the\ ExpectationBase\ objects\ they\ reference.\ \ Therefore}}
\DoxyCodeLine{00498\ \ \ \textcolor{comment}{//\ Expectation\ must\ receive\ a\ *non-\/const*\ reference\ to\ the}}
\DoxyCodeLine{00499\ \ \ \textcolor{comment}{//\ ExpectationBase\ object.}}
\DoxyCodeLine{00500\ \ \ Expectation(internal::ExpectationBase\&\ exp);\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00501\ }
\DoxyCodeLine{00502\ \ \ \textcolor{comment}{//\ The\ compiler-\/generated\ copy\ ctor\ and\ operator=\ work\ exactly\ as}}
\DoxyCodeLine{00503\ \ \ \textcolor{comment}{//\ intended,\ so\ we\ don't\ need\ to\ define\ our\ own.}}
\DoxyCodeLine{00504\ }
\DoxyCodeLine{00505\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ rhs\ references\ the\ same\ expectation\ as\ this}}
\DoxyCodeLine{00506\ \ \ \textcolor{comment}{//\ object\ does.}}
\DoxyCodeLine{00507\ \ \ \textcolor{keywordtype}{bool}\ operator==(\textcolor{keyword}{const}\ Expectation\&\ rhs)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keywordflow}{return}\ expectation\_base\_\ ==\ rhs.expectation\_base\_;}
\DoxyCodeLine{00509\ \ \ \}}
\DoxyCodeLine{00510\ }
\DoxyCodeLine{00511\ \ \ \textcolor{keywordtype}{bool}\ operator!=(\textcolor{keyword}{const}\ Expectation\&\ rhs)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ !(*\textcolor{keyword}{this}\ ==\ rhs);\ \}}
\DoxyCodeLine{00512\ }
\DoxyCodeLine{00513\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00514\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }ExpectationSet;}
\DoxyCodeLine{00515\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }Sequence;}
\DoxyCodeLine{00516\ \ \ \textcolor{keyword}{friend}\ class\ ::testing::internal::ExpectationBase;}
\DoxyCodeLine{00517\ \ \ \textcolor{keyword}{friend}\ class\ ::testing::internal::UntypedFunctionMockerBase;}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00520\ \ \ \textcolor{keyword}{friend}\ class\ ::testing::internal::FunctionMocker;}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{00523\ \ \ \textcolor{keyword}{friend}\ class\ ::testing::internal::TypedExpectation;}
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00525\ \ \ \textcolor{comment}{//\ This\ comparator\ is\ needed\ for\ putting\ Expectation\ objects\ into\ a\ set.}}
\DoxyCodeLine{00526\ \ \ \textcolor{keyword}{class\ }Less\ \{}
\DoxyCodeLine{00527\ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00528\ \ \ \ \ \textcolor{keywordtype}{bool}\ operator()(\textcolor{keyword}{const}\ Expectation\&\ lhs,\ \textcolor{keyword}{const}\ Expectation\&\ rhs)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ lhs.expectation\_base\_.get()\ <\ rhs.expectation\_base\_.get();}
\DoxyCodeLine{00530\ \ \ \ \ \}}
\DoxyCodeLine{00531\ \ \ \};}
\DoxyCodeLine{00532\ }
\DoxyCodeLine{00533\ \ \ typedef\ ::std::set<Expectation,\ Less>\ Set;}
\DoxyCodeLine{00534\ }
\DoxyCodeLine{00535\ \ \ Expectation(}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<internal::ExpectationBase>\&\ expectation\_base);}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \textcolor{comment}{//\ Returns\ the\ expectation\ this\ object\ references.}}
\DoxyCodeLine{00539\ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<internal::ExpectationBase>\&\ expectation\_base()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00540\ \ \ \ \ \textcolor{keywordflow}{return}\ expectation\_base\_;}
\DoxyCodeLine{00541\ \ \ \}}
\DoxyCodeLine{00542\ }
\DoxyCodeLine{00543\ \ \ \textcolor{comment}{//\ A\ shared\_ptr\ that\ co-\/owns\ the\ expectation\ this\ handle\ references.}}
\DoxyCodeLine{00544\ \ \ std::shared\_ptr<internal::ExpectationBase>\ expectation\_base\_;}
\DoxyCodeLine{00545\ \};}
\DoxyCodeLine{00546\ }
\DoxyCodeLine{00547\ \textcolor{comment}{//\ A\ set\ of\ expectation\ handles.\ \ Useful\ in\ the\ .After()\ clause\ of}}
\DoxyCodeLine{00548\ \textcolor{comment}{//\ EXPECT\_CALL()\ for\ setting\ the\ (partial)\ order\ of\ expectations.\ \ The}}
\DoxyCodeLine{00549\ \textcolor{comment}{//\ syntax:}}
\DoxyCodeLine{00550\ \textcolor{comment}{//}}
\DoxyCodeLine{00551\ \textcolor{comment}{//\ \ \ ExpectationSet\ es;}}
\DoxyCodeLine{00552\ \textcolor{comment}{//\ \ \ es\ +=\ EXPECT\_CALL(...)...;}}
\DoxyCodeLine{00553\ \textcolor{comment}{//\ \ \ es\ +=\ EXPECT\_CALL(...)...;}}
\DoxyCodeLine{00554\ \textcolor{comment}{//\ \ \ EXPECT\_CALL(...).After(es)...;}}
\DoxyCodeLine{00555\ \textcolor{comment}{//}}
\DoxyCodeLine{00556\ \textcolor{comment}{//\ sets\ three\ expectations\ where\ the\ last\ one\ can\ only\ be\ matched}}
\DoxyCodeLine{00557\ \textcolor{comment}{//\ after\ the\ first\ two\ have\ both\ been\ satisfied.}}
\DoxyCodeLine{00558\ \textcolor{comment}{//}}
\DoxyCodeLine{00559\ \textcolor{comment}{//\ This\ class\ is\ copyable\ and\ has\ value\ semantics.}}
\DoxyCodeLine{00560\ \textcolor{keyword}{class\ }ExpectationSet\ \{}
\DoxyCodeLine{00561\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00562\ \ \ \textcolor{comment}{//\ A\ bidirectional\ iterator\ that\ can\ read\ a\ const\ element\ in\ the\ set.}}
\DoxyCodeLine{00563\ \ \ \textcolor{keyword}{typedef}\ Expectation::Set::const\_iterator\ const\_iterator;}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \ \ \textcolor{comment}{//\ An\ object\ stored\ in\ the\ set.\ \ This\ is\ an\ alias\ of\ Expectation.}}
\DoxyCodeLine{00566\ \ \ \textcolor{keyword}{typedef}\ Expectation::Set::value\_type\ value\_type;}
\DoxyCodeLine{00567\ }
\DoxyCodeLine{00568\ \ \ \textcolor{comment}{//\ Constructs\ an\ empty\ set.}}
\DoxyCodeLine{00569\ \ \ ExpectationSet()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \ \ \textcolor{comment}{//\ This\ single-\/argument\ ctor\ must\ not\ be\ explicit,\ in\ order\ to\ support\ the}}
\DoxyCodeLine{00572\ \ \ \textcolor{comment}{//\ \ \ ExpectationSet\ es\ =\ EXPECT\_CALL(...);}}
\DoxyCodeLine{00573\ \ \ \textcolor{comment}{//\ syntax.}}
\DoxyCodeLine{00574\ \ \ ExpectationSet(internal::ExpectationBase\&\ exp)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00575\ \ \ \ \ *\textcolor{keyword}{this}\ +=\ Expectation(exp);}
\DoxyCodeLine{00576\ \ \ \}}
\DoxyCodeLine{00577\ }
\DoxyCodeLine{00578\ \ \ \textcolor{comment}{//\ This\ single-\/argument\ ctor\ implements\ implicit\ conversion\ from}}
\DoxyCodeLine{00579\ \ \ \textcolor{comment}{//\ Expectation\ and\ thus\ must\ not\ be\ explicit.\ \ This\ allows\ either\ an}}
\DoxyCodeLine{00580\ \ \ \textcolor{comment}{//\ Expectation\ or\ an\ ExpectationSet\ to\ be\ used\ in\ .After().}}
\DoxyCodeLine{00581\ \ \ ExpectationSet(\textcolor{keyword}{const}\ Expectation\&\ e)\ \{\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{00582\ \ \ \ \ *\textcolor{keyword}{this}\ +=\ e;}
\DoxyCodeLine{00583\ \ \ \}}
\DoxyCodeLine{00584\ }
\DoxyCodeLine{00585\ \ \ \textcolor{comment}{//\ The\ compiler-\/generator\ ctor\ and\ operator=\ works\ exactly\ as}}
\DoxyCodeLine{00586\ \ \ \textcolor{comment}{//\ intended,\ so\ we\ don't\ need\ to\ define\ our\ own.}}
\DoxyCodeLine{00587\ }
\DoxyCodeLine{00588\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ rhs\ contains\ the\ same\ set\ of\ Expectation}}
\DoxyCodeLine{00589\ \ \ \textcolor{comment}{//\ objects\ as\ this\ does.}}
\DoxyCodeLine{00590\ \ \ \textcolor{keywordtype}{bool}\ operator==(\textcolor{keyword}{const}\ ExpectationSet\&\ rhs)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{keywordflow}{return}\ expectations\_\ ==\ rhs.expectations\_;}
\DoxyCodeLine{00592\ \ \ \}}
\DoxyCodeLine{00593\ }
\DoxyCodeLine{00594\ \ \ \textcolor{keywordtype}{bool}\ operator!=(\textcolor{keyword}{const}\ ExpectationSet\&\ rhs)\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ !(*\textcolor{keyword}{this}\ ==\ rhs);\ \}}
\DoxyCodeLine{00595\ }
\DoxyCodeLine{00596\ \ \ \textcolor{comment}{//\ Implements\ the\ syntax}}
\DoxyCodeLine{00597\ \ \ \textcolor{comment}{//\ \ \ expectation\_set\ +=\ EXPECT\_CALL(...);}}
\DoxyCodeLine{00598\ \ \ ExpectationSet\&\ operator+=(\textcolor{keyword}{const}\ Expectation\&\ e)\ \{}
\DoxyCodeLine{00599\ \ \ \ \ expectations\_.insert(e);}
\DoxyCodeLine{00600\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00601\ \ \ \}}
\DoxyCodeLine{00602\ }
\DoxyCodeLine{00603\ \ \ \textcolor{keywordtype}{int}\ size()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(expectations\_.size());\ \}}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \ \ const\_iterator\ begin()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ expectations\_.begin();\ \}}
\DoxyCodeLine{00606\ \ \ const\_iterator\ end()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ expectations\_.end();\ \}}
\DoxyCodeLine{00607\ }
\DoxyCodeLine{00608\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00609\ \ \ Expectation::Set\ expectations\_;}
\DoxyCodeLine{00610\ \};}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \textcolor{comment}{//\ Sequence\ objects\ are\ used\ by\ a\ user\ to\ specify\ the\ relative\ order}}
\DoxyCodeLine{00613\ \textcolor{comment}{//\ in\ which\ the\ expectations\ should\ match.\ \ They\ are\ copyable\ (we\ rely}}
\DoxyCodeLine{00614\ \textcolor{comment}{//\ on\ the\ compiler-\/defined\ copy\ constructor\ and\ assignment\ operator).}}
\DoxyCodeLine{00615\ \textcolor{keyword}{class\ }GTEST\_API\_\ Sequence\ \{}
\DoxyCodeLine{00616\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00617\ \ \ \textcolor{comment}{//\ Constructs\ an\ empty\ sequence.}}
\DoxyCodeLine{00618\ \ \ Sequence()\ :\ last\_expectation\_(new\ Expectation)\ \{\}}
\DoxyCodeLine{00619\ }
\DoxyCodeLine{00620\ \ \ \textcolor{comment}{//\ Adds\ an\ expectation\ to\ this\ sequence.\ \ The\ caller\ must\ ensure}}
\DoxyCodeLine{00621\ \ \ \textcolor{comment}{//\ that\ no\ other\ thread\ is\ accessing\ this\ Sequence\ object.}}
\DoxyCodeLine{00622\ \ \ \textcolor{keywordtype}{void}\ AddExpectation(\textcolor{keyword}{const}\ Expectation\&\ expectation)\ \textcolor{keyword}{const};}
\DoxyCodeLine{00623\ }
\DoxyCodeLine{00624\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00625\ \ \ \textcolor{comment}{//\ The\ last\ expectation\ in\ this\ sequence.}}
\DoxyCodeLine{00626\ \ \ std::shared\_ptr<Expectation>\ last\_expectation\_;}
\DoxyCodeLine{00627\ \};\ \ \textcolor{comment}{//\ class\ Sequence}}
\DoxyCodeLine{00628\ }
\DoxyCodeLine{00629\ \textcolor{comment}{//\ An\ object\ of\ this\ type\ causes\ all\ EXPECT\_CALL()\ statements}}
\DoxyCodeLine{00630\ \textcolor{comment}{//\ encountered\ in\ its\ scope\ to\ be\ put\ in\ an\ anonymous\ sequence.\ \ The}}
\DoxyCodeLine{00631\ \textcolor{comment}{//\ work\ is\ done\ in\ the\ constructor\ and\ destructor.\ \ You\ should\ only}}
\DoxyCodeLine{00632\ \textcolor{comment}{//\ create\ an\ InSequence\ object\ on\ the\ stack.}}
\DoxyCodeLine{00633\ \textcolor{comment}{//}}
\DoxyCodeLine{00634\ \textcolor{comment}{//\ The\ sole\ purpose\ for\ this\ class\ is\ to\ support\ easy\ definition\ of}}
\DoxyCodeLine{00635\ \textcolor{comment}{//\ sequential\ expectations,\ e.g.}}
\DoxyCodeLine{00636\ \textcolor{comment}{//}}
\DoxyCodeLine{00637\ \textcolor{comment}{//\ \ \ \{}}
\DoxyCodeLine{00638\ \textcolor{comment}{//\ \ \ \ \ InSequence\ dummy;\ \ //\ The\ name\ of\ the\ object\ doesn't\ matter.}}
\DoxyCodeLine{00639\ \textcolor{comment}{//}}
\DoxyCodeLine{00640\ \textcolor{comment}{//\ \ \ \ \ //\ The\ following\ expectations\ must\ match\ in\ the\ order\ they\ appear.}}
\DoxyCodeLine{00641\ \textcolor{comment}{//\ \ \ \ \ EXPECT\_CALL(a,\ Bar())...;}}
\DoxyCodeLine{00642\ \textcolor{comment}{//\ \ \ \ \ EXPECT\_CALL(a,\ Baz())...;}}
\DoxyCodeLine{00643\ \textcolor{comment}{//\ \ \ \ \ ...}}
\DoxyCodeLine{00644\ \textcolor{comment}{//\ \ \ \ \ EXPECT\_CALL(b,\ Xyz())...;}}
\DoxyCodeLine{00645\ \textcolor{comment}{//\ \ \ \}}}
\DoxyCodeLine{00646\ \textcolor{comment}{//}}
\DoxyCodeLine{00647\ \textcolor{comment}{//\ You\ can\ create\ InSequence\ objects\ in\ multiple\ threads,\ as\ long\ as}}
\DoxyCodeLine{00648\ \textcolor{comment}{//\ they\ are\ used\ to\ affect\ different\ mock\ objects.\ \ The\ idea\ is\ that}}
\DoxyCodeLine{00649\ \textcolor{comment}{//\ each\ thread\ can\ create\ and\ set\ up\ its\ own\ mocks\ as\ if\ it's\ the\ only}}
\DoxyCodeLine{00650\ \textcolor{comment}{//\ thread.\ \ However,\ for\ clarity\ of\ your\ tests\ we\ recommend\ you\ to\ set}}
\DoxyCodeLine{00651\ \textcolor{comment}{//\ up\ mocks\ in\ the\ main\ thread\ unless\ you\ have\ a\ good\ reason\ not\ to\ do}}
\DoxyCodeLine{00652\ \textcolor{comment}{//\ so.}}
\DoxyCodeLine{00653\ \textcolor{keyword}{class\ }GTEST\_API\_\ InSequence\ \{}
\DoxyCodeLine{00654\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00655\ \ \ InSequence();}
\DoxyCodeLine{00656\ \ \ \string~InSequence();}
\DoxyCodeLine{00657\ }
\DoxyCodeLine{00658\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00659\ \ \ \textcolor{keywordtype}{bool}\ sequence\_created\_;}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \ \ InSequence(\textcolor{keyword}{const}\ InSequence\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00662\ \ \ InSequence\&\ operator=(\textcolor{keyword}{const}\ InSequence\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{00663\ \};}
\DoxyCodeLine{00664\ }
\DoxyCodeLine{00665\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{00666\ }
\DoxyCodeLine{00667\ \textcolor{comment}{//\ Points\ to\ the\ implicit\ sequence\ introduced\ by\ a\ living\ InSequence}}
\DoxyCodeLine{00668\ \textcolor{comment}{//\ object\ (if\ any)\ in\ the\ current\ thread\ or\ NULL.}}
\DoxyCodeLine{00669\ GTEST\_API\_\ \textcolor{keyword}{extern}\ ThreadLocal<Sequence*>\ g\_gmock\_implicit\_sequence;}
\DoxyCodeLine{00670\ }
\DoxyCodeLine{00671\ \textcolor{comment}{//\ Base\ class\ for\ implementing\ expectations.}}
\DoxyCodeLine{00672\ \textcolor{comment}{//}}
\DoxyCodeLine{00673\ \textcolor{comment}{//\ There\ are\ two\ reasons\ for\ having\ a\ type-\/agnostic\ base\ class\ for}}
\DoxyCodeLine{00674\ \textcolor{comment}{//\ Expectation:}}
\DoxyCodeLine{00675\ \textcolor{comment}{//}}
\DoxyCodeLine{00676\ \textcolor{comment}{//\ \ \ 1.\ We\ need\ to\ store\ collections\ of\ expectations\ of\ different}}
\DoxyCodeLine{00677\ \textcolor{comment}{//\ \ \ types\ (e.g.\ all\ pre-\/requisites\ of\ a\ particular\ expectation,\ all}}
\DoxyCodeLine{00678\ \textcolor{comment}{//\ \ \ expectations\ in\ a\ sequence).\ \ Therefore\ these\ expectation\ objects}}
\DoxyCodeLine{00679\ \textcolor{comment}{//\ \ \ must\ share\ a\ common\ base\ class.}}
\DoxyCodeLine{00680\ \textcolor{comment}{//}}
\DoxyCodeLine{00681\ \textcolor{comment}{//\ \ \ 2.\ We\ can\ avoid\ binary\ code\ bloat\ by\ moving\ methods\ not\ depending}}
\DoxyCodeLine{00682\ \textcolor{comment}{//\ \ \ on\ the\ template\ argument\ of\ Expectation\ to\ the\ base\ class.}}
\DoxyCodeLine{00683\ \textcolor{comment}{//}}
\DoxyCodeLine{00684\ \textcolor{comment}{//\ This\ class\ is\ internal\ and\ mustn't\ be\ used\ by\ user\ code\ directly.}}
\DoxyCodeLine{00685\ \textcolor{keyword}{class\ }GTEST\_API\_\ ExpectationBase\ \{}
\DoxyCodeLine{00686\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00687\ \ \ \textcolor{comment}{//\ source\_text\ is\ the\ EXPECT\_CALL(...)\ source\ that\ created\ this\ Expectation.}}
\DoxyCodeLine{00688\ \ \ ExpectationBase(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \textcolor{keywordtype}{int}\ line,\ \textcolor{keyword}{const}\ std::string\&\ source\_text);}
\DoxyCodeLine{00689\ }
\DoxyCodeLine{00690\ \ \ \textcolor{keyword}{virtual}\ \string~ExpectationBase();}
\DoxyCodeLine{00691\ }
\DoxyCodeLine{00692\ \ \ \textcolor{comment}{//\ Where\ in\ the\ source\ file\ was\ the\ expectation\ spec\ defined?}}
\DoxyCodeLine{00693\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ file\_;\ \}}
\DoxyCodeLine{00694\ \ \ \textcolor{keywordtype}{int}\ line()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ line\_;\ \}}
\DoxyCodeLine{00695\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ source\_text()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ source\_text\_.c\_str();\ \}}
\DoxyCodeLine{00696\ \ \ \textcolor{comment}{//\ Returns\ the\ cardinality\ specified\ in\ the\ expectation\ spec.}}
\DoxyCodeLine{00697\ \ \ \textcolor{keyword}{const}\ Cardinality\&\ cardinality()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ cardinality\_;\ \}}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \textcolor{comment}{//\ Describes\ the\ source\ file\ location\ of\ this\ expectation.}}
\DoxyCodeLine{00700\ \ \ \textcolor{keywordtype}{void}\ DescribeLocationTo(::std::ostream*\ os)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00701\ \ \ \ \ *os\ <<\ FormatFileLocation(file(),\ line())\ <<\ \textcolor{stringliteral}{"{}\ "{}};}
\DoxyCodeLine{00702\ \ \ \}}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \textcolor{comment}{//\ Describes\ how\ many\ times\ a\ function\ call\ matching\ this}}
\DoxyCodeLine{00705\ \ \ \textcolor{comment}{//\ expectation\ has\ occurred.}}
\DoxyCodeLine{00706\ \ \ \textcolor{keywordtype}{void}\ DescribeCallCountTo(::std::ostream*\ os)\ \textcolor{keyword}{const}}
\DoxyCodeLine{00707\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00708\ }
\DoxyCodeLine{00709\ \ \ \textcolor{comment}{//\ If\ this\ mock\ method\ has\ an\ extra\ matcher\ (i.e.\ .With(matcher)),}}
\DoxyCodeLine{00710\ \ \ \textcolor{comment}{//\ describes\ it\ to\ the\ ostream.}}
\DoxyCodeLine{00711\ \ \ \textcolor{keyword}{virtual}\ \textcolor{keywordtype}{void}\ MaybeDescribeExtraMatcherTo(::std::ostream*\ os)\ =\ 0;}
\DoxyCodeLine{00712\ }
\DoxyCodeLine{00713\ \ \ \textcolor{comment}{//\ Do\ not\ rely\ on\ this\ for\ correctness.}}
\DoxyCodeLine{00714\ \ \ \textcolor{comment}{//\ This\ is\ only\ for\ making\ human-\/readable\ test\ output\ easier\ to\ understand.}}
\DoxyCodeLine{00715\ \ \ \textcolor{keywordtype}{void}\ UntypedDescription(std::string\ description)\ \{}
\DoxyCodeLine{00716\ \ \ \ \ description\_\ =\ std::move(description);}
\DoxyCodeLine{00717\ \ \ \}}
\DoxyCodeLine{00718\ }
\DoxyCodeLine{00719\ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00720\ \ \ \textcolor{keyword}{friend}\ class\ ::testing::Expectation;}
\DoxyCodeLine{00721\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }UntypedFunctionMockerBase;}
\DoxyCodeLine{00722\ }
\DoxyCodeLine{00723\ \ \ \textcolor{keyword}{enum}\ Clause\ \{}
\DoxyCodeLine{00724\ \ \ \ \ \textcolor{comment}{//\ Don't\ change\ the\ order\ of\ the\ enum\ members!}}
\DoxyCodeLine{00725\ \ \ \ \ kNone,}
\DoxyCodeLine{00726\ \ \ \ \ kWith,}
\DoxyCodeLine{00727\ \ \ \ \ kTimes,}
\DoxyCodeLine{00728\ \ \ \ \ kInSequence,}
\DoxyCodeLine{00729\ \ \ \ \ kAfter,}
\DoxyCodeLine{00730\ \ \ \ \ kWillOnce,}
\DoxyCodeLine{00731\ \ \ \ \ kWillRepeatedly,}
\DoxyCodeLine{00732\ \ \ \ \ kRetiresOnSaturation}
\DoxyCodeLine{00733\ \ \ \};}
\DoxyCodeLine{00734\ }
\DoxyCodeLine{00735\ \ \ \textcolor{keyword}{typedef}\ std::vector<const\ void*>\ UntypedActions;}
\DoxyCodeLine{00736\ }
\DoxyCodeLine{00737\ \ \ \textcolor{comment}{//\ Returns\ an\ Expectation\ object\ that\ references\ and\ co-\/owns\ this}}
\DoxyCodeLine{00738\ \ \ \textcolor{comment}{//\ expectation.}}
\DoxyCodeLine{00739\ \ \ \textcolor{keyword}{virtual}\ Expectation\ GetHandle()\ =\ 0;}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \textcolor{comment}{//\ Asserts\ that\ the\ EXPECT\_CALL()\ statement\ has\ the\ given\ property.}}
\DoxyCodeLine{00742\ \ \ \textcolor{keywordtype}{void}\ AssertSpecProperty(\textcolor{keywordtype}{bool}\ property,}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ failure\_message)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00744\ \ \ \ \ Assert(property,\ file\_,\ line\_,\ failure\_message);}
\DoxyCodeLine{00745\ \ \ \}}
\DoxyCodeLine{00746\ }
\DoxyCodeLine{00747\ \ \ \textcolor{comment}{//\ Expects\ that\ the\ EXPECT\_CALL()\ statement\ has\ the\ given\ property.}}
\DoxyCodeLine{00748\ \ \ \textcolor{keywordtype}{void}\ ExpectSpecProperty(\textcolor{keywordtype}{bool}\ property,}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ failure\_message)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00750\ \ \ \ \ Expect(property,\ file\_,\ line\_,\ failure\_message);}
\DoxyCodeLine{00751\ \ \ \}}
\DoxyCodeLine{00752\ }
\DoxyCodeLine{00753\ \ \ \textcolor{comment}{//\ Explicitly\ specifies\ the\ cardinality\ of\ this\ expectation.\ \ Used}}
\DoxyCodeLine{00754\ \ \ \textcolor{comment}{//\ by\ the\ subclasses\ to\ implement\ the\ .Times()\ clause.}}
\DoxyCodeLine{00755\ \ \ \textcolor{keywordtype}{void}\ SpecifyCardinality(\textcolor{keyword}{const}\ Cardinality\&\ cardinality);}
\DoxyCodeLine{00756\ }
\DoxyCodeLine{00757\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ the\ user\ specified\ the\ cardinality}}
\DoxyCodeLine{00758\ \ \ \textcolor{comment}{//\ explicitly\ using\ a\ .Times().}}
\DoxyCodeLine{00759\ \ \ \textcolor{keywordtype}{bool}\ cardinality\_specified()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ cardinality\_specified\_;\ \}}
\DoxyCodeLine{00760\ }
\DoxyCodeLine{00761\ \ \ \textcolor{comment}{//\ Sets\ the\ cardinality\ of\ this\ expectation\ spec.}}
\DoxyCodeLine{00762\ \ \ \textcolor{keywordtype}{void}\ set\_cardinality(\textcolor{keyword}{const}\ Cardinality\&\ a\_cardinality)\ \{}
\DoxyCodeLine{00763\ \ \ \ \ cardinality\_\ =\ a\_cardinality;}
\DoxyCodeLine{00764\ \ \ \}}
\DoxyCodeLine{00765\ }
\DoxyCodeLine{00766\ \ \ \textcolor{comment}{//\ The\ following\ group\ of\ methods\ should\ only\ be\ called\ after\ the}}
\DoxyCodeLine{00767\ \ \ \textcolor{comment}{//\ EXPECT\_CALL()\ statement,\ and\ only\ when\ g\_gmock\_mutex\ is\ held\ by}}
\DoxyCodeLine{00768\ \ \ \textcolor{comment}{//\ the\ current\ thread.}}
\DoxyCodeLine{00769\ }
\DoxyCodeLine{00770\ \ \ \textcolor{comment}{//\ Retires\ all\ pre-\/requisites\ of\ this\ expectation.}}
\DoxyCodeLine{00771\ \ \ \textcolor{keywordtype}{void}\ RetireAllPreRequisites()\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00772\ }
\DoxyCodeLine{00773\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ this\ expectation\ is\ retired.}}
\DoxyCodeLine{00774\ \ \ \textcolor{keywordtype}{bool}\ is\_retired()\ const\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{00775\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{00776\ \ \ \ \ \textcolor{keywordflow}{return}\ retired\_;}
\DoxyCodeLine{00777\ \ \ \}}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \textcolor{comment}{//\ Retires\ this\ expectation.}}
\DoxyCodeLine{00780\ \ \ \textcolor{keywordtype}{void}\ Retire()\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{00781\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{00782\ \ \ \ \ retired\_\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00783\ \ \ \}}
\DoxyCodeLine{00784\ }
\DoxyCodeLine{00785\ \ \ \textcolor{comment}{//\ Returns\ a\ human-\/readable\ description\ of\ this\ expectation.}}
\DoxyCodeLine{00786\ \ \ \textcolor{comment}{//\ Do\ not\ rely\ on\ this\ for\ correctness.\ It\ is\ only\ for\ human\ readability.}}
\DoxyCodeLine{00787\ \ \ \textcolor{keyword}{const}\ std::string\&\ GetDescription()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ description\_;\ \}}
\DoxyCodeLine{00788\ }
\DoxyCodeLine{00789\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ this\ expectation\ is\ satisfied.}}
\DoxyCodeLine{00790\ \ \ \textcolor{keywordtype}{bool}\ IsSatisfied()\ const\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{00791\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{00792\ \ \ \ \ \textcolor{keywordflow}{return}\ cardinality().IsSatisfiedByCallCount(call\_count\_);}
\DoxyCodeLine{00793\ \ \ \}}
\DoxyCodeLine{00794\ }
\DoxyCodeLine{00795\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ this\ expectation\ is\ saturated.}}
\DoxyCodeLine{00796\ \ \ \textcolor{keywordtype}{bool}\ IsSaturated()\ const\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{00797\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{00798\ \ \ \ \ \textcolor{keywordflow}{return}\ cardinality().IsSaturatedByCallCount(call\_count\_);}
\DoxyCodeLine{00799\ \ \ \}}
\DoxyCodeLine{00800\ }
\DoxyCodeLine{00801\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ this\ expectation\ is\ over-\/saturated.}}
\DoxyCodeLine{00802\ \ \ \textcolor{keywordtype}{bool}\ IsOverSaturated()\ const\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{00803\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{00804\ \ \ \ \ \textcolor{keywordflow}{return}\ cardinality().IsOverSaturatedByCallCount(call\_count\_);}
\DoxyCodeLine{00805\ \ \ \}}
\DoxyCodeLine{00806\ }
\DoxyCodeLine{00807\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ all\ pre-\/requisites\ of\ this\ expectation\ are}}
\DoxyCodeLine{00808\ \ \ \textcolor{comment}{//\ satisfied.}}
\DoxyCodeLine{00809\ \ \ \textcolor{keywordtype}{bool}\ AllPrerequisitesAreSatisfied()\ const}
\DoxyCodeLine{00810\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00811\ }
\DoxyCodeLine{00812\ \ \ \textcolor{comment}{//\ Adds\ unsatisfied\ pre-\/requisites\ of\ this\ expectation\ to\ 'result'.}}
\DoxyCodeLine{00813\ \ \ \textcolor{keywordtype}{void}\ FindUnsatisfiedPrerequisites(ExpectationSet*\ result)\ const}
\DoxyCodeLine{00814\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex);}
\DoxyCodeLine{00815\ }
\DoxyCodeLine{00816\ \ \ \textcolor{comment}{//\ Returns\ the\ number\ this\ expectation\ has\ been\ invoked.}}
\DoxyCodeLine{00817\ \ \ \textcolor{keywordtype}{int}\ call\_count()\ const\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{00818\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{00819\ \ \ \ \ \textcolor{keywordflow}{return}\ call\_count\_;}
\DoxyCodeLine{00820\ \ \ \}}
\DoxyCodeLine{00821\ }
\DoxyCodeLine{00822\ \ \ \textcolor{comment}{//\ Increments\ the\ number\ this\ expectation\ has\ been\ invoked.}}
\DoxyCodeLine{00823\ \ \ \textcolor{keywordtype}{void}\ IncrementCallCount()\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{00824\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{00825\ \ \ \ \ call\_count\_++;}
\DoxyCodeLine{00826\ \ \ \}}
\DoxyCodeLine{00827\ }
\DoxyCodeLine{00828\ \ \ \textcolor{comment}{//\ Checks\ the\ action\ count\ (i.e.\ the\ number\ of\ WillOnce()\ and}}
\DoxyCodeLine{00829\ \ \ \textcolor{comment}{//\ WillRepeatedly()\ clauses)\ against\ the\ cardinality\ if\ this\ hasn't}}
\DoxyCodeLine{00830\ \ \ \textcolor{comment}{//\ been\ done\ before.\ \ Prints\ a\ warning\ if\ there\ are\ too\ many\ or\ too}}
\DoxyCodeLine{00831\ \ \ \textcolor{comment}{//\ few\ actions.}}
\DoxyCodeLine{00832\ \ \ \textcolor{keywordtype}{void}\ CheckActionCountIfNotDone()\ const\ GTEST\_LOCK\_EXCLUDED\_(mutex\_);}
\DoxyCodeLine{00833\ }
\DoxyCodeLine{00834\ \ \ friend\ class\ ::testing::Sequence;}
\DoxyCodeLine{00835\ \ \ friend\ class\ ::testing::internal::ExpectationTester;}
\DoxyCodeLine{00836\ }
\DoxyCodeLine{00837\ \ \ template\ <typename\ Function>}
\DoxyCodeLine{00838\ \ \ friend\ class\ TypedExpectation;}
\DoxyCodeLine{00839\ }
\DoxyCodeLine{00840\ \ \ \textcolor{comment}{//\ Implements\ the\ .Times()\ clause.}}
\DoxyCodeLine{00841\ \ \ \textcolor{keywordtype}{void}\ UntypedTimes(const\ Cardinality\&\ a\_cardinality);}
\DoxyCodeLine{00842\ }
\DoxyCodeLine{00843\ \ \ \textcolor{comment}{//\ This\ group\ of\ fields\ are\ part\ of\ the\ spec\ and\ won't\ change\ after}}
\DoxyCodeLine{00844\ \ \ \textcolor{comment}{//\ an\ EXPECT\_CALL()\ statement\ finishes.}}
\DoxyCodeLine{00845\ \ \ const\ \textcolor{keywordtype}{char}*\ file\_;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ file\ that\ contains\ the\ expectation.}}
\DoxyCodeLine{00846\ \ \ \textcolor{keywordtype}{int}\ line\_;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ The\ line\ number\ of\ the\ expectation.}}
\DoxyCodeLine{00847\ \ \ const\ std::\textcolor{keywordtype}{string}\ source\_text\_;\ \ \textcolor{comment}{//\ The\ EXPECT\_CALL(...)\ source\ text.}}
\DoxyCodeLine{00848\ \ \ std::\textcolor{keywordtype}{string}\ description\_;\ \ \ \ \ \ \ \ \textcolor{comment}{//\ User-\/readable\ name\ for\ the\ expectation.}}
\DoxyCodeLine{00849\ \ \ \textcolor{comment}{//\ True\ if\ and\ only\ if\ the\ cardinality\ is\ specified\ explicitly.}}
\DoxyCodeLine{00850\ \ \ \textcolor{keywordtype}{bool}\ cardinality\_specified\_;}
\DoxyCodeLine{00851\ \ \ Cardinality\ cardinality\_;\ \ \textcolor{comment}{//\ The\ cardinality\ of\ the\ expectation.}}
\DoxyCodeLine{00852\ \ \ \textcolor{comment}{//\ The\ immediate\ pre-\/requisites\ (i.e.\ expectations\ that\ must\ be}}
\DoxyCodeLine{00853\ \ \ \textcolor{comment}{//\ satisfied\ before\ this\ expectation\ can\ be\ matched)\ of\ this}}
\DoxyCodeLine{00854\ \ \ \textcolor{comment}{//\ expectation.\ \ We\ use\ std::shared\_ptr\ in\ the\ set\ because\ we\ want\ an}}
\DoxyCodeLine{00855\ \ \ \textcolor{comment}{//\ Expectation\ object\ to\ be\ co-\/owned\ by\ its\ FunctionMocker\ and\ its}}
\DoxyCodeLine{00856\ \ \ \textcolor{comment}{//\ successors.\ \ This\ allows\ multiple\ mock\ objects\ to\ be\ deleted\ at}}
\DoxyCodeLine{00857\ \ \ \textcolor{comment}{//\ different\ times.}}
\DoxyCodeLine{00858\ \ \ ExpectationSet\ immediate\_prerequisites\_;}
\DoxyCodeLine{00859\ }
\DoxyCodeLine{00860\ \ \ \textcolor{comment}{//\ This\ group\ of\ fields\ are\ the\ current\ state\ of\ the\ expectation,}}
\DoxyCodeLine{00861\ \ \ \textcolor{comment}{//\ and\ can\ change\ as\ the\ mock\ function\ is\ called.}}
\DoxyCodeLine{00862\ \ \ \textcolor{keywordtype}{int}\ call\_count\_;\ \ \textcolor{comment}{//\ How\ many\ times\ this\ expectation\ has\ been\ invoked.}}
\DoxyCodeLine{00863\ \ \ \textcolor{keywordtype}{bool}\ retired\_;\ \ \ \ \textcolor{comment}{//\ True\ if\ and\ only\ if\ this\ expectation\ has\ retired.}}
\DoxyCodeLine{00864\ \ \ UntypedActions\ untyped\_actions\_;}
\DoxyCodeLine{00865\ \ \ \textcolor{keywordtype}{bool}\ extra\_matcher\_specified\_;}
\DoxyCodeLine{00866\ \ \ \textcolor{keywordtype}{bool}\ repeated\_action\_specified\_;\ \ \textcolor{comment}{//\ True\ if\ a\ WillRepeatedly()\ was\ specified.}}
\DoxyCodeLine{00867\ \ \ \textcolor{keywordtype}{bool}\ retires\_on\_saturation\_;}
\DoxyCodeLine{00868\ \ \ Clause\ last\_clause\_;}
\DoxyCodeLine{00869\ \ \ mutable\ \textcolor{keywordtype}{bool}\ action\_count\_checked\_;\ \ \textcolor{comment}{//\ Under\ mutex\_.}}
\DoxyCodeLine{00870\ \ \ mutable\ Mutex\ mutex\_;\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Protects\ action\_count\_checked\_.}}
\DoxyCodeLine{00871\ \};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ class\ ExpectationBase}}
\DoxyCodeLine{00872\ }
\DoxyCodeLine{00873\ template\ <typename\ F>}
\DoxyCodeLine{00874\ class\ TypedExpectation;}
\DoxyCodeLine{00875\ }
\DoxyCodeLine{00876\ \textcolor{comment}{//\ Implements\ an\ expectation\ for\ the\ given\ function\ type.}}
\DoxyCodeLine{00877\ template\ <typename\ R,\ typename...\ Args>}
\DoxyCodeLine{00878\ class\ TypedExpectation<R(Args...)>\ :\ public\ ExpectationBase\ \{}
\DoxyCodeLine{00879\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00880\ \ \ \textcolor{keyword}{using\ }F\ =\ R(Args...);}
\DoxyCodeLine{00881\ }
\DoxyCodeLine{00882\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00883\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Function<F>::ArgumentTuple\ ArgumentTuple;}
\DoxyCodeLine{00884\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Function<F>::ArgumentMatcherTuple\ ArgumentMatcherTuple;}
\DoxyCodeLine{00885\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ Function<F>::Result\ Result;}
\DoxyCodeLine{00886\ }
\DoxyCodeLine{00887\ \ \ TypedExpectation(FunctionMocker<F>*\ owner,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ a\_file,\ \textcolor{keywordtype}{int}\ a\_line,}
\DoxyCodeLine{00888\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ a\_source\_text,}
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ArgumentMatcherTuple\&\ m)}
\DoxyCodeLine{00890\ \ \ \ \ \ \ :\ ExpectationBase(a\_file,\ a\_line,\ a\_source\_text),}
\DoxyCodeLine{00891\ \ \ \ \ \ \ \ \ owner\_(owner),}
\DoxyCodeLine{00892\ \ \ \ \ \ \ \ \ matchers\_(m),}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ By\ default,\ extra\_matcher\_\ should\ match\ anything.\ \ However,}}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ we\ cannot\ initialize\ it\ with\ \_\ as\ that\ causes\ ambiguity\ between}}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Matcher's\ copy\ and\ move\ constructor\ for\ some\ argument\ types.}}
\DoxyCodeLine{00896\ \ \ \ \ \ \ \ \ extra\_matcher\_(A<const\ ArgumentTuple\&>()),}
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ repeated\_action\_(DoDefault())\ \{\}}
\DoxyCodeLine{00898\ }
\DoxyCodeLine{00899\ \ \ \string~TypedExpectation()\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{00900\ \ \ \ \ \textcolor{comment}{//\ Check\ the\ validity\ of\ the\ action\ count\ if\ it\ hasn't\ been\ done}}
\DoxyCodeLine{00901\ \ \ \ \ \textcolor{comment}{//\ yet\ (for\ example,\ if\ the\ expectation\ was\ never\ used).}}
\DoxyCodeLine{00902\ \ \ \ \ CheckActionCountIfNotDone();}
\DoxyCodeLine{00903\ \ \ \ \ \textcolor{keywordflow}{for}\ (UntypedActions::const\_iterator\ it\ =\ untyped\_actions\_.begin();}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ \ it\ !=\ untyped\_actions\_.end();\ ++it)\ \{}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }Action<F>*\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{00906\ \ \ \ \ \}}
\DoxyCodeLine{00907\ \ \ \}}
\DoxyCodeLine{00908\ }
\DoxyCodeLine{00909\ \ \ \textcolor{comment}{//\ Implements\ the\ .With()\ clause.}}
\DoxyCodeLine{00910\ \ \ TypedExpectation\&\ With(\textcolor{keyword}{const}\ Matcher<const\ ArgumentTuple\&>\&\ m)\ \{}
\DoxyCodeLine{00911\ \ \ \ \ \textcolor{keywordflow}{if}\ (last\_clause\_\ ==\ kWith)\ \{}
\DoxyCodeLine{00912\ \ \ \ \ \ \ ExpectSpecProperty(\textcolor{keyword}{false},}
\DoxyCodeLine{00913\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.With()\ cannot\ appear\ "{}}}
\DoxyCodeLine{00914\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}more\ than\ once\ in\ an\ EXPECT\_CALL()."{}});}
\DoxyCodeLine{00915\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00916\ \ \ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <\ kWith,}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.With()\ must\ be\ the\ first\ "{}}}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}clause\ in\ an\ EXPECT\_CALL()."{}});}
\DoxyCodeLine{00919\ \ \ \ \ \}}
\DoxyCodeLine{00920\ \ \ \ \ last\_clause\_\ =\ kWith;}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00922\ \ \ \ \ extra\_matcher\_\ =\ m;}
\DoxyCodeLine{00923\ \ \ \ \ extra\_matcher\_specified\_\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00924\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00925\ \ \ \}}
\DoxyCodeLine{00926\ }
\DoxyCodeLine{00927\ \ \ \textcolor{comment}{//\ Do\ not\ rely\ on\ this\ for\ correctness.}}
\DoxyCodeLine{00928\ \ \ \textcolor{comment}{//\ This\ is\ only\ for\ making\ human-\/readable\ test\ output\ easier\ to\ understand.}}
\DoxyCodeLine{00929\ \ \ TypedExpectation\&\ Description(std::string\ name)\ \{}
\DoxyCodeLine{00930\ \ \ \ \ ExpectationBase::UntypedDescription(std::move(name));}
\DoxyCodeLine{00931\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00932\ \ \ \}}
\DoxyCodeLine{00933\ }
\DoxyCodeLine{00934\ \ \ \textcolor{comment}{//\ Implements\ the\ .Times()\ clause.}}
\DoxyCodeLine{00935\ \ \ TypedExpectation\&\ Times(\textcolor{keyword}{const}\ Cardinality\&\ a\_cardinality)\ \{}
\DoxyCodeLine{00936\ \ \ \ \ ExpectationBase::UntypedTimes(a\_cardinality);}
\DoxyCodeLine{00937\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00938\ \ \ \}}
\DoxyCodeLine{00939\ }
\DoxyCodeLine{00940\ \ \ \textcolor{comment}{//\ Implements\ the\ .Times()\ clause.}}
\DoxyCodeLine{00941\ \ \ TypedExpectation\&\ Times(\textcolor{keywordtype}{int}\ n)\ \{\ \textcolor{keywordflow}{return}\ Times(Exactly(n));\ \}}
\DoxyCodeLine{00942\ }
\DoxyCodeLine{00943\ \ \ \textcolor{comment}{//\ Implements\ the\ .InSequence()\ clause.}}
\DoxyCodeLine{00944\ \ \ TypedExpectation\&\ InSequence(\textcolor{keyword}{const}\ Sequence\&\ s)\ \{}
\DoxyCodeLine{00945\ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <=\ kInSequence,}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.InSequence()\ cannot\ appear\ after\ .After(),"{}}}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ .WillOnce(),\ .WillRepeatedly(),\ or\ "{}}}
\DoxyCodeLine{00948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.RetiresOnSaturation()."{}});}
\DoxyCodeLine{00949\ \ \ \ \ last\_clause\_\ =\ kInSequence;}
\DoxyCodeLine{00950\ }
\DoxyCodeLine{00951\ \ \ \ \ s.AddExpectation(GetHandle());}
\DoxyCodeLine{00952\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00953\ \ \ \}}
\DoxyCodeLine{00954\ \ \ TypedExpectation\&\ InSequence(\textcolor{keyword}{const}\ Sequence\&\ s1,\ \textcolor{keyword}{const}\ Sequence\&\ s2)\ \{}
\DoxyCodeLine{00955\ \ \ \ \ \textcolor{keywordflow}{return}\ InSequence(s1).InSequence(s2);}
\DoxyCodeLine{00956\ \ \ \}}
\DoxyCodeLine{00957\ \ \ TypedExpectation\&\ InSequence(\textcolor{keyword}{const}\ Sequence\&\ s1,\ \textcolor{keyword}{const}\ Sequence\&\ s2,}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Sequence\&\ s3)\ \{}
\DoxyCodeLine{00959\ \ \ \ \ \textcolor{keywordflow}{return}\ InSequence(s1,\ s2).InSequence(s3);}
\DoxyCodeLine{00960\ \ \ \}}
\DoxyCodeLine{00961\ \ \ TypedExpectation\&\ InSequence(\textcolor{keyword}{const}\ Sequence\&\ s1,\ \textcolor{keyword}{const}\ Sequence\&\ s2,}
\DoxyCodeLine{00962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Sequence\&\ s3,\ \textcolor{keyword}{const}\ Sequence\&\ s4)\ \{}
\DoxyCodeLine{00963\ \ \ \ \ \textcolor{keywordflow}{return}\ InSequence(s1,\ s2,\ s3).InSequence(s4);}
\DoxyCodeLine{00964\ \ \ \}}
\DoxyCodeLine{00965\ \ \ TypedExpectation\&\ InSequence(\textcolor{keyword}{const}\ Sequence\&\ s1,\ \textcolor{keyword}{const}\ Sequence\&\ s2,}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Sequence\&\ s3,\ \textcolor{keyword}{const}\ Sequence\&\ s4,}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Sequence\&\ s5)\ \{}
\DoxyCodeLine{00968\ \ \ \ \ \textcolor{keywordflow}{return}\ InSequence(s1,\ s2,\ s3,\ s4).InSequence(s5);}
\DoxyCodeLine{00969\ \ \ \}}
\DoxyCodeLine{00970\ }
\DoxyCodeLine{00971\ \ \ \textcolor{comment}{//\ Implements\ that\ .After()\ clause.}}
\DoxyCodeLine{00972\ \ \ TypedExpectation\&\ After(\textcolor{keyword}{const}\ ExpectationSet\&\ s)\ \{}
\DoxyCodeLine{00973\ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <=\ kAfter,}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.After()\ cannot\ appear\ after\ .WillOnce(),"{}}}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\ .WillRepeatedly(),\ or\ "{}}}
\DoxyCodeLine{00976\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.RetiresOnSaturation()."{}});}
\DoxyCodeLine{00977\ \ \ \ \ last\_clause\_\ =\ kAfter;}
\DoxyCodeLine{00978\ }
\DoxyCodeLine{00979\ \ \ \ \ \textcolor{keywordflow}{for}\ (ExpectationSet::const\_iterator\ it\ =\ s.begin();\ it\ !=\ s.end();\ ++it)\ \{}
\DoxyCodeLine{00980\ \ \ \ \ \ \ immediate\_prerequisites\_\ +=\ *it;}
\DoxyCodeLine{00981\ \ \ \ \ \}}
\DoxyCodeLine{00982\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00983\ \ \ \}}
\DoxyCodeLine{00984\ \ \ TypedExpectation\&\ After(\textcolor{keyword}{const}\ ExpectationSet\&\ s1,\ \textcolor{keyword}{const}\ ExpectationSet\&\ s2)\ \{}
\DoxyCodeLine{00985\ \ \ \ \ \textcolor{keywordflow}{return}\ After(s1).After(s2);}
\DoxyCodeLine{00986\ \ \ \}}
\DoxyCodeLine{00987\ \ \ TypedExpectation\&\ After(\textcolor{keyword}{const}\ ExpectationSet\&\ s1,\ \textcolor{keyword}{const}\ ExpectationSet\&\ s2,}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ExpectationSet\&\ s3)\ \{}
\DoxyCodeLine{00989\ \ \ \ \ \textcolor{keywordflow}{return}\ After(s1,\ s2).After(s3);}
\DoxyCodeLine{00990\ \ \ \}}
\DoxyCodeLine{00991\ \ \ TypedExpectation\&\ After(\textcolor{keyword}{const}\ ExpectationSet\&\ s1,\ \textcolor{keyword}{const}\ ExpectationSet\&\ s2,}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ExpectationSet\&\ s3,\ \textcolor{keyword}{const}\ ExpectationSet\&\ s4)\ \{}
\DoxyCodeLine{00993\ \ \ \ \ \textcolor{keywordflow}{return}\ After(s1,\ s2,\ s3).After(s4);}
\DoxyCodeLine{00994\ \ \ \}}
\DoxyCodeLine{00995\ \ \ TypedExpectation\&\ After(\textcolor{keyword}{const}\ ExpectationSet\&\ s1,\ \textcolor{keyword}{const}\ ExpectationSet\&\ s2,}
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ExpectationSet\&\ s3,\ \textcolor{keyword}{const}\ ExpectationSet\&\ s4,}
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ExpectationSet\&\ s5)\ \{}
\DoxyCodeLine{00998\ \ \ \ \ \textcolor{keywordflow}{return}\ After(s1,\ s2,\ s3,\ s4).After(s5);}
\DoxyCodeLine{00999\ \ \ \}}
\DoxyCodeLine{01000\ }
\DoxyCodeLine{01001\ \ \ \textcolor{comment}{//\ Preferred,\ type-\/safe\ overload:\ consume\ anything\ that\ can\ be\ directly}}
\DoxyCodeLine{01002\ \ \ \textcolor{comment}{//\ converted\ to\ a\ OnceAction,\ except\ for\ Action<F>\ objects\ themselves.}}
\DoxyCodeLine{01003\ \ \ TypedExpectation\&\ WillOnce(OnceAction<F>\ once\_action)\ \{}
\DoxyCodeLine{01004\ \ \ \ \ \textcolor{comment}{//\ Call\ the\ overload\ below,\ smuggling\ the\ OnceAction\ as\ a\ copyable\ callable.}}
\DoxyCodeLine{01005\ \ \ \ \ \textcolor{comment}{//\ We\ know\ this\ is\ safe\ because\ a\ WillOnce\ action\ will\ not\ be\ called\ more}}
\DoxyCodeLine{01006\ \ \ \ \ \textcolor{comment}{//\ than\ once.}}
\DoxyCodeLine{01007\ \ \ \ \ \textcolor{keywordflow}{return}\ WillOnce(Action<F>(ActionAdaptor\{}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ std::make\_shared<OnceAction<F>>(std::move(once\_action)),}
\DoxyCodeLine{01009\ \ \ \ \ \}));}
\DoxyCodeLine{01010\ \ \ \}}
\DoxyCodeLine{01011\ }
\DoxyCodeLine{01012\ \ \ \textcolor{comment}{//\ Fallback\ overload:\ accept\ Action<F>\ objects\ and\ those\ actions\ that\ define}}
\DoxyCodeLine{01013\ \ \ \textcolor{comment}{//\ \`{}operator\ Action<F>`\ but\ not\ \`{}operator\ OnceAction<F>`.}}
\DoxyCodeLine{01014\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01015\ \ \ \textcolor{comment}{//\ This\ is\ templated\ in\ order\ to\ cause\ the\ overload\ above\ to\ be\ preferred}}
\DoxyCodeLine{01016\ \ \ \textcolor{comment}{//\ when\ the\ input\ is\ convertible\ to\ either\ type.}}
\DoxyCodeLine{01017\ \ \ \textcolor{keyword}{template}\ <\textcolor{keywordtype}{int}\&...\ ExplicitArgumentBarrier,\ \textcolor{keyword}{typename}\ =\ \textcolor{keywordtype}{void}>}
\DoxyCodeLine{01018\ \ \ TypedExpectation\&\ WillOnce(Action<F>\ action)\ \{}
\DoxyCodeLine{01019\ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <=\ kWillOnce,}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.WillOnce()\ cannot\ appear\ after\ "{}}}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.WillRepeatedly()\ or\ .RetiresOnSaturation()."{}});}
\DoxyCodeLine{01022\ \ \ \ \ last\_clause\_\ =\ kWillOnce;}
\DoxyCodeLine{01023\ }
\DoxyCodeLine{01024\ \ \ \ \ untyped\_actions\_.push\_back(\textcolor{keyword}{new}\ Action<F>(std::move(action)));}
\DoxyCodeLine{01025\ }
\DoxyCodeLine{01026\ \ \ \ \ \textcolor{keywordflow}{if}\ (!cardinality\_specified())\ \{}
\DoxyCodeLine{01027\ \ \ \ \ \ \ set\_cardinality(Exactly(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(untyped\_actions\_.size())));}
\DoxyCodeLine{01028\ \ \ \ \ \}}
\DoxyCodeLine{01029\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01030\ \ \ \}}
\DoxyCodeLine{01031\ }
\DoxyCodeLine{01032\ \ \ \textcolor{comment}{//\ Implements\ the\ .WillRepeatedly()\ clause.}}
\DoxyCodeLine{01033\ \ \ TypedExpectation\&\ WillRepeatedly(\textcolor{keyword}{const}\ Action<F>\&\ action)\ \{}
\DoxyCodeLine{01034\ \ \ \ \ \textcolor{keywordflow}{if}\ (last\_clause\_\ ==\ kWillRepeatedly)\ \{}
\DoxyCodeLine{01035\ \ \ \ \ \ \ ExpectSpecProperty(\textcolor{keyword}{false},}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.WillRepeatedly()\ cannot\ appear\ "{}}}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}more\ than\ once\ in\ an\ EXPECT\_CALL()."{}});}
\DoxyCodeLine{01038\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01039\ \ \ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <\ kWillRepeatedly,}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.WillRepeatedly()\ cannot\ appear\ "{}}}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}after\ .RetiresOnSaturation()."{}});}
\DoxyCodeLine{01042\ \ \ \ \ \}}
\DoxyCodeLine{01043\ \ \ \ \ last\_clause\_\ =\ kWillRepeatedly;}
\DoxyCodeLine{01044\ \ \ \ \ repeated\_action\_specified\_\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01045\ }
\DoxyCodeLine{01046\ \ \ \ \ repeated\_action\_\ =\ action;}
\DoxyCodeLine{01047\ \ \ \ \ \textcolor{keywordflow}{if}\ (!cardinality\_specified())\ \{}
\DoxyCodeLine{01048\ \ \ \ \ \ \ set\_cardinality(AtLeast(\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(untyped\_actions\_.size())));}
\DoxyCodeLine{01049\ \ \ \ \ \}}
\DoxyCodeLine{01050\ }
\DoxyCodeLine{01051\ \ \ \ \ \textcolor{comment}{//\ Now\ that\ no\ more\ action\ clauses\ can\ be\ specified,\ we\ check}}
\DoxyCodeLine{01052\ \ \ \ \ \textcolor{comment}{//\ whether\ their\ count\ makes\ sense.}}
\DoxyCodeLine{01053\ \ \ \ \ CheckActionCountIfNotDone();}
\DoxyCodeLine{01054\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01055\ \ \ \}}
\DoxyCodeLine{01056\ }
\DoxyCodeLine{01057\ \ \ \textcolor{comment}{//\ Implements\ the\ .RetiresOnSaturation()\ clause.}}
\DoxyCodeLine{01058\ \ \ TypedExpectation\&\ RetiresOnSaturation()\ \{}
\DoxyCodeLine{01059\ \ \ \ \ ExpectSpecProperty(last\_clause\_\ <\ kRetiresOnSaturation,}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}.RetiresOnSaturation()\ cannot\ appear\ "{}}}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}more\ than\ once."{}});}
\DoxyCodeLine{01062\ \ \ \ \ last\_clause\_\ =\ kRetiresOnSaturation;}
\DoxyCodeLine{01063\ \ \ \ \ retires\_on\_saturation\_\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01064\ }
\DoxyCodeLine{01065\ \ \ \ \ \textcolor{comment}{//\ Now\ that\ no\ more\ action\ clauses\ can\ be\ specified,\ we\ check}}
\DoxyCodeLine{01066\ \ \ \ \ \textcolor{comment}{//\ whether\ their\ count\ makes\ sense.}}
\DoxyCodeLine{01067\ \ \ \ \ CheckActionCountIfNotDone();}
\DoxyCodeLine{01068\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01069\ \ \ \}}
\DoxyCodeLine{01070\ }
\DoxyCodeLine{01071\ \ \ \textcolor{comment}{//\ Returns\ the\ matchers\ for\ the\ arguments\ as\ specified\ inside\ the}}
\DoxyCodeLine{01072\ \ \ \textcolor{comment}{//\ EXPECT\_CALL()\ macro.}}
\DoxyCodeLine{01073\ \ \ \textcolor{keyword}{const}\ ArgumentMatcherTuple\&\ matchers()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ matchers\_;\ \}}
\DoxyCodeLine{01074\ }
\DoxyCodeLine{01075\ \ \ \textcolor{comment}{//\ Returns\ the\ matcher\ specified\ by\ the\ .With()\ clause.}}
\DoxyCodeLine{01076\ \ \ \textcolor{keyword}{const}\ Matcher<const\ ArgumentTuple\&>\&\ extra\_matcher()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01077\ \ \ \ \ \textcolor{keywordflow}{return}\ extra\_matcher\_;}
\DoxyCodeLine{01078\ \ \ \}}
\DoxyCodeLine{01079\ }
\DoxyCodeLine{01080\ \ \ \textcolor{comment}{//\ Returns\ the\ action\ specified\ by\ the\ .WillRepeatedly()\ clause.}}
\DoxyCodeLine{01081\ \ \ \textcolor{keyword}{const}\ Action<F>\&\ repeated\_action()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ repeated\_action\_;\ \}}
\DoxyCodeLine{01082\ }
\DoxyCodeLine{01083\ \ \ \textcolor{comment}{//\ If\ this\ mock\ method\ has\ an\ extra\ matcher\ (i.e.\ .With(matcher)),}}
\DoxyCodeLine{01084\ \ \ \textcolor{comment}{//\ describes\ it\ to\ the\ ostream.}}
\DoxyCodeLine{01085\ \ \ \textcolor{keywordtype}{void}\ MaybeDescribeExtraMatcherTo(::std::ostream*\ os)\textcolor{keyword}{\ override\ }\{}
\DoxyCodeLine{01086\ \ \ \ \ \textcolor{keywordflow}{if}\ (extra\_matcher\_specified\_)\ \{}
\DoxyCodeLine{01087\ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ Expected\ args:\ "{}};}
\DoxyCodeLine{01088\ \ \ \ \ \ \ extra\_matcher\_.DescribeTo(os);}
\DoxyCodeLine{01089\ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01090\ \ \ \ \ \}}
\DoxyCodeLine{01091\ \ \ \}}
\DoxyCodeLine{01092\ }
\DoxyCodeLine{01093\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01094\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Function>}
\DoxyCodeLine{01095\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }FunctionMocker;}
\DoxyCodeLine{01096\ }
\DoxyCodeLine{01097\ \ \ \textcolor{comment}{//\ An\ adaptor\ that\ turns\ a\ OneAction<F>\ into\ something\ compatible\ with}}
\DoxyCodeLine{01098\ \ \ \textcolor{comment}{//\ Action<F>.\ Must\ be\ called\ at\ most\ once.}}
\DoxyCodeLine{01099\ \ \ \textcolor{keyword}{struct\ }ActionAdaptor\ \{}
\DoxyCodeLine{01100\ \ \ \ \ std::shared\_ptr<OnceAction<R(Args...)>>\ once\_action;}
\DoxyCodeLine{01101\ }
\DoxyCodeLine{01102\ \ \ \ \ R\ operator()(Args\&\&...\ args)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ std::move(*once\_action).Call(std::forward<Args>(args)...);}
\DoxyCodeLine{01104\ \ \ \ \ \}}
\DoxyCodeLine{01105\ \ \ \};}
\DoxyCodeLine{01106\ }
\DoxyCodeLine{01107\ \ \ \textcolor{comment}{//\ Returns\ an\ Expectation\ object\ that\ references\ and\ co-\/owns\ this}}
\DoxyCodeLine{01108\ \ \ \textcolor{comment}{//\ expectation.}}
\DoxyCodeLine{01109\ \ \ Expectation\ GetHandle()\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ owner\_-\/>GetHandleOf(\textcolor{keyword}{this});\ \}}
\DoxyCodeLine{01110\ }
\DoxyCodeLine{01111\ \ \ \textcolor{comment}{//\ The\ following\ methods\ will\ be\ called\ only\ after\ the\ EXPECT\_CALL()}}
\DoxyCodeLine{01112\ \ \ \textcolor{comment}{//\ statement\ finishes\ and\ when\ the\ current\ thread\ holds}}
\DoxyCodeLine{01113\ \ \ \textcolor{comment}{//\ g\_gmock\_mutex.}}
\DoxyCodeLine{01114\ }
\DoxyCodeLine{01115\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ this\ expectation\ matches\ the\ given\ arguments.}}
\DoxyCodeLine{01116\ \ \ \textcolor{keywordtype}{bool}\ Matches(\textcolor{keyword}{const}\ ArgumentTuple\&\ args)\ \textcolor{keyword}{const}}
\DoxyCodeLine{01117\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01118\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01119\ \ \ \ \ \textcolor{keywordflow}{return}\ TupleMatches(matchers\_,\ args)\ \&\&\ extra\_matcher\_.Matches(args);}
\DoxyCodeLine{01120\ \ \ \}}
\DoxyCodeLine{01121\ }
\DoxyCodeLine{01122\ \ \ \textcolor{comment}{//\ Returns\ true\ if\ and\ only\ if\ this\ expectation\ should\ handle\ the\ given}}
\DoxyCodeLine{01123\ \ \ \textcolor{comment}{//\ arguments.}}
\DoxyCodeLine{01124\ \ \ \textcolor{keywordtype}{bool}\ ShouldHandleArguments(\textcolor{keyword}{const}\ ArgumentTuple\&\ args)\ \textcolor{keyword}{const}}
\DoxyCodeLine{01125\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01126\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01127\ }
\DoxyCodeLine{01128\ \ \ \ \ \textcolor{comment}{//\ In\ case\ the\ action\ count\ wasn't\ checked\ when\ the\ expectation}}
\DoxyCodeLine{01129\ \ \ \ \ \textcolor{comment}{//\ was\ defined\ (e.g.\ if\ this\ expectation\ has\ no\ WillRepeatedly()}}
\DoxyCodeLine{01130\ \ \ \ \ \textcolor{comment}{//\ or\ RetiresOnSaturation()\ clause),\ we\ check\ it\ when\ the}}
\DoxyCodeLine{01131\ \ \ \ \ \textcolor{comment}{//\ expectation\ is\ used\ for\ the\ first\ time.}}
\DoxyCodeLine{01132\ \ \ \ \ CheckActionCountIfNotDone();}
\DoxyCodeLine{01133\ \ \ \ \ \textcolor{keywordflow}{return}\ !is\_retired()\ \&\&\ AllPrerequisitesAreSatisfied()\ \&\&\ Matches(args);}
\DoxyCodeLine{01134\ \ \ \}}
\DoxyCodeLine{01135\ }
\DoxyCodeLine{01136\ \ \ \textcolor{comment}{//\ Describes\ the\ result\ of\ matching\ the\ arguments\ against\ this}}
\DoxyCodeLine{01137\ \ \ \textcolor{comment}{//\ expectation\ to\ the\ given\ ostream.}}
\DoxyCodeLine{01138\ \ \ \textcolor{keywordtype}{void}\ ExplainMatchResultTo(\textcolor{keyword}{const}\ ArgumentTuple\&\ args,\ ::std::ostream*\ os)\ \textcolor{keyword}{const}}
\DoxyCodeLine{01139\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01140\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01141\ }
\DoxyCodeLine{01142\ \ \ \ \ \textcolor{keywordflow}{if}\ (is\_retired())\ \{}
\DoxyCodeLine{01143\ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ \ Expected:\ the\ expectation\ is\ active\(\backslash\)n"{}}}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ \ \ \ Actual:\ it\ is\ retired\(\backslash\)n"{}};}
\DoxyCodeLine{01145\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!Matches(args))\ \{}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!TupleMatches(matchers\_,\ args))\ \{}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ ExplainMatchFailureTupleTo(matchers\_,\ args,\ os);}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01149\ \ \ \ \ \ \ StringMatchResultListener\ listener;}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!extra\_matcher\_.MatchAndExplain(args,\ \&listener))\ \{}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ Expected\ args:\ "{}};}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ extra\_matcher\_.DescribeTo(os);}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ \ \ \ \ \ \ Actual:\ don't\ match"{}};}
\DoxyCodeLine{01154\ }
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ internal::PrintIfNotEmpty(listener.str(),\ os);}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01158\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (!AllPrerequisitesAreSatisfied())\ \{}
\DoxyCodeLine{01159\ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ \ Expected:\ all\ pre-\/requisites\ are\ satisfied\(\backslash\)n"{}}}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ \ \ \ Actual:\ the\ following\ immediate\ pre-\/requisites\ "{}}}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}are\ not\ satisfied:\(\backslash\)n"{}};}
\DoxyCodeLine{01162\ \ \ \ \ \ \ ExpectationSet\ unsatisfied\_prereqs;}
\DoxyCodeLine{01163\ \ \ \ \ \ \ FindUnsatisfiedPrerequisites(\&unsatisfied\_prereqs);}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ i\ =\ 0;}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (ExpectationSet::const\_iterator\ it\ =\ unsatisfied\_prereqs.begin();}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \ \ \ it\ !=\ unsatisfied\_prereqs.end();\ ++it)\ \{}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ it-\/>expectation\_base()-\/>DescribeLocationTo(os);}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}pre-\/requisite\ \#"{}}\ <<\ i++\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01170\ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (end\ of\ pre-\/requisites)\(\backslash\)n"{}};}
\DoxyCodeLine{01171\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01172\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ line\ is\ here\ just\ for\ completeness'\ sake.\ \ It\ will\ never}}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \textcolor{comment}{//\ be\ executed\ as\ currently\ the\ ExplainMatchResultTo()\ function}}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \textcolor{comment}{//\ is\ called\ only\ when\ the\ mock\ function\ call\ does\ NOT\ match\ the}}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \textcolor{comment}{//\ expectation.}}
\DoxyCodeLine{01176\ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}The\ call\ matches\ the\ expectation.\(\backslash\)n"{}};}
\DoxyCodeLine{01177\ \ \ \ \ \}}
\DoxyCodeLine{01178\ \ \ \}}
\DoxyCodeLine{01179\ }
\DoxyCodeLine{01180\ \ \ \textcolor{comment}{//\ Returns\ the\ action\ that\ should\ be\ taken\ for\ the\ current\ invocation.}}
\DoxyCodeLine{01181\ \ \ \textcolor{keyword}{const}\ Action<F>\&\ GetCurrentAction(\textcolor{keyword}{const}\ FunctionMocker<F>*\ mocker,}
\DoxyCodeLine{01182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ArgumentTuple\&\ args)\ \textcolor{keyword}{const}}
\DoxyCodeLine{01183\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01184\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01185\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ count\ =\ call\_count();}
\DoxyCodeLine{01186\ \ \ \ \ Assert(count\ >=\ 1,\ \_\_FILE\_\_,\ \_\_LINE\_\_,}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}call\_count()\ is\ <=\ 0\ when\ GetCurrentAction()\ is\ "{}}}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}called\ -\/\ this\ should\ never\ happen."{}});}
\DoxyCodeLine{01189\ }
\DoxyCodeLine{01190\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{int}\ action\_count\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{int}\textcolor{keyword}{>}(untyped\_actions\_.size());}
\DoxyCodeLine{01191\ \ \ \ \ \textcolor{keywordflow}{if}\ (action\_count\ >\ 0\ \&\&\ !repeated\_action\_specified\_\ \&\&}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ count\ >\ action\_count)\ \{}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \textcolor{comment}{//\ If\ there\ is\ at\ least\ one\ WillOnce()\ and\ no\ WillRepeatedly(),}}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \textcolor{comment}{//\ we\ warn\ the\ user\ when\ the\ WillOnce()\ clauses\ ran\ out.}}
\DoxyCodeLine{01195\ \ \ \ \ \ \ ::std::stringstream\ ss;}
\DoxyCodeLine{01196\ \ \ \ \ \ \ DescribeLocationTo(\&ss);}
\DoxyCodeLine{01197\ \ \ \ \ \ \ ss\ <<\ \textcolor{stringliteral}{"{}Actions\ ran\ out\ in\ "{}}\ <<\ source\_text()\ <<\ \textcolor{stringliteral}{"{}...\(\backslash\)n"{}}}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}Called\ "{}}\ <<\ count\ <<\ \textcolor{stringliteral}{"{}\ times,\ but\ only\ "{}}\ <<\ action\_count}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ WillOnce()"{}}\ <<\ (action\_count\ ==\ 1\ ?\ \textcolor{stringliteral}{"{}\ is"{}}\ :\ \textcolor{stringliteral}{"{}s\ are"{}})}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}\ specified\ -\/\ "{}};}
\DoxyCodeLine{01201\ \ \ \ \ \ \ mocker-\/>DescribeDefaultActionTo(args,\ \&ss);}
\DoxyCodeLine{01202\ \ \ \ \ \ \ Log(kWarning,\ ss.str(),\ 1);}
\DoxyCodeLine{01203\ \ \ \ \ \}}
\DoxyCodeLine{01204\ }
\DoxyCodeLine{01205\ \ \ \ \ \textcolor{keywordflow}{return}\ count\ <=\ action\_count}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ?\ *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }Action<F>*\textcolor{keyword}{>}(}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ untyped\_actions\_[\textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{size\_t}\textcolor{keyword}{>}(count\ -\/\ 1)])}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ repeated\_action();}
\DoxyCodeLine{01209\ \ \ \}}
\DoxyCodeLine{01210\ }
\DoxyCodeLine{01211\ \ \ \textcolor{comment}{//\ Given\ the\ arguments\ of\ a\ mock\ function\ call,\ if\ the\ call\ will}}
\DoxyCodeLine{01212\ \ \ \textcolor{comment}{//\ over-\/saturate\ this\ expectation,\ returns\ the\ default\ action;}}
\DoxyCodeLine{01213\ \ \ \textcolor{comment}{//\ otherwise,\ returns\ the\ next\ action\ in\ this\ expectation.\ \ Also}}
\DoxyCodeLine{01214\ \ \ \textcolor{comment}{//\ describes\ *what*\ happened\ to\ 'what',\ and\ explains\ *why*\ Google}}
\DoxyCodeLine{01215\ \ \ \textcolor{comment}{//\ Mock\ does\ it\ to\ 'why'.\ \ This\ method\ is\ not\ const\ as\ it\ calls}}
\DoxyCodeLine{01216\ \ \ \textcolor{comment}{//\ IncrementCallCount().\ \ A\ return\ value\ of\ NULL\ means\ the\ default}}
\DoxyCodeLine{01217\ \ \ \textcolor{comment}{//\ action.}}
\DoxyCodeLine{01218\ \ \ \textcolor{keyword}{const}\ Action<F>*\ GetActionForArguments(\textcolor{keyword}{const}\ FunctionMocker<F>*\ mocker,}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ArgumentTuple\&\ args,}
\DoxyCodeLine{01220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ what,}
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ why)}
\DoxyCodeLine{01222\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01223\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01224\ \ \ \ \ const\ ::std::string\&\ expectation\_description\ =\ GetDescription();}
\DoxyCodeLine{01225\ \ \ \ \ \textcolor{keywordflow}{if}\ (IsSaturated())\ \{}
\DoxyCodeLine{01226\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ have\ an\ excessive\ call.}}
\DoxyCodeLine{01227\ \ \ \ \ \ \ IncrementCallCount();}
\DoxyCodeLine{01228\ \ \ \ \ \ \ *what\ <<\ \textcolor{stringliteral}{"{}Mock\ function\ "{}};}
\DoxyCodeLine{01229\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (!expectation\_description.empty())\ \{}
\DoxyCodeLine{01230\ \ \ \ \ \ \ \ \ *what\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ expectation\_description\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ "{}};}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01232\ \ \ \ \ \ \ *what\ <<\ \textcolor{stringliteral}{"{}called\ more\ times\ than\ expected\ -\/\ "{}};}
\DoxyCodeLine{01233\ \ \ \ \ \ \ mocker-\/>DescribeDefaultActionTo(args,\ what);}
\DoxyCodeLine{01234\ \ \ \ \ \ \ DescribeCallCountTo(why);}
\DoxyCodeLine{01235\ }
\DoxyCodeLine{01236\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01237\ \ \ \ \ \}}
\DoxyCodeLine{01238\ }
\DoxyCodeLine{01239\ \ \ \ \ IncrementCallCount();}
\DoxyCodeLine{01240\ \ \ \ \ RetireAllPreRequisites();}
\DoxyCodeLine{01241\ }
\DoxyCodeLine{01242\ \ \ \ \ \textcolor{keywordflow}{if}\ (retires\_on\_saturation\_\ \&\&\ IsSaturated())\ \{}
\DoxyCodeLine{01243\ \ \ \ \ \ \ Retire();}
\DoxyCodeLine{01244\ \ \ \ \ \}}
\DoxyCodeLine{01245\ }
\DoxyCodeLine{01246\ \ \ \ \ \textcolor{comment}{//\ Must\ be\ done\ after\ IncrementCount()!}}
\DoxyCodeLine{01247\ \ \ \ \ *what\ <<\ \textcolor{stringliteral}{"{}Mock\ function\ "{}};}
\DoxyCodeLine{01248\ \ \ \ \ \textcolor{keywordflow}{if}\ (!expectation\_description.empty())\ \{}
\DoxyCodeLine{01249\ \ \ \ \ \ \ *what\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}}\ <<\ expectation\_description\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)"{}\ "{}};}
\DoxyCodeLine{01250\ \ \ \ \ \}}
\DoxyCodeLine{01251\ \ \ \ \ *what\ <<\ \textcolor{stringliteral}{"{}call\ matches\ "{}}\ <<\ source\_text()\ <<\ \textcolor{stringliteral}{"{}...\(\backslash\)n"{}};}
\DoxyCodeLine{01252\ \ \ \ \ \textcolor{keywordflow}{return}\ \&(GetCurrentAction(mocker,\ args));}
\DoxyCodeLine{01253\ \ \ \}}
\DoxyCodeLine{01254\ }
\DoxyCodeLine{01255\ \ \ \textcolor{comment}{//\ All\ the\ fields\ below\ won't\ change\ once\ the\ EXPECT\_CALL()}}
\DoxyCodeLine{01256\ \ \ \textcolor{comment}{//\ statement\ finishes.}}
\DoxyCodeLine{01257\ \ \ FunctionMocker<F>*\ \textcolor{keyword}{const}\ owner\_;}
\DoxyCodeLine{01258\ \ \ ArgumentMatcherTuple\ matchers\_;}
\DoxyCodeLine{01259\ \ \ Matcher<const\ ArgumentTuple\&>\ extra\_matcher\_;}
\DoxyCodeLine{01260\ \ \ Action<F>\ repeated\_action\_;}
\DoxyCodeLine{01261\ }
\DoxyCodeLine{01262\ \ \ TypedExpectation(\textcolor{keyword}{const}\ TypedExpectation\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01263\ \ \ TypedExpectation\&\ operator=(\textcolor{keyword}{const}\ TypedExpectation\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01264\ \};\ \ \textcolor{comment}{//\ class\ TypedExpectation}}
\DoxyCodeLine{01265\ }
\DoxyCodeLine{01266\ \textcolor{comment}{//\ A\ MockSpec\ object\ is\ used\ by\ ON\_CALL()\ or\ EXPECT\_CALL()\ for}}
\DoxyCodeLine{01267\ \textcolor{comment}{//\ specifying\ the\ default\ behavior\ of,\ or\ expectation\ on,\ a\ mock}}
\DoxyCodeLine{01268\ \textcolor{comment}{//\ function.}}
\DoxyCodeLine{01269\ }
\DoxyCodeLine{01270\ \textcolor{comment}{//\ Note:\ class\ MockSpec\ really\ belongs\ to\ the\ ::testing\ namespace.}}
\DoxyCodeLine{01271\ \textcolor{comment}{//\ However\ if\ we\ define\ it\ in\ ::testing,\ MSVC\ will\ complain\ when}}
\DoxyCodeLine{01272\ \textcolor{comment}{//\ classes\ in\ ::testing::internal\ declare\ it\ as\ a\ friend\ class}}
\DoxyCodeLine{01273\ \textcolor{comment}{//\ template.\ \ To\ workaround\ this\ compiler\ bug,\ we\ define\ MockSpec\ in}}
\DoxyCodeLine{01274\ \textcolor{comment}{//\ ::testing::internal\ and\ import\ it\ into\ ::testing.}}
\DoxyCodeLine{01275\ }
\DoxyCodeLine{01276\ \textcolor{comment}{//\ Logs\ a\ message\ including\ file\ and\ line\ number\ information.}}
\DoxyCodeLine{01277\ GTEST\_API\_\ \textcolor{keywordtype}{void}\ LogWithLocation(testing::internal::LogSeverity\ severity,}
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \textcolor{keywordtype}{int}\ line,}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ message);}
\DoxyCodeLine{01280\ }
\DoxyCodeLine{01281\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{01282\ \textcolor{keyword}{class\ }MockSpec\ \{}
\DoxyCodeLine{01283\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01284\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ internal::Function<F>::ArgumentTuple\ ArgumentTuple;}
\DoxyCodeLine{01285\ \ \ \textcolor{keyword}{typedef}}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \textcolor{keyword}{typename}\ internal::Function<F>::ArgumentMatcherTuple\ ArgumentMatcherTuple;}
\DoxyCodeLine{01287\ }
\DoxyCodeLine{01288\ \ \ \textcolor{comment}{//\ Constructs\ a\ MockSpec\ object,\ given\ the\ function\ mocker\ object}}
\DoxyCodeLine{01289\ \ \ \textcolor{comment}{//\ that\ the\ spec\ is\ associated\ with.}}
\DoxyCodeLine{01290\ \ \ MockSpec(internal::FunctionMocker<F>*\ function\_mocker,}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ArgumentMatcherTuple\&\ matchers)}
\DoxyCodeLine{01292\ \ \ \ \ \ \ :\ function\_mocker\_(function\_mocker),\ matchers\_(matchers)\ \{\}}
\DoxyCodeLine{01293\ }
\DoxyCodeLine{01294\ \ \ \textcolor{comment}{//\ Adds\ a\ new\ default\ action\ spec\ to\ the\ function\ mocker\ and\ returns}}
\DoxyCodeLine{01295\ \ \ \textcolor{comment}{//\ the\ newly\ created\ spec.}}
\DoxyCodeLine{01296\ \ \ internal::OnCallSpec<F>\&\ InternalDefaultActionSetAt(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,}
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ line,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ obj,}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ call)\ \{}
\DoxyCodeLine{01299\ \ \ \ \ LogWithLocation(internal::kInfo,\ file,\ line,}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::string(\textcolor{stringliteral}{"{}ON\_CALL("{}})\ +\ obj\ +\ \textcolor{stringliteral}{"{},\ "{}}\ +\ call\ +\ \textcolor{stringliteral}{"{})\ invoked"{}});}
\DoxyCodeLine{01301\ \ \ \ \ \textcolor{keywordflow}{return}\ function\_mocker\_-\/>AddNewOnCallSpec(file,\ line,\ matchers\_);}
\DoxyCodeLine{01302\ \ \ \}}
\DoxyCodeLine{01303\ }
\DoxyCodeLine{01304\ \ \ \textcolor{comment}{//\ Adds\ a\ new\ expectation\ spec\ to\ the\ function\ mocker\ and\ returns}}
\DoxyCodeLine{01305\ \ \ \textcolor{comment}{//\ the\ newly\ created\ spec.}}
\DoxyCodeLine{01306\ \ \ internal::TypedExpectation<F>\&\ InternalExpectedAt(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \textcolor{keywordtype}{int}\ line,}
\DoxyCodeLine{01307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ obj,}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ call)\ \{}
\DoxyCodeLine{01309\ \ \ \ \ \textcolor{keyword}{const}\ std::string\ source\_text(std::string(\textcolor{stringliteral}{"{}EXPECT\_CALL("{}})\ +\ obj\ +\ \textcolor{stringliteral}{"{},\ "{}}\ +}
\DoxyCodeLine{01310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ call\ +\ \textcolor{stringliteral}{"{})"{}});}
\DoxyCodeLine{01311\ \ \ \ \ LogWithLocation(internal::kInfo,\ file,\ line,\ source\_text\ +\ \textcolor{stringliteral}{"{}\ invoked"{}});}
\DoxyCodeLine{01312\ \ \ \ \ \textcolor{keywordflow}{return}\ function\_mocker\_-\/>AddNewExpectation(file,\ line,\ source\_text,}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ matchers\_);}
\DoxyCodeLine{01314\ \ \ \}}
\DoxyCodeLine{01315\ }
\DoxyCodeLine{01316\ \ \ \textcolor{comment}{//\ This\ operator\ overload\ is\ used\ to\ swallow\ the\ superfluous\ parameter\ list}}
\DoxyCodeLine{01317\ \ \ \textcolor{comment}{//\ introduced\ by\ the\ ON/EXPECT\_CALL\ macros.\ See\ the\ macro\ comments\ for\ more}}
\DoxyCodeLine{01318\ \ \ \textcolor{comment}{//\ explanation.}}
\DoxyCodeLine{01319\ \ \ MockSpec<F>\&\ operator()(\textcolor{keyword}{const}\ internal::WithoutMatchers\&,\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{const})\ \{}
\DoxyCodeLine{01320\ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{01321\ \ \ \}}
\DoxyCodeLine{01322\ }
\DoxyCodeLine{01323\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01324\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Function>}
\DoxyCodeLine{01325\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }internal::FunctionMocker;}
\DoxyCodeLine{01326\ }
\DoxyCodeLine{01327\ \ \ \textcolor{comment}{//\ The\ function\ mocker\ that\ owns\ this\ spec.}}
\DoxyCodeLine{01328\ \ \ internal::FunctionMocker<F>*\ \textcolor{keyword}{const}\ function\_mocker\_;}
\DoxyCodeLine{01329\ \ \ \textcolor{comment}{//\ The\ argument\ matchers\ specified\ in\ the\ spec.}}
\DoxyCodeLine{01330\ \ \ ArgumentMatcherTuple\ matchers\_;}
\DoxyCodeLine{01331\ \};\ \ \textcolor{comment}{//\ class\ MockSpec}}
\DoxyCodeLine{01332\ }
\DoxyCodeLine{01333\ \textcolor{comment}{//\ Wrapper\ type\ for\ generically\ holding\ an\ ordinary\ value\ or\ lvalue\ reference.}}
\DoxyCodeLine{01334\ \textcolor{comment}{//\ If\ T\ is\ not\ a\ reference\ type,\ it\ must\ be\ copyable\ or\ movable.}}
\DoxyCodeLine{01335\ \textcolor{comment}{//\ ReferenceOrValueWrapper<T>\ is\ movable,\ and\ will\ also\ be\ copyable\ unless}}
\DoxyCodeLine{01336\ \textcolor{comment}{//\ T\ is\ a\ move-\/only\ value\ type\ (which\ means\ that\ it\ will\ always\ be\ copyable}}
\DoxyCodeLine{01337\ \textcolor{comment}{//\ if\ the\ current\ platform\ does\ not\ support\ move\ semantics).}}
\DoxyCodeLine{01338\ \textcolor{comment}{//}}
\DoxyCodeLine{01339\ \textcolor{comment}{//\ The\ primary\ template\ defines\ handling\ for\ values,\ but\ function\ header}}
\DoxyCodeLine{01340\ \textcolor{comment}{//\ comments\ describe\ the\ contract\ for\ the\ whole\ template\ (including}}
\DoxyCodeLine{01341\ \textcolor{comment}{//\ specializations).}}
\DoxyCodeLine{01342\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01343\ \textcolor{keyword}{class\ }ReferenceOrValueWrapper\ \{}
\DoxyCodeLine{01344\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01345\ \ \ \textcolor{comment}{//\ Constructs\ a\ wrapper\ from\ the\ given\ value/reference.}}
\DoxyCodeLine{01346\ \ \ \textcolor{keyword}{explicit}\ ReferenceOrValueWrapper(T\ value)\ :\ value\_(std::move(value))\ \{\}}
\DoxyCodeLine{01347\ }
\DoxyCodeLine{01348\ \ \ \textcolor{comment}{//\ Unwraps\ and\ returns\ the\ underlying\ value/reference,\ exactly\ as}}
\DoxyCodeLine{01349\ \ \ \textcolor{comment}{//\ originally\ passed.\ The\ behavior\ of\ calling\ this\ more\ than\ once\ on}}
\DoxyCodeLine{01350\ \ \ \textcolor{comment}{//\ the\ same\ object\ is\ unspecified.}}
\DoxyCodeLine{01351\ \ \ T\ Unwrap()\ \{\ \textcolor{keywordflow}{return}\ std::move(value\_);\ \}}
\DoxyCodeLine{01352\ }
\DoxyCodeLine{01353\ \ \ \textcolor{comment}{//\ Provides\ nondestructive\ access\ to\ the\ underlying\ value/reference.}}
\DoxyCodeLine{01354\ \ \ \textcolor{comment}{//\ Always\ returns\ a\ const\ reference\ (more\ precisely,}}
\DoxyCodeLine{01355\ \ \ \textcolor{comment}{//\ const\ std::add\_lvalue\_reference<T>::type).\ The\ behavior\ of\ calling\ this}}
\DoxyCodeLine{01356\ \ \ \textcolor{comment}{//\ after\ calling\ Unwrap\ on\ the\ same\ object\ is\ unspecified.}}
\DoxyCodeLine{01357\ \ \ \textcolor{keyword}{const}\ T\&\ Peek()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ value\_;\ \}}
\DoxyCodeLine{01358\ }
\DoxyCodeLine{01359\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01360\ \ \ T\ value\_;}
\DoxyCodeLine{01361\ \};}
\DoxyCodeLine{01362\ }
\DoxyCodeLine{01363\ \textcolor{comment}{//\ Specialization\ for\ lvalue\ reference\ types.\ See\ primary\ template}}
\DoxyCodeLine{01364\ \textcolor{comment}{//\ for\ documentation.}}
\DoxyCodeLine{01365\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01366\ \textcolor{keyword}{class\ }ReferenceOrValueWrapper<T\&>\ \{}
\DoxyCodeLine{01367\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01368\ \ \ \textcolor{comment}{//\ Workaround\ for\ debatable\ pass-\/by-\/reference\ lint\ warning\ (c-\/library-\/team}}
\DoxyCodeLine{01369\ \ \ \textcolor{comment}{//\ policy\ precludes\ NOLINT\ in\ this\ context)}}
\DoxyCodeLine{01370\ \ \ \textcolor{keyword}{typedef}\ T\&\ reference;}
\DoxyCodeLine{01371\ \ \ \textcolor{keyword}{explicit}\ ReferenceOrValueWrapper(reference\ ref)\ :\ value\_ptr\_(\&ref)\ \{\}}
\DoxyCodeLine{01372\ \ \ T\&\ Unwrap()\ \{\ \textcolor{keywordflow}{return}\ *value\_ptr\_;\ \}}
\DoxyCodeLine{01373\ \ \ \textcolor{keyword}{const}\ T\&\ Peek()\textcolor{keyword}{\ const\ }\{\ \textcolor{keywordflow}{return}\ *value\_ptr\_;\ \}}
\DoxyCodeLine{01374\ }
\DoxyCodeLine{01375\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01376\ \ \ T*\ value\_ptr\_;}
\DoxyCodeLine{01377\ \};}
\DoxyCodeLine{01378\ }
\DoxyCodeLine{01379\ \textcolor{comment}{//\ Prints\ the\ held\ value\ as\ an\ action's\ result\ to\ os.}}
\DoxyCodeLine{01380\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01381\ \textcolor{keywordtype}{void}\ PrintAsActionResult(\textcolor{keyword}{const}\ T\&\ result,\ std::ostream\&\ os)\ \{}
\DoxyCodeLine{01382\ \ \ os\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ \ \ \ \ \ \ Returns:\ "{}};}
\DoxyCodeLine{01383\ \ \ \textcolor{comment}{//\ T\ may\ be\ a\ reference\ type,\ so\ we\ don't\ use\ UniversalPrint().}}
\DoxyCodeLine{01384\ \ \ UniversalPrinter<T>::Print(result,\ \&os);}
\DoxyCodeLine{01385\ \}}
\DoxyCodeLine{01386\ }
\DoxyCodeLine{01387\ \textcolor{comment}{//\ Reports\ an\ uninteresting\ call\ (whose\ description\ is\ in\ msg)\ in\ the}}
\DoxyCodeLine{01388\ \textcolor{comment}{//\ manner\ specified\ by\ 'reaction'.}}
\DoxyCodeLine{01389\ GTEST\_API\_\ \textcolor{keywordtype}{void}\ ReportUninterestingCall(CallReaction\ reaction,}
\DoxyCodeLine{01390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ msg);}
\DoxyCodeLine{01391\ }
\DoxyCodeLine{01392\ \textcolor{comment}{//\ A\ generic\ RAII\ type\ that\ runs\ a\ user-\/provided\ function\ in\ its\ destructor.}}
\DoxyCodeLine{01393\ \textcolor{keyword}{class\ }Cleanup\ final\ \{}
\DoxyCodeLine{01394\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01395\ \ \ \textcolor{keyword}{explicit}\ Cleanup(std::function<\textcolor{keywordtype}{void}()>\ f)\ :\ f\_(std::move(f))\ \{\}}
\DoxyCodeLine{01396\ \ \ \string~Cleanup()\ \{\ f\_();\ \}}
\DoxyCodeLine{01397\ }
\DoxyCodeLine{01398\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01399\ \ \ std::function<void()>\ f\_;}
\DoxyCodeLine{01400\ \};}
\DoxyCodeLine{01401\ }
\DoxyCodeLine{01402\ \textcolor{keyword}{struct\ }UntypedFunctionMockerBase::UninterestingCallCleanupHandler\ \{}
\DoxyCodeLine{01403\ \ \ CallReaction\ reaction;}
\DoxyCodeLine{01404\ \ \ std::stringstream\&\ ss;}
\DoxyCodeLine{01405\ }
\DoxyCodeLine{01406\ \ \ \string~UninterestingCallCleanupHandler()\ \{}
\DoxyCodeLine{01407\ \ \ \ \ ReportUninterestingCall(reaction,\ ss.str());}
\DoxyCodeLine{01408\ \ \ \}}
\DoxyCodeLine{01409\ \};}
\DoxyCodeLine{01410\ }
\DoxyCodeLine{01411\ \textcolor{keyword}{struct\ }UntypedFunctionMockerBase::FailureCleanupHandler\ \{}
\DoxyCodeLine{01412\ \ \ std::stringstream\&\ ss;}
\DoxyCodeLine{01413\ \ \ std::stringstream\&\ why;}
\DoxyCodeLine{01414\ \ \ std::stringstream\&\ loc;}
\DoxyCodeLine{01415\ \ \ \textcolor{keyword}{const}\ ExpectationBase*\ untyped\_expectation;}
\DoxyCodeLine{01416\ \ \ \textcolor{keywordtype}{bool}\ found;}
\DoxyCodeLine{01417\ \ \ \textcolor{keywordtype}{bool}\ is\_excessive;}
\DoxyCodeLine{01418\ }
\DoxyCodeLine{01419\ \ \ \string~FailureCleanupHandler()\ \{}
\DoxyCodeLine{01420\ \ \ \ \ ss\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}}\ <<\ why.str();}
\DoxyCodeLine{01421\ }
\DoxyCodeLine{01422\ \ \ \ \ \textcolor{keywordflow}{if}\ (!found)\ \{}
\DoxyCodeLine{01423\ \ \ \ \ \ \ \textcolor{comment}{//\ No\ expectation\ matches\ this\ call\ -\/\ reports\ a\ failure.}}
\DoxyCodeLine{01424\ \ \ \ \ \ \ Expect(\textcolor{keyword}{false},\ \textcolor{keyword}{nullptr},\ -\/1,\ ss.str());}
\DoxyCodeLine{01425\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (is\_excessive)\ \{}
\DoxyCodeLine{01426\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ had\ an\ upper-\/bound\ violation\ and\ the\ failure\ message\ is\ in\ ss.}}
\DoxyCodeLine{01427\ \ \ \ \ \ \ Expect(\textcolor{keyword}{false},\ untyped\_expectation-\/>file(),\ untyped\_expectation-\/>line(),}
\DoxyCodeLine{01428\ \ \ \ \ \ \ \ \ \ \ \ \ \ ss.str());}
\DoxyCodeLine{01429\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \textcolor{comment}{//\ We\ had\ an\ expected\ call\ and\ the\ matching\ expectation\ is}}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \textcolor{comment}{//\ described\ in\ ss.}}
\DoxyCodeLine{01432\ \ \ \ \ \ \ Log(kInfo,\ loc.str()\ +\ ss.str(),\ 2);}
\DoxyCodeLine{01433\ \ \ \ \ \}}
\DoxyCodeLine{01434\ \ \ \}}
\DoxyCodeLine{01435\ \};}
\DoxyCodeLine{01436\ }
\DoxyCodeLine{01437\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{01438\ \textcolor{keyword}{class\ }FunctionMocker;}
\DoxyCodeLine{01439\ }
\DoxyCodeLine{01440\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ R,\ \textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{01441\ \textcolor{keyword}{class\ }FunctionMocker<R(Args...)>\ final\ :\ \textcolor{keyword}{public}\ UntypedFunctionMockerBase\ \{}
\DoxyCodeLine{01442\ \ \ \textcolor{keyword}{using\ }F\ =\ R(Args...);}
\DoxyCodeLine{01443\ }
\DoxyCodeLine{01444\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01445\ \ \ \textcolor{keyword}{using\ }Result\ =\ R;}
\DoxyCodeLine{01446\ \ \ \textcolor{keyword}{using\ }ArgumentTuple\ =\ std::tuple<Args...>;}
\DoxyCodeLine{01447\ \ \ \textcolor{keyword}{using\ }ArgumentMatcherTuple\ =\ std::tuple<Matcher<Args>...>;}
\DoxyCodeLine{01448\ }
\DoxyCodeLine{01449\ \ \ FunctionMocker()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{01450\ }
\DoxyCodeLine{01451\ \ \ \textcolor{comment}{//\ There\ is\ no\ generally\ useful\ and\ implementable\ semantics\ of}}
\DoxyCodeLine{01452\ \ \ \textcolor{comment}{//\ copying\ a\ mock\ object,\ so\ copying\ a\ mock\ is\ usually\ a\ user\ error.}}
\DoxyCodeLine{01453\ \ \ \textcolor{comment}{//\ Thus\ we\ disallow\ copying\ function\ mockers.\ \ If\ the\ user\ really}}
\DoxyCodeLine{01454\ \ \ \textcolor{comment}{//\ wants\ to\ copy\ a\ mock\ object,\ they\ should\ implement\ their\ own\ copy}}
\DoxyCodeLine{01455\ \ \ \textcolor{comment}{//\ operation,\ for\ example:}}
\DoxyCodeLine{01456\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01457\ \ \ \textcolor{comment}{//\ \ \ class\ MockFoo\ :\ public\ Foo\ \{}}
\DoxyCodeLine{01458\ \ \ \textcolor{comment}{//\ \ \ \ public:}}
\DoxyCodeLine{01459\ \ \ \textcolor{comment}{//\ \ \ \ \ //\ Defines\ a\ copy\ constructor\ explicitly.}}
\DoxyCodeLine{01460\ \ \ \textcolor{comment}{//\ \ \ \ \ MockFoo(const\ MockFoo\&\ src)\ \{\}}}
\DoxyCodeLine{01461\ \ \ \textcolor{comment}{//\ \ \ \ \ ...}}
\DoxyCodeLine{01462\ \ \ \textcolor{comment}{//\ \ \ \};}}
\DoxyCodeLine{01463\ \ \ FunctionMocker(\textcolor{keyword}{const}\ FunctionMocker\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01464\ \ \ FunctionMocker\&\ operator=(\textcolor{keyword}{const}\ FunctionMocker\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01465\ }
\DoxyCodeLine{01466\ \ \ \textcolor{comment}{//\ The\ destructor\ verifies\ that\ all\ expectations\ on\ this\ mock}}
\DoxyCodeLine{01467\ \ \ \textcolor{comment}{//\ function\ have\ been\ satisfied.\ \ If\ not,\ it\ will\ report\ Google\ Test}}
\DoxyCodeLine{01468\ \ \ \textcolor{comment}{//\ non-\/fatal\ failures\ for\ the\ violations.}}
\DoxyCodeLine{01469\ \ \ \string~FunctionMocker()\ override\ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01470\ \ \ \ \ MutexLock\ l(\&g\_gmock\_mutex);}
\DoxyCodeLine{01471\ \ \ \ \ VerifyAndClearExpectationsLocked();}
\DoxyCodeLine{01472\ \ \ \ \ Mock::UnregisterLocked(\textcolor{keyword}{this});}
\DoxyCodeLine{01473\ \ \ \ \ ClearDefaultActionsLocked();}
\DoxyCodeLine{01474\ \ \ \}}
\DoxyCodeLine{01475\ }
\DoxyCodeLine{01476\ \ \ \textcolor{comment}{//\ Returns\ the\ ON\_CALL\ spec\ that\ matches\ this\ mock\ function\ with\ the}}
\DoxyCodeLine{01477\ \ \ \textcolor{comment}{//\ given\ arguments;\ returns\ NULL\ if\ no\ matching\ ON\_CALL\ is\ found.}}
\DoxyCodeLine{01478\ \ \ \textcolor{comment}{//\ L\ =\ *}}
\DoxyCodeLine{01479\ \ \ \textcolor{keyword}{const}\ OnCallSpec<F>*\ FindOnCallSpec(\textcolor{keyword}{const}\ ArgumentTuple\&\ args)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01480\ \ \ \ \ \textcolor{keywordflow}{for}\ (UntypedOnCallSpecs::const\_reverse\_iterator\ it\ =}
\DoxyCodeLine{01481\ \ \ \ \ \ \ \ \ \ \ \ \ \ untyped\_on\_call\_specs\_.rbegin();}
\DoxyCodeLine{01482\ \ \ \ \ \ \ \ \ \ it\ !=\ untyped\_on\_call\_specs\_.rend();\ ++it)\ \{}
\DoxyCodeLine{01483\ \ \ \ \ \ \ \textcolor{keyword}{const}\ OnCallSpec<F>*\ spec\ =\ \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }OnCallSpec<F>*\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (spec-\/>Matches(args))\ \textcolor{keywordflow}{return}\ spec;}
\DoxyCodeLine{01485\ \ \ \ \ \}}
\DoxyCodeLine{01486\ }
\DoxyCodeLine{01487\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01488\ \ \ \}}
\DoxyCodeLine{01489\ }
\DoxyCodeLine{01490\ \ \ \textcolor{comment}{//\ Performs\ the\ default\ action\ of\ this\ mock\ function\ on\ the\ given}}
\DoxyCodeLine{01491\ \ \ \textcolor{comment}{//\ arguments\ and\ returns\ the\ result.\ Asserts\ (or\ throws\ if}}
\DoxyCodeLine{01492\ \ \ \textcolor{comment}{//\ exceptions\ are\ enabled)\ with\ a\ helpful\ call\ description\ if\ there}}
\DoxyCodeLine{01493\ \ \ \textcolor{comment}{//\ is\ no\ valid\ return\ value.\ This\ method\ doesn't\ depend\ on\ the}}
\DoxyCodeLine{01494\ \ \ \textcolor{comment}{//\ mutable\ state\ of\ this\ object,\ and\ thus\ can\ be\ called\ concurrently}}
\DoxyCodeLine{01495\ \ \ \textcolor{comment}{//\ without\ locking.}}
\DoxyCodeLine{01496\ \ \ \textcolor{comment}{//\ L\ =\ *}}
\DoxyCodeLine{01497\ \ \ Result\ PerformDefaultAction(ArgumentTuple\&\&\ args,}
\DoxyCodeLine{01498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ call\_description)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01499\ \ \ \ \ \textcolor{keyword}{const}\ OnCallSpec<F>*\ \textcolor{keyword}{const}\ spec\ =\ this-\/>FindOnCallSpec(args);}
\DoxyCodeLine{01500\ \ \ \ \ \textcolor{keywordflow}{if}\ (spec\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spec-\/>GetAction().Perform(std::move(args));}
\DoxyCodeLine{01502\ \ \ \ \ \}}
\DoxyCodeLine{01503\ \ \ \ \ \textcolor{keyword}{const}\ std::string\ message\ =}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ call\_description\ +}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)n\ \ \ \ The\ mock\ function\ has\ no\ default\ action\ "{}}}
\DoxyCodeLine{01506\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}set,\ and\ its\ return\ type\ has\ no\ default\ value\ set."{}};}
\DoxyCodeLine{01507\ \textcolor{preprocessor}{\#if\ GTEST\_HAS\_EXCEPTIONS}}
\DoxyCodeLine{01508\ \ \ \ \ \textcolor{keywordflow}{if}\ (!DefaultValue<Result>::Exists())\ \{}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(message);}
\DoxyCodeLine{01510\ \ \ \ \ \}}
\DoxyCodeLine{01511\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{01512\ \ \ \ \ Assert(DefaultValue<Result>::Exists(),\ \textcolor{stringliteral}{"{}"{}},\ -\/1,\ message);}
\DoxyCodeLine{01513\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{01514\ \ \ \ \ \textcolor{keywordflow}{return}\ DefaultValue<Result>::Get();}
\DoxyCodeLine{01515\ \ \ \}}
\DoxyCodeLine{01516\ }
\DoxyCodeLine{01517\ \ \ \textcolor{comment}{//\ Implements\ UntypedFunctionMockerBase::ClearDefaultActionsLocked():}}
\DoxyCodeLine{01518\ \ \ \textcolor{comment}{//\ clears\ the\ ON\_CALL()s\ set\ on\ this\ mock\ function.}}
\DoxyCodeLine{01519\ \ \ \textcolor{keywordtype}{void}\ ClearDefaultActionsLocked()\ override}
\DoxyCodeLine{01520\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01521\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01522\ }
\DoxyCodeLine{01523\ \ \ \ \ \textcolor{comment}{//\ Deleting\ our\ default\ actions\ may\ trigger\ other\ mock\ objects\ to\ be}}
\DoxyCodeLine{01524\ \ \ \ \ \textcolor{comment}{//\ deleted,\ for\ example\ if\ an\ action\ contains\ a\ reference\ counted\ smart}}
\DoxyCodeLine{01525\ \ \ \ \ \textcolor{comment}{//\ pointer\ to\ that\ mock\ object,\ and\ that\ is\ the\ last\ reference.\ So\ if\ we}}
\DoxyCodeLine{01526\ \ \ \ \ \textcolor{comment}{//\ delete\ our\ actions\ within\ the\ context\ of\ the\ global\ mutex\ we\ may\ deadlock}}
\DoxyCodeLine{01527\ \ \ \ \ \textcolor{comment}{//\ when\ this\ method\ is\ called\ again.\ Instead,\ make\ a\ copy\ of\ the\ set\ of}}
\DoxyCodeLine{01528\ \ \ \ \ \textcolor{comment}{//\ actions\ to\ delete,\ clear\ our\ set\ within\ the\ mutex,\ and\ then\ delete\ the}}
\DoxyCodeLine{01529\ \ \ \ \ \textcolor{comment}{//\ actions\ outside\ of\ the\ mutex.}}
\DoxyCodeLine{01530\ \ \ \ \ UntypedOnCallSpecs\ specs\_to\_delete;}
\DoxyCodeLine{01531\ \ \ \ \ untyped\_on\_call\_specs\_.swap(specs\_to\_delete);}
\DoxyCodeLine{01532\ }
\DoxyCodeLine{01533\ \ \ \ \ g\_gmock\_mutex.Unlock();}
\DoxyCodeLine{01534\ \ \ \ \ \textcolor{keywordflow}{for}\ (UntypedOnCallSpecs::const\_iterator\ it\ =\ specs\_to\_delete.begin();}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ \ it\ !=\ specs\_to\_delete.end();\ ++it)\ \{}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \textcolor{keyword}{delete}\ \textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }OnCallSpec<F>*\textcolor{keyword}{>}(*it);}
\DoxyCodeLine{01537\ \ \ \ \ \}}
\DoxyCodeLine{01538\ }
\DoxyCodeLine{01539\ \ \ \ \ \textcolor{comment}{//\ Lock\ the\ mutex\ again,\ since\ the\ caller\ expects\ it\ to\ be\ locked\ when\ we}}
\DoxyCodeLine{01540\ \ \ \ \ \textcolor{comment}{//\ return.}}
\DoxyCodeLine{01541\ \ \ \ \ g\_gmock\_mutex.Lock();}
\DoxyCodeLine{01542\ \ \ \}}
\DoxyCodeLine{01543\ }
\DoxyCodeLine{01544\ \ \ \textcolor{comment}{//\ Returns\ the\ result\ of\ invoking\ this\ mock\ function\ with\ the\ given}}
\DoxyCodeLine{01545\ \ \ \textcolor{comment}{//\ arguments.\ \ This\ function\ can\ be\ safely\ called\ from\ multiple}}
\DoxyCodeLine{01546\ \ \ \textcolor{comment}{//\ threads\ concurrently.}}
\DoxyCodeLine{01547\ \ \ Result\ Invoke(Args...\ args)\ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01548\ \ \ \ \ \textcolor{keywordflow}{return}\ InvokeWith(ArgumentTuple(std::forward<Args>(args)...));}
\DoxyCodeLine{01549\ \ \ \}}
\DoxyCodeLine{01550\ }
\DoxyCodeLine{01551\ \ \ MockSpec<F>\ With(Matcher<Args>...\ m)\ \{}
\DoxyCodeLine{01552\ \ \ \ \ \textcolor{keywordflow}{return}\ MockSpec<F>(\textcolor{keyword}{this},\ ::std::make\_tuple(std::move(m)...));}
\DoxyCodeLine{01553\ \ \ \}}
\DoxyCodeLine{01554\ }
\DoxyCodeLine{01555\ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01556\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Function>}
\DoxyCodeLine{01557\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }MockSpec;}
\DoxyCodeLine{01558\ }
\DoxyCodeLine{01559\ \ \ \textcolor{comment}{//\ Adds\ and\ returns\ a\ default\ action\ spec\ for\ this\ mock\ function.}}
\DoxyCodeLine{01560\ \ \ OnCallSpec<F>\&\ AddNewOnCallSpec(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \textcolor{keywordtype}{int}\ line,}
\DoxyCodeLine{01561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ArgumentMatcherTuple\&\ m)}
\DoxyCodeLine{01562\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01563\ \ \ \ \ Mock::RegisterUseByOnCallOrExpectCall(MockObject(),\ file,\ line);}
\DoxyCodeLine{01564\ \ \ \ \ OnCallSpec<F>*\ \textcolor{keyword}{const}\ on\_call\_spec\ =\ \textcolor{keyword}{new}\ OnCallSpec<F>(file,\ line,\ m);}
\DoxyCodeLine{01565\ \ \ \ \ untyped\_on\_call\_specs\_.push\_back(on\_call\_spec);}
\DoxyCodeLine{01566\ \ \ \ \ \textcolor{keywordflow}{return}\ *on\_call\_spec;}
\DoxyCodeLine{01567\ \ \ \}}
\DoxyCodeLine{01568\ }
\DoxyCodeLine{01569\ \ \ \textcolor{comment}{//\ Adds\ and\ returns\ an\ expectation\ spec\ for\ this\ mock\ function.}}
\DoxyCodeLine{01570\ \ \ TypedExpectation<F>\&\ AddNewExpectation(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ file,\ \textcolor{keywordtype}{int}\ line,}
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ source\_text,}
\DoxyCodeLine{01572\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ ArgumentMatcherTuple\&\ m)}
\DoxyCodeLine{01573\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01574\ \ \ \ \ Mock::RegisterUseByOnCallOrExpectCall(MockObject(),\ file,\ line);}
\DoxyCodeLine{01575\ \ \ \ \ TypedExpectation<F>*\ \textcolor{keyword}{const}\ expectation\ =}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ \textcolor{keyword}{new}\ TypedExpectation<F>(\textcolor{keyword}{this},\ file,\ line,\ source\_text,\ m);}
\DoxyCodeLine{01577\ \ \ \ \ \textcolor{keyword}{const}\ std::shared\_ptr<ExpectationBase>\ untyped\_expectation(expectation);}
\DoxyCodeLine{01578\ \ \ \ \ \textcolor{comment}{//\ See\ the\ definition\ of\ untyped\_expectations\_\ for\ why\ access\ to}}
\DoxyCodeLine{01579\ \ \ \ \ \textcolor{comment}{//\ it\ is\ unprotected\ here.}}
\DoxyCodeLine{01580\ \ \ \ \ untyped\_expectations\_.push\_back(untyped\_expectation);}
\DoxyCodeLine{01581\ }
\DoxyCodeLine{01582\ \ \ \ \ \textcolor{comment}{//\ Adds\ this\ expectation\ into\ the\ implicit\ sequence\ if\ there\ is\ one.}}
\DoxyCodeLine{01583\ \ \ \ \ Sequence*\ \textcolor{keyword}{const}\ implicit\_sequence\ =\ g\_gmock\_implicit\_sequence.get();}
\DoxyCodeLine{01584\ \ \ \ \ \textcolor{keywordflow}{if}\ (implicit\_sequence\ !=\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01585\ \ \ \ \ \ \ implicit\_sequence-\/>AddExpectation(Expectation(untyped\_expectation));}
\DoxyCodeLine{01586\ \ \ \ \ \}}
\DoxyCodeLine{01587\ }
\DoxyCodeLine{01588\ \ \ \ \ \textcolor{keywordflow}{return}\ *expectation;}
\DoxyCodeLine{01589\ \ \ \}}
\DoxyCodeLine{01590\ }
\DoxyCodeLine{01591\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01592\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ Func>}
\DoxyCodeLine{01593\ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{class\ }TypedExpectation;}
\DoxyCodeLine{01594\ }
\DoxyCodeLine{01595\ \ \ \textcolor{comment}{//\ Some\ utilities\ needed\ for\ implementing\ UntypedInvokeWith().}}
\DoxyCodeLine{01596\ }
\DoxyCodeLine{01597\ \ \ \textcolor{comment}{//\ Describes\ what\ default\ action\ will\ be\ performed\ for\ the\ given}}
\DoxyCodeLine{01598\ \ \ \textcolor{comment}{//\ arguments.}}
\DoxyCodeLine{01599\ \ \ \textcolor{comment}{//\ L\ =\ *}}
\DoxyCodeLine{01600\ \ \ \textcolor{keywordtype}{void}\ DescribeDefaultActionTo(\textcolor{keyword}{const}\ ArgumentTuple\&\ args,}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ os)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01602\ \ \ \ \ \textcolor{keyword}{const}\ OnCallSpec<F>*\ \textcolor{keyword}{const}\ spec\ =\ FindOnCallSpec(args);}
\DoxyCodeLine{01603\ }
\DoxyCodeLine{01604\ \ \ \ \ \textcolor{keywordflow}{if}\ (spec\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01605\ \ \ \ \ \ \ *os\ <<\ (std::is\_void<Result>::value\ ?\ \textcolor{stringliteral}{"{}returning\ directly.\(\backslash\)n"{}}}
\DoxyCodeLine{01606\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{"{}returning\ default\ value.\(\backslash\)n"{}});}
\DoxyCodeLine{01607\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{01608\ \ \ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}taking\ default\ action\ specified\ at:\(\backslash\)n"{}}}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ \ \ <<\ FormatFileLocation(spec-\/>file(),\ spec-\/>line())\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01610\ \ \ \ \ \}}
\DoxyCodeLine{01611\ \ \ \}}
\DoxyCodeLine{01612\ }
\DoxyCodeLine{01613\ \ \ \textcolor{comment}{//\ Writes\ a\ message\ that\ the\ call\ is\ uninteresting\ (i.e.\ neither}}
\DoxyCodeLine{01614\ \ \ \textcolor{comment}{//\ explicitly\ expected\ nor\ explicitly\ unexpected)\ to\ the\ given}}
\DoxyCodeLine{01615\ \ \ \textcolor{comment}{//\ ostream.}}
\DoxyCodeLine{01616\ \ \ \textcolor{keywordtype}{void}\ UntypedDescribeUninterestingCall(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ untyped\_args,}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ os)\ \textcolor{keyword}{const}\ \textcolor{keyword}{override}}
\DoxyCodeLine{01618\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01619\ \ \ \ \ \textcolor{keyword}{const}\ ArgumentTuple\&\ args\ =}
\DoxyCodeLine{01620\ \ \ \ \ \ \ \ \ *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{01621\ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}Uninteresting\ mock\ function\ call\ -\/\ "{}};}
\DoxyCodeLine{01622\ \ \ \ \ DescribeDefaultActionTo(args,\ os);}
\DoxyCodeLine{01623\ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ Function\ call:\ "{}}\ <<\ Name();}
\DoxyCodeLine{01624\ \ \ \ \ UniversalPrint(args,\ os);}
\DoxyCodeLine{01625\ \ \ \}}
\DoxyCodeLine{01626\ }
\DoxyCodeLine{01627\ \ \ \textcolor{comment}{//\ Returns\ the\ expectation\ that\ matches\ the\ given\ function\ arguments}}
\DoxyCodeLine{01628\ \ \ \textcolor{comment}{//\ (or\ NULL\ is\ there's\ no\ match);\ when\ a\ match\ is\ found,}}
\DoxyCodeLine{01629\ \ \ \textcolor{comment}{//\ untyped\_action\ is\ set\ to\ point\ to\ the\ action\ that\ should\ be}}
\DoxyCodeLine{01630\ \ \ \textcolor{comment}{//\ performed\ (or\ NULL\ if\ the\ action\ is\ "{}do\ default"{}),\ and}}
\DoxyCodeLine{01631\ \ \ \textcolor{comment}{//\ is\_excessive\ is\ modified\ to\ indicate\ whether\ the\ call\ exceeds\ the}}
\DoxyCodeLine{01632\ \ \ \textcolor{comment}{//\ expected\ number.}}
\DoxyCodeLine{01633\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01634\ \ \ \textcolor{comment}{//\ Critical\ section:\ We\ must\ find\ the\ matching\ expectation\ and\ the}}
\DoxyCodeLine{01635\ \ \ \textcolor{comment}{//\ corresponding\ action\ that\ needs\ to\ be\ taken\ in\ an\ ATOMIC}}
\DoxyCodeLine{01636\ \ \ \textcolor{comment}{//\ transaction.\ \ Otherwise\ another\ thread\ may\ call\ this\ mock}}
\DoxyCodeLine{01637\ \ \ \textcolor{comment}{//\ method\ in\ the\ middle\ and\ mess\ up\ the\ state.}}
\DoxyCodeLine{01638\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01639\ \ \ \textcolor{comment}{//\ However,\ performing\ the\ action\ has\ to\ be\ left\ out\ of\ the\ critical}}
\DoxyCodeLine{01640\ \ \ \textcolor{comment}{//\ section.\ \ The\ reason\ is\ that\ we\ have\ no\ control\ on\ what\ the}}
\DoxyCodeLine{01641\ \ \ \textcolor{comment}{//\ action\ does\ (it\ can\ invoke\ an\ arbitrary\ user\ function\ or\ even\ a}}
\DoxyCodeLine{01642\ \ \ \textcolor{comment}{//\ mock\ function)\ and\ excessive\ locking\ could\ cause\ a\ dead\ lock.}}
\DoxyCodeLine{01643\ \ \ \textcolor{keyword}{const}\ ExpectationBase*\ UntypedFindMatchingExpectation(}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ untyped\_args,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}**\ untyped\_action,\ \textcolor{keywordtype}{bool}*\ is\_excessive,}
\DoxyCodeLine{01645\ \ \ \ \ \ \ ::std::ostream*\ what,\ ::std::ostream*\ why)\ \textcolor{keyword}{override}}
\DoxyCodeLine{01646\ \ \ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01647\ \ \ \ \ \textcolor{keyword}{const}\ ArgumentTuple\&\ args\ =}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{01649\ \ \ \ \ MutexLock\ l(\&g\_gmock\_mutex);}
\DoxyCodeLine{01650\ \ \ \ \ TypedExpectation<F>*\ exp\ =\ this-\/>FindMatchingExpectationLocked(args);}
\DoxyCodeLine{01651\ \ \ \ \ \textcolor{keywordflow}{if}\ (exp\ ==\ \textcolor{keyword}{nullptr})\ \{\ \ \textcolor{comment}{//\ A\ match\ wasn't\ found.}}
\DoxyCodeLine{01652\ \ \ \ \ \ \ this-\/>FormatUnexpectedCallMessageLocked(args,\ what,\ why);}
\DoxyCodeLine{01653\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01654\ \ \ \ \ \}}
\DoxyCodeLine{01655\ }
\DoxyCodeLine{01656\ \ \ \ \ \textcolor{comment}{//\ This\ line\ must\ be\ done\ before\ calling\ GetActionForArguments(),}}
\DoxyCodeLine{01657\ \ \ \ \ \textcolor{comment}{//\ which\ will\ increment\ the\ call\ count\ for\ *exp\ and\ thus\ affect}}
\DoxyCodeLine{01658\ \ \ \ \ \textcolor{comment}{//\ its\ saturation\ status.}}
\DoxyCodeLine{01659\ \ \ \ \ *is\_excessive\ =\ exp-\/>IsSaturated();}
\DoxyCodeLine{01660\ \ \ \ \ \textcolor{keyword}{const}\ Action<F>*\ action\ =\ exp-\/>GetActionForArguments(\textcolor{keyword}{this},\ args,\ what,\ why);}
\DoxyCodeLine{01661\ \ \ \ \ \textcolor{keywordflow}{if}\ (action\ !=\ \textcolor{keyword}{nullptr}\ \&\&\ action-\/>IsDoDefault())}
\DoxyCodeLine{01662\ \ \ \ \ \ \ action\ =\ \textcolor{keyword}{nullptr};\ \ \textcolor{comment}{//\ Normalize\ "{}do\ default"{}\ to\ NULL.}}
\DoxyCodeLine{01663\ \ \ \ \ *untyped\_action\ =\ action;}
\DoxyCodeLine{01664\ \ \ \ \ \textcolor{keywordflow}{return}\ exp;}
\DoxyCodeLine{01665\ \ \ \}}
\DoxyCodeLine{01666\ }
\DoxyCodeLine{01667\ \ \ \textcolor{comment}{//\ Prints\ the\ given\ function\ arguments\ to\ the\ ostream.}}
\DoxyCodeLine{01668\ \ \ \textcolor{keywordtype}{void}\ UntypedPrintArgs(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ untyped\_args,}
\DoxyCodeLine{01669\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ os)\textcolor{keyword}{\ const\ override\ }\{}
\DoxyCodeLine{01670\ \ \ \ \ \textcolor{keyword}{const}\ ArgumentTuple\&\ args\ =}
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }ArgumentTuple*\textcolor{keyword}{>}(untyped\_args);}
\DoxyCodeLine{01672\ \ \ \ \ UniversalPrint(args,\ os);}
\DoxyCodeLine{01673\ \ \ \}}
\DoxyCodeLine{01674\ }
\DoxyCodeLine{01675\ \ \ \textcolor{comment}{//\ Returns\ the\ expectation\ that\ matches\ the\ arguments,\ or\ NULL\ if\ no}}
\DoxyCodeLine{01676\ \ \ \textcolor{comment}{//\ expectation\ matches\ them.}}
\DoxyCodeLine{01677\ \ \ TypedExpectation<F>*\ FindMatchingExpectationLocked(\textcolor{keyword}{const}\ ArgumentTuple\&\ args)}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \textcolor{keyword}{const}\ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01679\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01680\ \ \ \ \ \textcolor{comment}{//\ See\ the\ definition\ of\ untyped\_expectations\_\ for\ why\ access\ to}}
\DoxyCodeLine{01681\ \ \ \ \ \textcolor{comment}{//\ it\ is\ unprotected\ here.}}
\DoxyCodeLine{01682\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keyword}{typename}\ UntypedExpectations::const\_reverse\_iterator\ it\ =}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \ untyped\_expectations\_.rbegin();}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ it\ !=\ untyped\_expectations\_.rend();\ ++it)\ \{}
\DoxyCodeLine{01685\ \ \ \ \ \ \ TypedExpectation<F>*\ \textcolor{keyword}{const}\ exp\ =}
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}TypedExpectation<F>*\textcolor{keyword}{>}(it-\/>get());}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (exp-\/>ShouldHandleArguments(args))\ \{}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ exp;}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01690\ \ \ \ \ \}}
\DoxyCodeLine{01691\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01692\ \ \ \}}
\DoxyCodeLine{01693\ }
\DoxyCodeLine{01694\ \ \ \textcolor{comment}{//\ Returns\ a\ message\ that\ the\ arguments\ don't\ match\ any\ expectation.}}
\DoxyCodeLine{01695\ \ \ \textcolor{keywordtype}{void}\ FormatUnexpectedCallMessageLocked(\textcolor{keyword}{const}\ ArgumentTuple\&\ args,}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ os,}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ why)\ \textcolor{keyword}{const}}
\DoxyCodeLine{01698\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01699\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01700\ \ \ \ \ *os\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)nUnexpected\ mock\ function\ call\ -\/\ "{}};}
\DoxyCodeLine{01701\ \ \ \ \ DescribeDefaultActionTo(args,\ os);}
\DoxyCodeLine{01702\ \ \ \ \ PrintTriedExpectationsLocked(args,\ why);}
\DoxyCodeLine{01703\ \ \ \}}
\DoxyCodeLine{01704\ }
\DoxyCodeLine{01705\ \ \ \textcolor{comment}{//\ Prints\ a\ list\ of\ expectations\ that\ have\ been\ tried\ against\ the}}
\DoxyCodeLine{01706\ \ \ \textcolor{comment}{//\ current\ mock\ function\ call.}}
\DoxyCodeLine{01707\ \ \ \textcolor{keywordtype}{void}\ PrintTriedExpectationsLocked(\textcolor{keyword}{const}\ ArgumentTuple\&\ args,}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ::std::ostream*\ why)\ \textcolor{keyword}{const}}
\DoxyCodeLine{01709\ \ \ \ \ \ \ GTEST\_EXCLUSIVE\_LOCK\_REQUIRED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01710\ \ \ \ \ g\_gmock\_mutex.AssertHeld();}
\DoxyCodeLine{01711\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{size\_t}\ count\ =\ untyped\_expectations\_.size();}
\DoxyCodeLine{01712\ \ \ \ \ *why\ <<\ \textcolor{stringliteral}{"{}Google\ Mock\ tried\ the\ following\ "{}}\ <<\ count\ <<\ \textcolor{stringliteral}{"{}\ "{}}}
\DoxyCodeLine{01713\ \ \ \ \ \ \ \ \ \ <<\ (count\ ==\ 1\ ?\ \textcolor{stringliteral}{"{}expectation,\ but\ it\ didn't\ match"{}}}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ \textcolor{stringliteral}{"{}expectations,\ but\ none\ matched"{}})}
\DoxyCodeLine{01715\ \ \ \ \ \ \ \ \ \ <<\ \textcolor{stringliteral}{"{}:\(\backslash\)n"{}};}
\DoxyCodeLine{01716\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{size\_t}\ i\ =\ 0;\ i\ <\ count;\ i++)\ \{}
\DoxyCodeLine{01717\ \ \ \ \ \ \ TypedExpectation<F>*\ \textcolor{keyword}{const}\ expectation\ =}
\DoxyCodeLine{01718\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{static\_cast<}TypedExpectation<F>*\textcolor{keyword}{>}(untyped\_expectations\_[i].get());}
\DoxyCodeLine{01719\ \ \ \ \ \ \ *why\ <<\ \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{01720\ \ \ \ \ \ \ expectation-\/>DescribeLocationTo(why);}
\DoxyCodeLine{01721\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (count\ >\ 1)\ \{}
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ \ *why\ <<\ \textcolor{stringliteral}{"{}tried\ expectation\ \#"{}}\ <<\ i\ <<\ \textcolor{stringliteral}{"{}:\ "{}};}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \}}
\DoxyCodeLine{01724\ \ \ \ \ \ \ *why\ <<\ expectation-\/>source\_text()\ <<\ \textcolor{stringliteral}{"{}...\(\backslash\)n"{}};}
\DoxyCodeLine{01725\ \ \ \ \ \ \ expectation-\/>ExplainMatchResultTo(args,\ why);}
\DoxyCodeLine{01726\ \ \ \ \ \ \ expectation-\/>DescribeCallCountTo(why);}
\DoxyCodeLine{01727\ \ \ \ \ \}}
\DoxyCodeLine{01728\ \ \ \}}
\DoxyCodeLine{01729\ }
\DoxyCodeLine{01730\ \ \ \textcolor{comment}{//\ Performs\ the\ given\ action\ (or\ the\ default\ if\ it's\ null)\ with\ the\ given}}
\DoxyCodeLine{01731\ \ \ \textcolor{comment}{//\ arguments\ and\ returns\ the\ action's\ result.}}
\DoxyCodeLine{01732\ \ \ \textcolor{comment}{//\ L\ =\ *}}
\DoxyCodeLine{01733\ \ \ R\ PerformAction(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ untyped\_action,\ ArgumentTuple\&\&\ args,}
\DoxyCodeLine{01734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ call\_description)\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{01735\ \ \ \ \ \textcolor{keywordflow}{if}\ (untyped\_action\ ==\ \textcolor{keyword}{nullptr})\ \{}
\DoxyCodeLine{01736\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ PerformDefaultAction(std::move(args),\ call\_description);}
\DoxyCodeLine{01737\ \ \ \ \ \}}
\DoxyCodeLine{01738\ }
\DoxyCodeLine{01739\ \ \ \ \ \textcolor{comment}{//\ Make\ a\ copy\ of\ the\ action\ before\ performing\ it,\ in\ case\ the}}
\DoxyCodeLine{01740\ \ \ \ \ \textcolor{comment}{//\ action\ deletes\ the\ mock\ object\ (and\ thus\ deletes\ itself).}}
\DoxyCodeLine{01741\ \ \ \ \ \textcolor{keyword}{const}\ Action<F>\ action\ =\ *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const\ }Action<F>*\textcolor{keyword}{>}(untyped\_action);}
\DoxyCodeLine{01742\ \ \ \ \ \textcolor{keywordflow}{return}\ action.Perform(std::move(args));}
\DoxyCodeLine{01743\ \ \ \}}
\DoxyCodeLine{01744\ }
\DoxyCodeLine{01745\ \ \ \textcolor{comment}{//\ Is\ it\ possible\ to\ store\ an\ object\ of\ the\ supplied\ type\ in\ a\ local\ variable}}
\DoxyCodeLine{01746\ \ \ \textcolor{comment}{//\ for\ the\ sake\ of\ printing\ it,\ then\ return\ it\ on\ to\ the\ caller?}}
\DoxyCodeLine{01747\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{01748\ \ \ \textcolor{keyword}{using\ }can\_print\_result\ =\ internal::conjunction<}
\DoxyCodeLine{01749\ \ \ \ \ \ \ \textcolor{comment}{//\ void\ can't\ be\ stored\ as\ an\ object\ (and\ we\ also\ don't\ need\ to\ print\ it).}}
\DoxyCodeLine{01750\ \ \ \ \ \ \ internal::negation<std::is\_void<T>>,}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \textcolor{comment}{//\ Non-\/moveable\ types\ can't\ be\ returned\ on\ to\ the\ user,\ so\ there's\ no\ way}}
\DoxyCodeLine{01752\ \ \ \ \ \ \ \textcolor{comment}{//\ for\ us\ to\ intercept\ and\ print\ them.}}
\DoxyCodeLine{01753\ \ \ \ \ \ \ std::is\_move\_constructible<T>>;}
\DoxyCodeLine{01754\ }
\DoxyCodeLine{01755\ \ \ \textcolor{comment}{//\ Perform\ the\ supplied\ action,\ printing\ the\ result\ to\ os.}}
\DoxyCodeLine{01756\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T\ =\ R,}
\DoxyCodeLine{01757\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ std::enable\_if<can\_print\_result<T>::value,\ \textcolor{keywordtype}{int}>::type\ =\ 0>}
\DoxyCodeLine{01758\ \ \ R\ PerformActionAndPrintResult(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{const}\ untyped\_action,}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ArgumentTuple\&\&\ args,}
\DoxyCodeLine{01760\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ call\_description,}
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::ostream\&\ os)\ \{}
\DoxyCodeLine{01762\ \ \ \ \ R\ result\ =\ PerformAction(untyped\_action,\ std::move(args),\ call\_description);}
\DoxyCodeLine{01763\ }
\DoxyCodeLine{01764\ \ \ \ \ PrintAsActionResult(result,\ os);}
\DoxyCodeLine{01765\ \ \ \ \ \textcolor{keywordflow}{return}\ std::forward<R>(result);}
\DoxyCodeLine{01766\ \ \ \}}
\DoxyCodeLine{01767\ }
\DoxyCodeLine{01768\ \ \ \textcolor{comment}{//\ An\ overload\ for\ when\ it's\ not\ possible\ to\ print\ the\ result.\ In\ this\ case\ we}}
\DoxyCodeLine{01769\ \ \ \textcolor{comment}{//\ simply\ perform\ the\ action.}}
\DoxyCodeLine{01770\ \ \ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T\ =\ R,}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{typename}\ std::enable\_if<}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ internal::negation<can\_print\_result<T>>::value,\ \textcolor{keywordtype}{int}>::type\ =\ 0>}
\DoxyCodeLine{01773\ \ \ R\ PerformActionAndPrintResult(\textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ \textcolor{keyword}{const}\ untyped\_action,}
\DoxyCodeLine{01774\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ArgumentTuple\&\&\ args,}
\DoxyCodeLine{01775\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::string\&\ call\_description,}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::ostream\&)\ \{}
\DoxyCodeLine{01777\ \ \ \ \ \textcolor{keywordflow}{return}\ PerformAction(untyped\_action,\ std::move(args),\ call\_description);}
\DoxyCodeLine{01778\ \ \ \}}
\DoxyCodeLine{01779\ }
\DoxyCodeLine{01780\ \ \ \textcolor{comment}{//\ Returns\ the\ result\ of\ invoking\ this\ mock\ function\ with\ the\ given}}
\DoxyCodeLine{01781\ \ \ \textcolor{comment}{//\ arguments.\ This\ function\ can\ be\ safely\ called\ from\ multiple}}
\DoxyCodeLine{01782\ \ \ \textcolor{comment}{//\ threads\ concurrently.}}
\DoxyCodeLine{01783\ \ \ R\ InvokeWith(ArgumentTuple\&\&\ args)\ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex);}
\DoxyCodeLine{01784\ \};\ \ \textcolor{comment}{//\ class\ FunctionMocker}}
\DoxyCodeLine{01785\ }
\DoxyCodeLine{01786\ \textcolor{comment}{//\ Calculates\ the\ result\ of\ invoking\ this\ mock\ function\ with\ the\ given}}
\DoxyCodeLine{01787\ \textcolor{comment}{//\ arguments,\ prints\ it,\ and\ returns\ it.}}
\DoxyCodeLine{01788\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ R,\ \textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{01789\ R\ FunctionMocker<R(Args...)>::InvokeWith(ArgumentTuple\&\&\ args)}
\DoxyCodeLine{01790\ \ \ \ \ GTEST\_LOCK\_EXCLUDED\_(g\_gmock\_mutex)\ \{}
\DoxyCodeLine{01791\ \ \ \textcolor{comment}{//\ See\ the\ definition\ of\ untyped\_expectations\_\ for\ why\ access\ to\ it}}
\DoxyCodeLine{01792\ \ \ \textcolor{comment}{//\ is\ unprotected\ here.}}
\DoxyCodeLine{01793\ \ \ \textcolor{keywordflow}{if}\ (untyped\_expectations\_.size()\ ==\ 0)\ \{}
\DoxyCodeLine{01794\ \ \ \ \ \textcolor{comment}{//\ No\ expectation\ is\ set\ on\ this\ mock\ method\ -\/\ we\ have\ an}}
\DoxyCodeLine{01795\ \ \ \ \ \textcolor{comment}{//\ uninteresting\ call.}}
\DoxyCodeLine{01796\ }
\DoxyCodeLine{01797\ \ \ \ \ \textcolor{comment}{//\ We\ must\ get\ Google\ Mock's\ reaction\ on\ uninteresting\ calls}}
\DoxyCodeLine{01798\ \ \ \ \ \textcolor{comment}{//\ made\ on\ this\ mock\ object\ BEFORE\ performing\ the\ action,}}
\DoxyCodeLine{01799\ \ \ \ \ \textcolor{comment}{//\ because\ the\ action\ may\ DELETE\ the\ mock\ object\ and\ make\ the}}
\DoxyCodeLine{01800\ \ \ \ \ \textcolor{comment}{//\ following\ expression\ meaningless.}}
\DoxyCodeLine{01801\ \ \ \ \ \textcolor{keyword}{const}\ CallReaction\ reaction\ =}
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ Mock::GetReactionOnUninterestingCalls(MockObject());}
\DoxyCodeLine{01803\ }
\DoxyCodeLine{01804\ \ \ \ \ \textcolor{comment}{//\ True\ if\ and\ only\ if\ we\ need\ to\ print\ this\ call's\ arguments\ and\ return}}
\DoxyCodeLine{01805\ \ \ \ \ \textcolor{comment}{//\ value.\ \ This\ definition\ must\ be\ kept\ in\ sync\ with}}
\DoxyCodeLine{01806\ \ \ \ \ \textcolor{comment}{//\ the\ behavior\ of\ ReportUninterestingCall().}}
\DoxyCodeLine{01807\ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ need\_to\_report\_uninteresting\_call\ =}
\DoxyCodeLine{01808\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ user\ allows\ this\ uninteresting\ call,\ we\ print\ it}}
\DoxyCodeLine{01809\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ only\ when\ they\ want\ informational\ messages.}}
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ reaction\ ==\ kAllow\ ?\ LogIsVisible(kInfo)\ :}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ If\ the\ user\ wants\ this\ to\ be\ a\ warning,\ we\ print}}
\DoxyCodeLine{01812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ it\ only\ when\ they\ want\ to\ see\ warnings.}}
\DoxyCodeLine{01813\ \ \ \ \ \ \ \ \ \ \ \ \ reaction\ ==\ kWarn}
\DoxyCodeLine{01814\ \ \ \ \ \ \ \ \ \ \ \ \ ?\ LogIsVisible(kWarning)}
\DoxyCodeLine{01815\ \ \ \ \ \ \ \ \ \ \ \ \ :}
\DoxyCodeLine{01816\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Otherwise,\ the\ user\ wants\ this\ to\ be\ an\ error,\ and\ we}}
\DoxyCodeLine{01817\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ should\ always\ print\ detailed\ information\ in\ the\ error.}}
\DoxyCodeLine{01818\ \ \ \ \ \ \ \ \ \ \ \ \ true;}
\DoxyCodeLine{01819\ }
\DoxyCodeLine{01820\ \ \ \ \ \textcolor{keywordflow}{if}\ (!need\_to\_report\_uninteresting\_call)\ \{}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \textcolor{comment}{//\ Perform\ the\ action\ without\ printing\ the\ call\ information.}}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>PerformDefaultAction(}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ \ \ \ std::move(args),\ \textcolor{stringliteral}{"{}Function\ call:\ "{}}\ +\ std::string(Name()));}
\DoxyCodeLine{01824\ \ \ \ \ \}}
\DoxyCodeLine{01825\ }
\DoxyCodeLine{01826\ \ \ \ \ \textcolor{comment}{//\ Warns\ about\ the\ uninteresting\ call.}}
\DoxyCodeLine{01827\ \ \ \ \ ::std::stringstream\ ss;}
\DoxyCodeLine{01828\ \ \ \ \ this-\/>UntypedDescribeUninterestingCall(\&args,\ \&ss);}
\DoxyCodeLine{01829\ }
\DoxyCodeLine{01830\ \ \ \ \ \textcolor{comment}{//\ Perform\ the\ action,\ print\ the\ result,\ and\ then\ report\ the\ uninteresting}}
\DoxyCodeLine{01831\ \ \ \ \ \textcolor{comment}{//\ call.}}
\DoxyCodeLine{01832\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01833\ \ \ \ \ \textcolor{comment}{//\ We\ use\ RAII\ to\ do\ the\ latter\ in\ case\ R\ is\ void\ or\ a\ non-\/moveable\ type.\ In}}
\DoxyCodeLine{01834\ \ \ \ \ \textcolor{comment}{//\ either\ case\ we\ can't\ assign\ it\ to\ a\ local\ variable.}}
\DoxyCodeLine{01835\ \ \ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01836\ \ \ \ \ \textcolor{comment}{//\ Note\ that\ std::bind()\ is\ essential\ here.}}
\DoxyCodeLine{01837\ \ \ \ \ \textcolor{comment}{//\ We\ *don't*\ use\ any\ local\ callback\ types\ (like\ lambdas).}}
\DoxyCodeLine{01838\ \ \ \ \ \textcolor{comment}{//\ Doing\ so\ slows\ down\ compilation\ dramatically\ because\ the\ *constructor*\ of}}
\DoxyCodeLine{01839\ \ \ \ \ \textcolor{comment}{//\ std::function<T>\ is\ re-\/instantiated\ with\ different\ template}}
\DoxyCodeLine{01840\ \ \ \ \ \textcolor{comment}{//\ parameters\ each\ time.}}
\DoxyCodeLine{01841\ \ \ \ \ \textcolor{keyword}{const}\ UninterestingCallCleanupHandler\ report\_uninteresting\_call\ =\ \{}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ reaction,\ ss}
\DoxyCodeLine{01843\ \ \ \ \ \};}
\DoxyCodeLine{01844\ }
\DoxyCodeLine{01845\ \ \ \ \ \textcolor{keywordflow}{return}\ PerformActionAndPrintResult(\textcolor{keyword}{nullptr},\ std::move(args),\ ss.str(),\ ss);}
\DoxyCodeLine{01846\ \ \ \}}
\DoxyCodeLine{01847\ }
\DoxyCodeLine{01848\ \ \ \textcolor{keywordtype}{bool}\ is\_excessive\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01849\ \ \ ::std::stringstream\ ss;}
\DoxyCodeLine{01850\ \ \ ::std::stringstream\ why;}
\DoxyCodeLine{01851\ \ \ ::std::stringstream\ loc;}
\DoxyCodeLine{01852\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}*\ untyped\_action\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01853\ }
\DoxyCodeLine{01854\ \ \ \textcolor{comment}{//\ The\ UntypedFindMatchingExpectation()\ function\ acquires\ and}}
\DoxyCodeLine{01855\ \ \ \textcolor{comment}{//\ releases\ g\_gmock\_mutex.}}
\DoxyCodeLine{01856\ }
\DoxyCodeLine{01857\ \ \ \textcolor{keyword}{const}\ ExpectationBase*\ \textcolor{keyword}{const}\ untyped\_expectation\ =}
\DoxyCodeLine{01858\ \ \ \ \ \ \ this-\/>UntypedFindMatchingExpectation(\&args,\ \&untyped\_action,}
\DoxyCodeLine{01859\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \&is\_excessive,\ \&ss,\ \&why);}
\DoxyCodeLine{01860\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ found\ =\ untyped\_expectation\ !=\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{01861\ }
\DoxyCodeLine{01862\ \ \ \textcolor{comment}{//\ True\ if\ and\ only\ if\ we\ need\ to\ print\ the\ call's\ arguments}}
\DoxyCodeLine{01863\ \ \ \textcolor{comment}{//\ and\ return\ value.}}
\DoxyCodeLine{01864\ \ \ \textcolor{comment}{//\ This\ definition\ must\ be\ kept\ in\ sync\ with\ the\ uses\ of\ Expect()}}
\DoxyCodeLine{01865\ \ \ \textcolor{comment}{//\ and\ Log()\ in\ this\ function.}}
\DoxyCodeLine{01866\ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ need\_to\_report\_call\ =}
\DoxyCodeLine{01867\ \ \ \ \ \ \ !found\ ||\ is\_excessive\ ||\ LogIsVisible(kInfo);}
\DoxyCodeLine{01868\ \ \ \textcolor{keywordflow}{if}\ (!need\_to\_report\_call)\ \{}
\DoxyCodeLine{01869\ \ \ \ \ \textcolor{comment}{//\ Perform\ the\ action\ without\ printing\ the\ call\ information.}}
\DoxyCodeLine{01870\ \ \ \ \ \textcolor{keywordflow}{return}\ PerformAction(untyped\_action,\ std::move(args),\ \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01871\ \ \ \}}
\DoxyCodeLine{01872\ }
\DoxyCodeLine{01873\ \ \ ss\ <<\ \textcolor{stringliteral}{"{}\ \ \ \ Function\ call:\ "{}}\ <<\ Name();}
\DoxyCodeLine{01874\ \ \ this-\/>UntypedPrintArgs(\&args,\ \&ss);}
\DoxyCodeLine{01875\ }
\DoxyCodeLine{01876\ \ \ \textcolor{comment}{//\ In\ case\ the\ action\ deletes\ a\ piece\ of\ the\ expectation,\ we}}
\DoxyCodeLine{01877\ \ \ \textcolor{comment}{//\ generate\ the\ message\ beforehand.}}
\DoxyCodeLine{01878\ \ \ \textcolor{keywordflow}{if}\ (found\ \&\&\ !is\_excessive)\ \{}
\DoxyCodeLine{01879\ \ \ \ \ untyped\_expectation-\/>DescribeLocationTo(\&loc);}
\DoxyCodeLine{01880\ \ \ \}}
\DoxyCodeLine{01881\ }
\DoxyCodeLine{01882\ \ \ \textcolor{comment}{//\ Perform\ the\ action,\ print\ the\ result,\ and\ then\ fail\ or\ log\ in\ whatever\ way}}
\DoxyCodeLine{01883\ \ \ \textcolor{comment}{//\ is\ appropriate.}}
\DoxyCodeLine{01884\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01885\ \ \ \textcolor{comment}{//\ We\ use\ RAII\ to\ do\ the\ latter\ in\ case\ R\ is\ void\ or\ a\ non-\/moveable\ type.\ In}}
\DoxyCodeLine{01886\ \ \ \textcolor{comment}{//\ either\ case\ we\ can't\ assign\ it\ to\ a\ local\ variable.}}
\DoxyCodeLine{01887\ \ \ \textcolor{comment}{//}}
\DoxyCodeLine{01888\ \ \ \textcolor{comment}{//\ Note\ that\ we\ *don't*\ use\ any\ local\ callback\ types\ (like\ lambdas)\ here.}}
\DoxyCodeLine{01889\ \ \ \textcolor{comment}{//\ Doing\ so\ slows\ down\ compilation\ dramatically\ because\ the\ *constructor*\ of}}
\DoxyCodeLine{01890\ \ \ \textcolor{comment}{//\ std::function<T>\ is\ re-\/instantiated\ with\ different\ template}}
\DoxyCodeLine{01891\ \ \ \textcolor{comment}{//\ parameters\ each\ time.}}
\DoxyCodeLine{01892\ \ \ \textcolor{keyword}{const}\ FailureCleanupHandler\ handle\_failures\ =\ \{}
\DoxyCodeLine{01893\ \ \ \ \ \ \ ss,\ why,\ loc,\ untyped\_expectation,\ found,\ is\_excessive}
\DoxyCodeLine{01894\ \ \ \};}
\DoxyCodeLine{01895\ }
\DoxyCodeLine{01896\ \ \ \textcolor{keywordflow}{return}\ PerformActionAndPrintResult(untyped\_action,\ std::move(args),\ ss.str(),}
\DoxyCodeLine{01897\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ss);}
\DoxyCodeLine{01898\ \}}
\DoxyCodeLine{01899\ }
\DoxyCodeLine{01900\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{01901\ }
\DoxyCodeLine{01902\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{01903\ }
\DoxyCodeLine{01904\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{01905\ \textcolor{keyword}{class\ }MockFunction;}
\DoxyCodeLine{01906\ }
\DoxyCodeLine{01907\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ R,\ \textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{01908\ \textcolor{keyword}{class\ }MockFunction<R(Args...)>\ \{}
\DoxyCodeLine{01909\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{01910\ \ \ MockFunction(\textcolor{keyword}{const}\ MockFunction\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01911\ \ \ MockFunction\&\ operator=(\textcolor{keyword}{const}\ MockFunction\&)\ =\ \textcolor{keyword}{delete};}
\DoxyCodeLine{01912\ }
\DoxyCodeLine{01913\ \ \ std::function<R(Args...)>\ AsStdFunction()\ \{}
\DoxyCodeLine{01914\ \ \ \ \ \textcolor{keywordflow}{return}\ [\textcolor{keyword}{this}](Args...\ args)\ -\/>\ R\ \{}
\DoxyCodeLine{01915\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>Call(std::forward<Args>(args)...);}
\DoxyCodeLine{01916\ \ \ \ \ \};}
\DoxyCodeLine{01917\ \ \ \}}
\DoxyCodeLine{01918\ }
\DoxyCodeLine{01919\ \ \ \textcolor{comment}{//\ Implementation\ detail:\ the\ expansion\ of\ the\ MOCK\_METHOD\ macro.}}
\DoxyCodeLine{01920\ \ \ R\ Call(Args...\ args)\ \{}
\DoxyCodeLine{01921\ \ \ \ \ mock\_.SetOwnerAndName(\textcolor{keyword}{this},\ \textcolor{stringliteral}{"{}Call"{}});}
\DoxyCodeLine{01922\ \ \ \ \ \textcolor{keywordflow}{return}\ mock\_.Invoke(std::forward<Args>(args)...);}
\DoxyCodeLine{01923\ \ \ \}}
\DoxyCodeLine{01924\ }
\DoxyCodeLine{01925\ \ \ MockSpec<R(Args...)>\ gmock\_Call(Matcher<Args>...\ m)\ \{}
\DoxyCodeLine{01926\ \ \ \ \ mock\_.RegisterOwner(\textcolor{keyword}{this});}
\DoxyCodeLine{01927\ \ \ \ \ \textcolor{keywordflow}{return}\ mock\_.With(std::move(m)...);}
\DoxyCodeLine{01928\ \ \ \}}
\DoxyCodeLine{01929\ }
\DoxyCodeLine{01930\ \ \ MockSpec<R(Args...)>\ gmock\_Call(\textcolor{keyword}{const}\ WithoutMatchers\&,\ R\ (*)(Args...))\ \{}
\DoxyCodeLine{01931\ \ \ \ \ \textcolor{keywordflow}{return}\ this-\/>gmock\_Call(::testing::A<Args>()...);}
\DoxyCodeLine{01932\ \ \ \}}
\DoxyCodeLine{01933\ }
\DoxyCodeLine{01934\ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{01935\ \ \ MockFunction()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{01936\ \ \ \string~MockFunction()\ =\ \textcolor{keywordflow}{default};}
\DoxyCodeLine{01937\ }
\DoxyCodeLine{01938\ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{01939\ \ \ FunctionMocker<R(Args...)>\ mock\_;}
\DoxyCodeLine{01940\ \};}
\DoxyCodeLine{01941\ }
\DoxyCodeLine{01942\ \textcolor{comment}{/*}}
\DoxyCodeLine{01943\ \textcolor{comment}{The\ SignatureOf<F>\ struct\ is\ a\ meta-\/function\ returning\ function\ signature}}
\DoxyCodeLine{01944\ \textcolor{comment}{corresponding\ to\ the\ provided\ F\ argument.}}
\DoxyCodeLine{01945\ \textcolor{comment}{}}
\DoxyCodeLine{01946\ \textcolor{comment}{It\ makes\ use\ of\ MockFunction\ easier\ by\ allowing\ it\ to\ accept\ more\ F\ arguments}}
\DoxyCodeLine{01947\ \textcolor{comment}{than\ just\ function\ signatures.}}
\DoxyCodeLine{01948\ \textcolor{comment}{}}
\DoxyCodeLine{01949\ \textcolor{comment}{Specializations\ provided\ here\ cover\ a\ signature\ type\ itself\ and\ any\ template}}
\DoxyCodeLine{01950\ \textcolor{comment}{that\ can\ be\ parameterized\ with\ a\ signature,\ including\ std::function\ and}}
\DoxyCodeLine{01951\ \textcolor{comment}{boost::function.}}
\DoxyCodeLine{01952\ \textcolor{comment}{*/}}
\DoxyCodeLine{01953\ }
\DoxyCodeLine{01954\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F,\ \textcolor{keyword}{typename}\ =\ \textcolor{keywordtype}{void}>}
\DoxyCodeLine{01955\ \textcolor{keyword}{struct\ }SignatureOf;}
\DoxyCodeLine{01956\ }
\DoxyCodeLine{01957\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ R,\ \textcolor{keyword}{typename}...\ Args>}
\DoxyCodeLine{01958\ \textcolor{keyword}{struct\ }SignatureOf<R(Args...)>\ \{}
\DoxyCodeLine{01959\ \ \ \textcolor{keyword}{using\ }type\ =\ R(Args...);}
\DoxyCodeLine{01960\ \};}
\DoxyCodeLine{01961\ }
\DoxyCodeLine{01962\ \textcolor{keyword}{template}\ <\textcolor{keyword}{template}\ <\textcolor{keyword}{typename}>\ \textcolor{keyword}{class\ }C,\ \textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{01963\ \textcolor{keyword}{struct\ }SignatureOf<C<F>,}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ typename\ std::enable\_if<std::is\_function<F>::value>::type>}
\DoxyCodeLine{01965\ \ \ \ \ :\ SignatureOf<F>\ \{\};}
\DoxyCodeLine{01966\ }
\DoxyCodeLine{01967\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{01968\ \textcolor{keyword}{using\ }SignatureOfT\ =\ \textcolor{keyword}{typename}\ SignatureOf<F>::type;}
\DoxyCodeLine{01969\ }
\DoxyCodeLine{01970\ \}\ \ \textcolor{comment}{//\ namespace\ internal}}
\DoxyCodeLine{01971\ }
\DoxyCodeLine{01972\ \textcolor{comment}{//\ A\ MockFunction<F>\ type\ has\ one\ mock\ method\ whose\ type\ is}}
\DoxyCodeLine{01973\ \textcolor{comment}{//\ internal::SignatureOfT<F>.\ \ It\ is\ useful\ when\ you\ just\ want\ your}}
\DoxyCodeLine{01974\ \textcolor{comment}{//\ test\ code\ to\ emit\ some\ messages\ and\ have\ Google\ Mock\ verify\ the}}
\DoxyCodeLine{01975\ \textcolor{comment}{//\ right\ messages\ are\ sent\ (and\ perhaps\ at\ the\ right\ times).\ \ For}}
\DoxyCodeLine{01976\ \textcolor{comment}{//\ example,\ if\ you\ are\ exercising\ code:}}
\DoxyCodeLine{01977\ \textcolor{comment}{//}}
\DoxyCodeLine{01978\ \textcolor{comment}{//\ \ \ Foo(1);}}
\DoxyCodeLine{01979\ \textcolor{comment}{//\ \ \ Foo(2);}}
\DoxyCodeLine{01980\ \textcolor{comment}{//\ \ \ Foo(3);}}
\DoxyCodeLine{01981\ \textcolor{comment}{//}}
\DoxyCodeLine{01982\ \textcolor{comment}{//\ and\ want\ to\ verify\ that\ Foo(1)\ and\ Foo(3)\ both\ invoke}}
\DoxyCodeLine{01983\ \textcolor{comment}{//\ mock.Bar("{}a"{}),\ but\ Foo(2)\ doesn't\ invoke\ anything,\ you\ can\ write:}}
\DoxyCodeLine{01984\ \textcolor{comment}{//}}
\DoxyCodeLine{01985\ \textcolor{comment}{//\ TEST(FooTest,\ InvokesBarCorrectly)\ \{}}
\DoxyCodeLine{01986\ \textcolor{comment}{//\ \ \ MyMock\ mock;}}
\DoxyCodeLine{01987\ \textcolor{comment}{//\ \ \ MockFunction<void(string\ check\_point\_name)>\ check;}}
\DoxyCodeLine{01988\ \textcolor{comment}{//\ \ \ \{}}
\DoxyCodeLine{01989\ \textcolor{comment}{//\ \ \ \ \ InSequence\ s;}}
\DoxyCodeLine{01990\ \textcolor{comment}{//}}
\DoxyCodeLine{01991\ \textcolor{comment}{//\ \ \ \ \ EXPECT\_CALL(mock,\ Bar("{}a"{}));}}
\DoxyCodeLine{01992\ \textcolor{comment}{//\ \ \ \ \ EXPECT\_CALL(check,\ Call("{}1"{}));}}
\DoxyCodeLine{01993\ \textcolor{comment}{//\ \ \ \ \ EXPECT\_CALL(check,\ Call("{}2"{}));}}
\DoxyCodeLine{01994\ \textcolor{comment}{//\ \ \ \ \ EXPECT\_CALL(mock,\ Bar("{}a"{}));}}
\DoxyCodeLine{01995\ \textcolor{comment}{//\ \ \ \}}}
\DoxyCodeLine{01996\ \textcolor{comment}{//\ \ \ Foo(1);}}
\DoxyCodeLine{01997\ \textcolor{comment}{//\ \ \ check.Call("{}1"{});}}
\DoxyCodeLine{01998\ \textcolor{comment}{//\ \ \ Foo(2);}}
\DoxyCodeLine{01999\ \textcolor{comment}{//\ \ \ check.Call("{}2"{});}}
\DoxyCodeLine{02000\ \textcolor{comment}{//\ \ \ Foo(3);}}
\DoxyCodeLine{02001\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02002\ \textcolor{comment}{//}}
\DoxyCodeLine{02003\ \textcolor{comment}{//\ The\ expectation\ spec\ says\ that\ the\ first\ Bar("{}a"{})\ must\ happen}}
\DoxyCodeLine{02004\ \textcolor{comment}{//\ before\ check\ point\ "{}1"{},\ the\ second\ Bar("{}a"{})\ must\ happen\ after\ check}}
\DoxyCodeLine{02005\ \textcolor{comment}{//\ point\ "{}2"{},\ and\ nothing\ should\ happen\ between\ the\ two\ check}}
\DoxyCodeLine{02006\ \textcolor{comment}{//\ points.\ The\ explicit\ check\ points\ make\ it\ easy\ to\ tell\ which}}
\DoxyCodeLine{02007\ \textcolor{comment}{//\ Bar("{}a"{})\ is\ called\ by\ which\ call\ to\ Foo().}}
\DoxyCodeLine{02008\ \textcolor{comment}{//}}
\DoxyCodeLine{02009\ \textcolor{comment}{//\ MockFunction<F>\ can\ also\ be\ used\ to\ exercise\ code\ that\ accepts}}
\DoxyCodeLine{02010\ \textcolor{comment}{//\ std::function<internal::SignatureOfT<F>>\ callbacks.\ To\ do\ so,\ use}}
\DoxyCodeLine{02011\ \textcolor{comment}{//\ AsStdFunction()\ method\ to\ create\ std::function\ proxy\ forwarding\ to}}
\DoxyCodeLine{02012\ \textcolor{comment}{//\ original\ object's\ Call.\ Example:}}
\DoxyCodeLine{02013\ \textcolor{comment}{//}}
\DoxyCodeLine{02014\ \textcolor{comment}{//\ TEST(FooTest,\ RunsCallbackWithBarArgument)\ \{}}
\DoxyCodeLine{02015\ \textcolor{comment}{//\ \ \ MockFunction<int(string)>\ callback;}}
\DoxyCodeLine{02016\ \textcolor{comment}{//\ \ \ EXPECT\_CALL(callback,\ Call("{}bar"{})).WillOnce(Return(1));}}
\DoxyCodeLine{02017\ \textcolor{comment}{//\ \ \ Foo(callback.AsStdFunction());}}
\DoxyCodeLine{02018\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02019\ \textcolor{comment}{//}}
\DoxyCodeLine{02020\ \textcolor{comment}{//\ The\ internal::SignatureOfT<F>\ indirection\ allows\ to\ use\ other\ types}}
\DoxyCodeLine{02021\ \textcolor{comment}{//\ than\ just\ function\ signature\ type.\ This\ is\ typically\ useful\ when}}
\DoxyCodeLine{02022\ \textcolor{comment}{//\ providing\ a\ mock\ for\ a\ predefined\ std::function\ type.\ Example:}}
\DoxyCodeLine{02023\ \textcolor{comment}{//}}
\DoxyCodeLine{02024\ \textcolor{comment}{//\ using\ FilterPredicate\ =\ std::function<bool(string)>;}}
\DoxyCodeLine{02025\ \textcolor{comment}{//\ void\ MyFilterAlgorithm(FilterPredicate\ predicate);}}
\DoxyCodeLine{02026\ \textcolor{comment}{//}}
\DoxyCodeLine{02027\ \textcolor{comment}{//\ TEST(FooTest,\ FilterPredicateAlwaysAccepts)\ \{}}
\DoxyCodeLine{02028\ \textcolor{comment}{//\ \ \ MockFunction<FilterPredicate>\ predicateMock;}}
\DoxyCodeLine{02029\ \textcolor{comment}{//\ \ \ EXPECT\_CALL(predicateMock,\ Call(\_)).WillRepeatedly(Return(true));}}
\DoxyCodeLine{02030\ \textcolor{comment}{//\ \ \ MyFilterAlgorithm(predicateMock.AsStdFunction());}}
\DoxyCodeLine{02031\ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{02032\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ F>}
\DoxyCodeLine{02033\ \textcolor{keyword}{class\ }MockFunction\ :\ \textcolor{keyword}{public}\ internal::MockFunction<internal::SignatureOfT<F>>\ \{}
\DoxyCodeLine{02034\ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{classBase}{Base}}\ =\ internal::MockFunction<internal::SignatureOfT<F>>;}
\DoxyCodeLine{02035\ }
\DoxyCodeLine{02036\ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{02037\ \ \ \textcolor{keyword}{using\ }Base::Base;}
\DoxyCodeLine{02038\ \};}
\DoxyCodeLine{02039\ }
\DoxyCodeLine{02040\ \textcolor{comment}{//\ The\ style\ guide\ prohibits\ "{}using"{}\ statements\ in\ a\ namespace\ scope}}
\DoxyCodeLine{02041\ \textcolor{comment}{//\ inside\ a\ header\ file.\ \ However,\ the\ MockSpec\ class\ template\ is}}
\DoxyCodeLine{02042\ \textcolor{comment}{//\ meant\ to\ be\ defined\ in\ the\ ::testing\ namespace.\ \ The\ following\ line}}
\DoxyCodeLine{02043\ \textcolor{comment}{//\ is\ just\ a\ trick\ for\ working\ around\ a\ bug\ in\ MSVC\ 8.0,\ which\ cannot}}
\DoxyCodeLine{02044\ \textcolor{comment}{//\ handle\ it\ if\ we\ define\ MockSpec\ in\ ::testing.}}
\DoxyCodeLine{02045\ \textcolor{keyword}{using\ }internal::MockSpec;}
\DoxyCodeLine{02046\ }
\DoxyCodeLine{02047\ \textcolor{comment}{//\ Const(x)\ is\ a\ convenient\ function\ for\ obtaining\ a\ const\ reference}}
\DoxyCodeLine{02048\ \textcolor{comment}{//\ to\ x.\ \ This\ is\ useful\ for\ setting\ expectations\ on\ an\ overloaded}}
\DoxyCodeLine{02049\ \textcolor{comment}{//\ const\ mock\ method,\ e.g.}}
\DoxyCodeLine{02050\ \textcolor{comment}{//}}
\DoxyCodeLine{02051\ \textcolor{comment}{//\ \ \ class\ MockFoo\ :\ public\ FooInterface\ \{}}
\DoxyCodeLine{02052\ \textcolor{comment}{//\ \ \ \ public:}}
\DoxyCodeLine{02053\ \textcolor{comment}{//\ \ \ \ \ MOCK\_METHOD0(Bar,\ int());}}
\DoxyCodeLine{02054\ \textcolor{comment}{//\ \ \ \ \ MOCK\_CONST\_METHOD0(Bar,\ int\&());}}
\DoxyCodeLine{02055\ \textcolor{comment}{//\ \ \ \};}}
\DoxyCodeLine{02056\ \textcolor{comment}{//}}
\DoxyCodeLine{02057\ \textcolor{comment}{//\ \ \ MockFoo\ foo;}}
\DoxyCodeLine{02058\ \textcolor{comment}{//\ \ \ //\ Expects\ a\ call\ to\ non-\/const\ MockFoo::Bar().}}
\DoxyCodeLine{02059\ \textcolor{comment}{//\ \ \ EXPECT\_CALL(foo,\ Bar());}}
\DoxyCodeLine{02060\ \textcolor{comment}{//\ \ \ //\ Expects\ a\ call\ to\ const\ MockFoo::Bar().}}
\DoxyCodeLine{02061\ \textcolor{comment}{//\ \ \ EXPECT\_CALL(Const(foo),\ Bar());}}
\DoxyCodeLine{02062\ \textcolor{keyword}{template}\ <\textcolor{keyword}{typename}\ T>}
\DoxyCodeLine{02063\ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ T\&\ Const(\textcolor{keyword}{const}\ T\&\ x)\ \{}
\DoxyCodeLine{02064\ \ \ \textcolor{keywordflow}{return}\ x;}
\DoxyCodeLine{02065\ \}}
\DoxyCodeLine{02066\ }
\DoxyCodeLine{02067\ \textcolor{comment}{//\ Constructs\ an\ Expectation\ object\ that\ references\ and\ co-\/owns\ exp.}}
\DoxyCodeLine{02068\ \textcolor{keyword}{inline}\ Expectation::Expectation(internal::ExpectationBase\&\ exp)\ \ \textcolor{comment}{//\ NOLINT}}
\DoxyCodeLine{02069\ \ \ \ \ :\ expectation\_base\_(exp.GetHandle().expectation\_base())\ \{\}}
\DoxyCodeLine{02070\ }
\DoxyCodeLine{02071\ \}\ \ \textcolor{comment}{//\ namespace\ testing}}
\DoxyCodeLine{02072\ }
\DoxyCodeLine{02073\ GTEST\_DISABLE\_MSC\_WARNINGS\_POP\_()\ \ \textcolor{comment}{//\ \ 4251}}
\DoxyCodeLine{02074\ }
\DoxyCodeLine{02075\ \textcolor{comment}{//\ Implementation\ for\ ON\_CALL\ and\ EXPECT\_CALL\ macros.\ A\ separate\ macro\ is}}
\DoxyCodeLine{02076\ \textcolor{comment}{//\ required\ to\ avoid\ compile\ errors\ when\ the\ name\ of\ the\ method\ used\ in\ call\ is}}
\DoxyCodeLine{02077\ \textcolor{comment}{//\ a\ result\ of\ macro\ expansion.\ See\ CompilesWithMethodNameExpandedFromMacro}}
\DoxyCodeLine{02078\ \textcolor{comment}{//\ tests\ in\ internal/gmock-\/spec-\/builders\_test.cc\ for\ more\ details.}}
\DoxyCodeLine{02079\ \textcolor{comment}{//}}
\DoxyCodeLine{02080\ \textcolor{comment}{//\ This\ macro\ supports\ statements\ both\ with\ and\ without\ parameter\ matchers.\ If}}
\DoxyCodeLine{02081\ \textcolor{comment}{//\ the\ parameter\ list\ is\ omitted,\ gMock\ will\ accept\ any\ parameters,\ which\ allows}}
\DoxyCodeLine{02082\ \textcolor{comment}{//\ tests\ to\ be\ written\ that\ don't\ need\ to\ encode\ the\ number\ of\ method}}
\DoxyCodeLine{02083\ \textcolor{comment}{//\ parameter.\ This\ technique\ may\ only\ be\ used\ for\ non-\/overloaded\ methods.}}
\DoxyCodeLine{02084\ \textcolor{comment}{//}}
\DoxyCodeLine{02085\ \textcolor{comment}{//\ \ \ //\ These\ are\ the\ same:}}
\DoxyCodeLine{02086\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ NoArgsMethod()).WillByDefault(...);}}
\DoxyCodeLine{02087\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ NoArgsMethod).WillByDefault(...);}}
\DoxyCodeLine{02088\ \textcolor{comment}{//}}
\DoxyCodeLine{02089\ \textcolor{comment}{//\ \ \ //\ As\ are\ these:}}
\DoxyCodeLine{02090\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ TwoArgsMethod(\_,\ \_)).WillByDefault(...);}}
\DoxyCodeLine{02091\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ TwoArgsMethod).WillByDefault(...);}}
\DoxyCodeLine{02092\ \textcolor{comment}{//}}
\DoxyCodeLine{02093\ \textcolor{comment}{//\ \ \ //\ Can\ also\ specify\ args\ if\ you\ want,\ of\ course:}}
\DoxyCodeLine{02094\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ TwoArgsMethod(\_,\ 45)).WillByDefault(...);}}
\DoxyCodeLine{02095\ \textcolor{comment}{//}}
\DoxyCodeLine{02096\ \textcolor{comment}{//\ \ \ //\ Overloads\ work\ as\ long\ as\ you\ specify\ parameters:}}
\DoxyCodeLine{02097\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ OverloadedMethod(\_)).WillByDefault(...);}}
\DoxyCodeLine{02098\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ OverloadedMethod(\_,\ \_)).WillByDefault(...);}}
\DoxyCodeLine{02099\ \textcolor{comment}{//}}
\DoxyCodeLine{02100\ \textcolor{comment}{//\ \ \ //\ Oops!\ Which\ overload\ did\ you\ want?}}
\DoxyCodeLine{02101\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ OverloadedMethod).WillByDefault(...);}}
\DoxyCodeLine{02102\ \textcolor{comment}{//\ \ \ \ \ =>\ ERROR:\ call\ to\ member\ function\ 'gmock\_OverloadedMethod'\ is\ ambiguous}}
\DoxyCodeLine{02103\ \textcolor{comment}{//}}
\DoxyCodeLine{02104\ \textcolor{comment}{//\ How\ this\ works:\ The\ mock\ class\ uses\ two\ overloads\ of\ the\ gmock\_Method}}
\DoxyCodeLine{02105\ \textcolor{comment}{//\ expectation\ setter\ method\ plus\ an\ operator()\ overload\ on\ the\ MockSpec\ object.}}
\DoxyCodeLine{02106\ \textcolor{comment}{//\ In\ the\ matcher\ list\ form,\ the\ macro\ expands\ to:}}
\DoxyCodeLine{02107\ \textcolor{comment}{//}}
\DoxyCodeLine{02108\ \textcolor{comment}{//\ \ \ //\ This\ statement:}}
\DoxyCodeLine{02109\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ TwoArgsMethod(\_,\ 45))...}}
\DoxyCodeLine{02110\ \textcolor{comment}{//}}
\DoxyCodeLine{02111\ \textcolor{comment}{//\ \ \ //\ ...expands\ to:}}
\DoxyCodeLine{02112\ \textcolor{comment}{//\ \ \ mock.gmock\_TwoArgsMethod(\_,\ 45)(WithoutMatchers(),\ nullptr)...}}
\DoxyCodeLine{02113\ \textcolor{comment}{//\ \ \ |-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/v-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/||-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/v-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{02114\ \textcolor{comment}{//\ \ \ \ \ \ \ invokes\ first\ overload\ \ \ \ \ \ \ \ swallowed\ by\ operator()}}
\DoxyCodeLine{02115\ \textcolor{comment}{//}}
\DoxyCodeLine{02116\ \textcolor{comment}{//\ \ \ //\ ...which\ is\ essentially:}}
\DoxyCodeLine{02117\ \textcolor{comment}{//\ \ \ mock.gmock\_TwoArgsMethod(\_,\ 45)...}}
\DoxyCodeLine{02118\ \textcolor{comment}{//}}
\DoxyCodeLine{02119\ \textcolor{comment}{//\ Whereas\ the\ form\ without\ a\ matcher\ list:}}
\DoxyCodeLine{02120\ \textcolor{comment}{//}}
\DoxyCodeLine{02121\ \textcolor{comment}{//\ \ \ //\ This\ statement:}}
\DoxyCodeLine{02122\ \textcolor{comment}{//\ \ \ ON\_CALL(mock,\ TwoArgsMethod)...}}
\DoxyCodeLine{02123\ \textcolor{comment}{//}}
\DoxyCodeLine{02124\ \textcolor{comment}{//\ \ \ //\ ...expands\ to:}}
\DoxyCodeLine{02125\ \textcolor{comment}{//\ \ \ mock.gmock\_TwoArgsMethod(WithoutMatchers(),\ nullptr)...}}
\DoxyCodeLine{02126\ \textcolor{comment}{//\ \ \ |-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/v-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|}}
\DoxyCodeLine{02127\ \textcolor{comment}{//\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ invokes\ second\ overload}}
\DoxyCodeLine{02128\ \textcolor{comment}{//}}
\DoxyCodeLine{02129\ \textcolor{comment}{//\ \ \ //\ ...which\ is\ essentially:}}
\DoxyCodeLine{02130\ \textcolor{comment}{//\ \ \ mock.gmock\_TwoArgsMethod(\_,\ \_)...}}
\DoxyCodeLine{02131\ \textcolor{comment}{//}}
\DoxyCodeLine{02132\ \textcolor{comment}{//\ The\ WithoutMatchers()\ argument\ is\ used\ to\ disambiguate\ overloads\ and\ to}}
\DoxyCodeLine{02133\ \textcolor{comment}{//\ block\ the\ caller\ from\ accidentally\ invoking\ the\ second\ overload\ directly.\ The}}
\DoxyCodeLine{02134\ \textcolor{comment}{//\ second\ argument\ is\ an\ internal\ type\ derived\ from\ the\ method\ signature.\ The}}
\DoxyCodeLine{02135\ \textcolor{comment}{//\ failure\ to\ disambiguate\ two\ overloads\ of\ this\ method\ in\ the\ ON\_CALL\ statement}}
\DoxyCodeLine{02136\ \textcolor{comment}{//\ is\ how\ we\ block\ callers\ from\ setting\ expectations\ on\ overloaded\ methods.}}
\DoxyCodeLine{02137\ \textcolor{preprocessor}{\#define\ GMOCK\_ON\_CALL\_IMPL\_(mock\_expr,\ Setter,\ call)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{02138\ \textcolor{preprocessor}{\ \ ((mock\_expr).gmock\_\#\#call)(::testing::internal::GetWithoutMatchers(),\ \(\backslash\)}}
\DoxyCodeLine{02139\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ nullptr)\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}}
\DoxyCodeLine{02140\ \textcolor{preprocessor}{\ \ \ \ \ \ .Setter(\_\_FILE\_\_,\ \_\_LINE\_\_,\ \#mock\_expr,\ \#call)}}
\DoxyCodeLine{02141\ }
\DoxyCodeLine{02142\ \textcolor{preprocessor}{\#define\ ON\_CALL(obj,\ call)\ \(\backslash\)}}
\DoxyCodeLine{02143\ \textcolor{preprocessor}{\ \ GMOCK\_ON\_CALL\_IMPL\_(obj,\ InternalDefaultActionSetAt,\ call)}}
\DoxyCodeLine{02144\ }
\DoxyCodeLine{02145\ \textcolor{preprocessor}{\#define\ EXPECT\_CALL(obj,\ call)\ \(\backslash\)}}
\DoxyCodeLine{02146\ \textcolor{preprocessor}{\ \ GMOCK\_ON\_CALL\_IMPL\_(obj,\ InternalExpectedAt,\ call)}}
\DoxyCodeLine{02147\ }
\DoxyCodeLine{02148\ \textcolor{preprocessor}{\#endif\ \ }\textcolor{comment}{//\ GOOGLEMOCK\_INCLUDE\_GMOCK\_GMOCK\_SPEC\_BUILDERS\_H\_}}

\end{DoxyCode}
